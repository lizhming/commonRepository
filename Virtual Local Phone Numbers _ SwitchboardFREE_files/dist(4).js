var reviewsJsonLdRendered=reviewsJsonLdRendered||!1,floatingWidgetPosition="",hideIframe;richSnippetReviewsWidgets=function(){var e,t,n;arguments.length>1?(e=arguments[0],n=document.getElementById(e),t=arguments[1]):(t=arguments.length>0?arguments[0]:{},e="richSnippetReviewsWidget-defaultContainer",n=document.createElement("div"),n.setAttribute("id",e),document.body.appendChild(n)),richSnippetRecursiveMerge=function(e,t){for(var i in t)try{t[i].constructor==Object?e[i]=richSnippetRecursiveMerge(e[i],t[i]):e[i]=t[i]}catch(n){e[i]=t[i]}return e};var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4===this.readyState&&!reviewsJsonLdRendered&&200==this.status){var e=this.responseText,i=document.createElement("script"),n=JSON.parse(e);t.data&&"WebPage"!==n["@type"]&&(reviews=JSON.parse(e),reviews=richSnippetRecursiveMerge(reviews,t.data),e=JSON.stringify(reviews)),t.company_data&&"WebPage"==n["@type"]&&(reviews=JSON.parse(e),reviews=richSnippetRecursiveMerge(reviews,t.company_data),e=JSON.stringify(reviews)),i.setAttribute("type","application/ld+json"),i.appendChild(document.createTextNode(e)),document.getElementsByTagName("head")[0].appendChild(i),reviewsJsonLdRendered=!0}},t.keyword&&("company"==t.contentMode||!t.contentMode)||t.branch?t.branchRichSnippet?(a.open("GET","https://api.reviews.co.uk/json-ld-legacy/company/snippet?store="+t.store+"&url="+document.location.href+"&type=store_review&branch="+t.branch+"&per_page=1",!0),a.send()):"company"==t.contentMode?(a.open("GET","https://api.reviews.co.uk/json-ld-legacy/company/snippet?store="+t.store+"&url="+document.location.href+"&type=store_review&keyword="+t.keyword+"&product_name="+t.product_name+"&per_page=1",!0),a.send()):(a.open("GET","https://api.reviews.co.uk/json-ld-legacy/company/snippet?store="+t.store+"&url="+document.location.href+"&keyword="+t.keyword+"&product_name="+t.product_name+"&per_page=1",!0),a.send()):(a.open("GET","https://api.reviews.co.uk/json-ld/company/snippet?store="+t.store+"&url="+document.location.href,!0),a.send());var o="https://widget.reviews.co.uk/rich-snippet-reviews-widgets/widget",r="version=13b";t.elementId=e,t.origin=window.location.href,t.floatPosition&&"right"==t.floatPosition&&(floatingWidgetPosition="--right");for(i in t)"sku"==i&&Array.isArray(t[i])&&(t[i]=t[i].join(";")),r.length>0&&(r+="&"),"object"!=typeof t[i]?r+=i+"="+encodeURIComponent(t[i]):r+=i+"="+encodeURIComponent(JSON.stringify(t[i]));var d=document.createElement("IFRAME");if(d.name+=e+"_frame",d.id+=e+"_frame",d.setAttribute("frameborder",0),d.width="100%",d.scrolling="no",d.maxWidth="100%",d.minWidth="100%",d.height=function(e){var t=200;switch(e){case"carousel":t=297;break;case"floating-widget":t=0;break;case"text-banner":t=43;break;default:t=200}return t}(null!=t.widgetName?t.widgetName:""),d.title="Reviews Widget",n.innerHTML="",n.appendChild(d),window.onresize=function(){d.width=window.getComputedStyle(n,null).getPropertyValue("width"),d.style.width=window.getComputedStyle(n,null).getPropertyValue("width")+"px"},"get"==(r.length>1e3?"post":"get"))d.setAttribute("src",o+"?"+r);else{var s=document.createElement("form");s.style="display:none;",s.method="POST",s.action=o,s.target=e+"_frame";for(var c in t){var l=document.createElement("input");l.type="hidden",l.value=t[c],l.name=c,s.appendChild(l)}document.body.appendChild(s),s.submit()}var p=function(t){if("richSnippetReviewsWidget-defaultContainer"==e){var i=document.getElementById(e);hideIframe&&clearTimeout(hideIframe),i&&(i.setAttribute("class",""),window.pageYOffset>20&&window.innerWidth<650?i.style.opacity="0":i.style.opacity="1",hideIframe=setTimeout(function(){1==i.style.opacity?i.classList.remove("richSnippetReviewsWidget-defaultContainer--faded"):i.classList.add("richSnippetReviewsWidget-defaultContainer--faded")},1e3))}},g=function(t){var i;try{var n=JSON.parse(t.data);if(void 0!=n.action)switch(i=window.document.querySelector("iframe#"+e+"_frame"),n.action){case"resize":n.elementId==e&&(d.height=n.height);break;case"resize-load":d.height=n.height;break;case"RUKFloatingWidget"+floatingWidgetPosition+"#Ready":"richSnippetReviewsWidget-defaultContainer"==e&&i.classList.add("RUKFloatingWidget"+floatingWidgetPosition);break;case"RUKFloatingWidget"+floatingWidgetPosition+"#Mobile":"richSnippetReviewsWidget-defaultContainer"==e&&(i.classList.add("RUKFloatingWidget--mobile"),window.addEventListener&&addEventListener("scroll",p));break;case"RUKFloatingWidget"+floatingWidgetPosition+"#Expand":"richSnippetReviewsWidget-defaultContainer"==e&&(i.classList.add("expanded"),window.__fullPictureEvents?window.__fullPictureEvents.addWidget("iframe#"+e+"_frame","floating-widget"):(window.__reviewsIoWidgetList||(window.__reviewsIoWidgetList=[]),window.__reviewsIoWidgetList.push({target:"iframe#"+e+"_frame",widget:"floating-widget"})));break;case"RUKFloatingWidget"+floatingWidgetPosition+"#Retract":"richSnippetReviewsWidget-defaultContainer"==e&&(i.classList.remove("expanded"),window.__fullPictureEvents&&window.__fullPictureEvents.fullPictureHideEvent("floating-widget"));break;case"RUKFloatingWidget"+floatingWidgetPosition+"#Dismiss":"richSnippetReviewsWidget-defaultContainer"==e&&(i.style.display="none",window.__fullPictureEvents&&window.__fullPictureEvents.fullPictureHideEvent("floating-widget"));break;case"RUKFloatingWidget"+floatingWidgetPosition+"#Small":"richSnippetReviewsWidget-defaultContainer"==e&&(i.style.maxWidth="45px")}}catch(e){}};window.addEventListener?addEventListener("message",g,!1):attachEvent("onmessage",g)},"function"==typeof richSnippetReviewsWidgetsListenerCallback&&richSnippetReviewsWidgetsListenerCallback();