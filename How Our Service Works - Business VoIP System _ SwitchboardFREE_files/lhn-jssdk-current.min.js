(function(){var __webpack_exports__={};function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}var lhn=void 0===lhn?null:lhn;(function(lhnJsSdk){var appurl="https://developer.livehelpnow.net",sockurl="wss://app.livehelpnow.net",baseurl="https://www.livehelpnow.net/lhn/",apiversion="/api",develop=!1,systems={c:"chat",t:"ticket",kb:"knowledge",cb:"callback"},systems_long={chat:"c",ticket:"t",knowledge:"kb",callback:"cb"},system_windows={chat:0,ticket:0,knowledge:0,callback:0},firstOpen={chat:!0,ticket:!0,callback:!0,knowledge:!0},hoc_chat_order,typeahead,lhnsocket,lastMessageId,firstMessageId,chatChan,chatSession,chatSurveyId,custName,activeTab,socket_timer,inactivity_timer,motive,messageReadInterval,poweredByInterval=null,isWorking,isCustomerTyping,isOperatorTyping,isOnline,isBlocked,moreMessages,isLoadingMessages,formsWorking,started_jump_logic,jl_working,visitorValidated,disableEndChat,connectionEstablishedOnce,socketTimerStarted,vChannelJoined,launchedChat,longPollAttempted,inactivityTimerStarted,lhnAttachmentCount;isWorking=isCustomerTyping=isOperatorTyping=isOnline=isBlocked=moreMessages=isLoadingMessages=formsWorking=started_jump_logic=jl_working=visitorValidated=disableEndChat=!1,connectionEstablishedOnce=socketTimerStarted=vChannelJoined=launchedChat=longPollAttempted=connectionAttempted=inactivityTimerStarted=!1;var chatType="prechat",operLanguageId="",custLanguageId="",preChatType,chatMode="standard",chatOfflineType={offline:0},tabId=generateTabId();lhnAttachmentCount=0;var webrtc={isJsLoaded:!1,callManager:null};lhnJsSdk.isHOC=!1;var gaType=null,ga_local={},botPattern="(googlebot/|bot|Googlebot-Mobile|Googlebot-Image|Google favicon|Mediapartners-Google|bingbot|slurp|java|wget|curl|Commons-HttpClient|Python-urllib|libwww|httpunit|nutch|phpcrawl|msnbot|jyxobot|FAST-WebCrawler|FAST Enterprise Crawler|biglotron|teoma|convera|seekbot|gigablast|exabot|ngbot|ia_archiver|GingerCrawler|webmon |httrack|webcrawler|grub.org|UsineNouvelleCrawler|antibot|netresearchserver|speedy|fluffy|bibnum.bnf|findlink|msrbot|panscient|yacybot|AISearchBot|IOI|ips-agent|tagoobot|MJ12bot|dotbot|woriobot|yanga|buzzbot|mlbot|yandexbot|purebot|Linguee Bot|Voyager|CyberPatrol|voilabot|baiduspider|citeseerxbot|spbot|twengabot|postrank|turnitinbot|scribdbot|page2rss|sitebot|linkdex|Adidxbot|blekkobot|ezooms|dotbot|Mail.RU_Bot|discobot|heritrix|findthatfile|europarchive.org|NerdByNature.Bot|sistrix crawler|ahrefsbot|Aboundex|domaincrawler|wbsearchbot|summify|ccbot|edisterbot|seznambot|ec2linkfinder|gslfbot|aihitbot|intelium_bot|facebookexternalhit|yeti|RetrevoPageAnalyzer|lb-spider|sogou|lssbot|careerbot|wotbox|wocbot|ichiro|DuckDuckBot|lssrocketcrawler|drupact|webcompanycrawler|acoonbot|openindexspider|gnam gnam spider|web-archive-net.com.bot|backlinkcrawler|coccoc|integromedb|content crawler spider|toplistbot|seokicks-robot|it2media-domain-crawler|ip-web-crawler.com|siteexplorer.info|elisabot|proximic|changedetection|blexbot|arabot|WeSEE:Search|niki-bot|CrystalSemanticsBot|rogerbot|360Spider|psbot|InterfaxScanBot|Lipperhey SEO Service|CC Metadata Scaper|g00g1e.net|GrapeshotCrawler|urlappendbot|brainobot|fr-crawler|binlar|SimpleCrawler|Livelapbot|Twitterbot|cXensebot|smtbot|bnf.fr_bot|A6-Indexer|ADmantX|Facebot|Twitterbot|OrangeBot|memorybot|AdvBot|MegaIndex|SemanticScholarBot|ltx71|nerdybot|xovibot|BUbiNG|Qwantify|archive.org_bot|Applebot|TweetmemeBot|crawler4j|findxbot|SemrushBot|yoozBot|lipperhey|y!j-asr|Domain Re-Animator Bot|AddThis)",re=new RegExp(botPattern,"i");function generateTabId(){return Math.floor(Math.random()*Date.now())}function init(){if(!window.lhnJsSdkLoaded){var e=navigator.userAgent;re.test(e)?lhnJsSdk.log("crawler","the user agent is a crawler! - "+e):(window.lhnJsSdkLoaded=!0,window.lhnJsSdkInit(),detectGaType(),void 0===lhnJsSdk.options&&(lhnJsSdk.options={}),lhnJsSdk.options.tracking=void 0===lhnJsSdk.options.tracking||lhnJsSdk.options.tracking,function(e,n,t,a){var l=e.getElementsByTagName("head")[0],o=e.createElement("script");o.src=a;var s=!1;if(o.onload=o.onreadystatechange=function(){s||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(s=!0,o.onload=o.onreadystatechange=null,l&&o.parentNode&&l.removeChild(o),jQuery="undefined"!=typeof jQuery?jQuery:lhnQuery,navigator.appVersion.indexOf("MSIE 8.")>0&&function(e,n,t,a){var l=e.getElementsByTagName("head")[0],o=e.createElement("script");o.type="text/javascript",o.src=a,l.appendChild(o)}(document,0,0,appurl+"/js/es5-shim.min.js"),(navigator.appVersion.indexOf("MSIE ")>0||window.MSInputMethodContext&&document.documentMode)&&function(e,n,t,a){var l=e.getElementsByTagName("head")[0],o=e.createElement("script");o.type="text/javascript",o.src="https://cdn.livehelpnow.net/assets/js/bluebird/bluebird.min.js",l.appendChild(o)}(document),function(e,n,t,a){var l=e.getElementsByTagName("head")[0],o=e.createElement("script");o.type="text/javascript",o.src="https://cdn.polyfill.io/v3/polyfill.min.js?features=default,Array.prototype.includes,Array.prototype.find",l.appendChild(o)}(document),lhnQuery.fn.serializeObject=function(e){if(null==(e=void 0===e&&null!=e?0:e))var n={};else n={view_id:e};var t=this.serializeArray();return lhnQuery.each(t,(function(){this.value=html2text(this.value),void 0!==n[this.name]?(n[this.name].push||(n[this.name]=[n[this.name]]),n[this.name].push(lhnQuery.trim(this.value)||"")):n[this.name]=lhnQuery.trim(this.value)||""})),n},lhnStorage.checkType(),lhnStorage.getData("lhnJWT")&&void 0!==JSON.parse(decodeBase64(lhnStorage.getData("lhnJWT").split(".")[1]))&&"true"!=qs("lhn_preview")?(visitorValidated=!0,setup()):connectOAuth())},l.appendChild(o),void 0===i&&window.addEventListener){var i="",r=!1,h="";h=-1!=(navigator.userAgent.indexOf("Opera")||navigator.userAgent.indexOf("OPR"))?"Opera":-1!=navigator.userAgent.indexOf("Chrome")?"Chrome":-1!=navigator.userAgent.indexOf("Safari")?"Safari":-1!=navigator.userAgent.indexOf("Firefox")?"Firefox":-1!=navigator.userAgent.indexOf("MSIE")||1==!!document.documentMode?"Internet Explorer":navigator.userAgent,window.addEventListener("error",(function(e){e.target.src&&e.type?i+=e.type+" loading "+e.target.localName+" "+e.target.src+" | ":e.message&&(1==r?lhnSendError(e.message+" line:"+e.lineno+" column:"+e.colno,h):i+=e.message+" line:"+e.lineno+" column:"+e.colno+" | ")}),!0),window.setTimeout((function(){lhnSendError(i,h),r=!0}),8e3)}}(document,0,0,appurl+"/js/lhn-jquery-3.5.1.min.js"))}}function connectOAuth(){var e=appurl+"/oauth/token/",n={client_id:lhnJsSdk.setup.application_id,client_secret:lhnJsSdk.setup.application_secret,grant_type:"client_credentials"};null!=lhnStorage.getData("lhnContact")&&"null"!=lhnStorage.getData("lhnContact")&&(n.lhncontact=lhnStorage.getData("lhnContact")),ajaxCall(e,n,"GET",connectOAuthCallback)}function connectOAuthCallback(e){visitorValidated=!0,lhnStorage.setData("lhn"+e.token_type,e.access_token,e.expires_in),lhnStorage.setData("lhnRefresh",e.refresh_token,e.refresh_expires_in),setup()}function refreshOAuth(e){var n=appurl+"/oauth/token/",t={client_id:lhnJsSdk.setup.application_id,client_secret:lhnJsSdk.setup.application_secret,grant_type:"client_credentials"};null!=lhnStorage.getData("lhnContact")&&"null"!=lhnStorage.getData("lhnContact")&&(t.lhncontact=lhnStorage.getData("lhnContact")),ajaxCall(n,t,"GET",refreshOAuthCallback,e)}function refreshOAuthCallback(e,n){lhnStorage.setData("lhn"+e.token_type,e.access_token,e.expires_in),lhnStorage.setData("lhnRefresh",e.refresh_token,e.refresh_expires_in),ajaxCall(n.url,n.data,n.type,n.successCallback,n.options)}function visitorSetup(){if(lhnJsSdk.setup.account=JSON.parse(decodeBase64(lhnStorage.getData("lhnJWT").split(".")[1])).iss.client,log("Account #",lhnJsSdk.setup.account),lhnJsSdk.settings=void 0!==lhnJsSdk.settings?lhnJsSdk.settings:{},visitor_tracking=JSON.parse(decodeBase64(lhnStorage.getData("lhnJWT").split(".")[1])).iss.visitor_tracking,visitor_tracking="undefined"==typeof visitor_tracking||visitor_tracking,navigator.javaEnabled()?lhnJsSdk.options.java="Yes":lhnJsSdk.options.java="No",lhnJsSdk.options.res="",lhnJsSdk.options.depth="",window.screen&&(lhnJsSdk.options.res=screen.width+"x"+screen.height,lhnJsSdk.options.depth=screen.colorDepth),lhnJsSdk.options.custom1=void 0===lhnJsSdk.options.custom1?"":lhnJsSdk.options.custom1,lhnJsSdk.options.custom2=void 0===lhnJsSdk.options.custom2?"":lhnJsSdk.options.custom2,lhnJsSdk.options.custom3=void 0===lhnJsSdk.options.custom3?"":lhnJsSdk.options.custom3,lhnJsSdk.options.custom1Label=void 0===lhnJsSdk.options.custom1Label?"":lhnJsSdk.options.custom1Label,lhnJsSdk.options.custom2Label=void 0===lhnJsSdk.options.custom2Label?"":lhnJsSdk.options.custom2Label,lhnJsSdk.options.custom3Label=void 0===lhnJsSdk.options.custom3Label?"":lhnJsSdk.options.custom3Label,lhnJsSdk.options.dept=void 0===lhnJsSdk.options.dept?lhnJsSdk.settings.department:lhnJsSdk.options.dept,lhnJsSdk.options.referrer=document.referrer.length>400?encodeURIComponent(document.referrer.substring(0,400)):encodeURIComponent(document.referrer),lhnJsSdk.options.pagetitle=document.title.length>100?encodeURIComponent(document.title.substring(0,100)):encodeURIComponent(document.title),lhnJsSdk.options.pageurl=encodeURIComponent(document.location).length>500?encodeURIComponent(document.location).substring(0,500):encodeURIComponent(document.location),lhnJsSdk.options.cookie=navigator.cookieEnabled,lhnJsSdk.options.embedArticle=void 0===lhnJsSdk.options.embedArticle||lhnJsSdk.options.embedArticle,lhnJsSdk.options.sound=void 0===lhnJsSdk.options.sound?appurl+"/audio/hoc_alert.wav":lhnJsSdk.options.sound,lhnJsSdk.options.jumplogic=void 0===lhnJsSdk.options.jumplogic?{}:lhnJsSdk.options.jumplogic,lhnJsSdk.options.invite_as_chat=void 0!==lhnJsSdk.options.invite_as_chat&&lhnJsSdk.options.invite_as_chat,lhnJsSdk.options.domain_policy=void 0===lhnJsSdk.options.domain_policy?"unknown":lhnJsSdk.options.domain_policy,lhnJsSdk.options.disableChatInQueue=void 0!==lhnJsSdk.options.disableChatInQueue&&lhnJsSdk.options.disableChatInQueue,chatSurveyId=void 0===lhnJsSdk.options.chatSurveyId?chatSurveyId:lhnJsSdk.options.chatSurveyId,0!=lhnJsSdk.options.tracking&&1==visitor_tracking||null!=lhnJsSdk.chatSession){var e={java:lhnJsSdk.options.java,res:lhnJsSdk.options.res,depth:lhnJsSdk.options.depth,custom1:lhnJsSdk.options.custom1,custom2:lhnJsSdk.options.custom2,custom3:lhnJsSdk.options.custom3,custom1Label:lhnJsSdk.options.custom1Label,custom2Label:lhnJsSdk.options.custom2Label,custom3Label:lhnJsSdk.options.custom3Label,dept:lhnJsSdk.options.dept,cookie:lhnJsSdk.options.cookie,referrer:lhnJsSdk.options.referrer,pagetitle:lhnJsSdk.options.pagetitle,pageurl:lhnJsSdk.options.pageurl,chatwindowid:system_windows.chat,utm_source:qs("utm_source"),utm_medium:qs("utm_medium"),utm_campaign:qs("utm_campaign"),utm_term:qs("utm_term"),utm_content:qs("utm_content"),click_id:detectClickId()};ajaxCall(appurl+apiversion+"/visitor/init/",e,"POST",joinVisitorChannel)}}function joinVisitorChannel(data){if(void 0!==data.payload&&void 0!==data.payload.online_status&&(lhnJsSdk.isOnline=data.payload.online_status,updateButtons()),void 0!==data.payload.jwt&&data.payload.jwt?(lhnStorage.setData("lhnJWT",data.payload.jwt,data.payload.jwt_expire),resource_id=JSON.parse(decodeBase64(data.payload.jwt.split(".")[1])).resource.id,lhnStorage.setData("lhnContact",resource_id,63113904)):(resource_id=JSON.parse(decodeBase64(lhnStorage.getData("lhnJWT").split(".")[1])).resource.id,null!=resource_id&&"null"!=resource_id&&lhnStorage.setData("lhnContact",resource_id,63113904)),void 0!==data.payload.conversions&&data.payload.conversions.length>0)for(var lhnConv=0;lhnConv<data.payload.conversions.length;lhnConv++)if(0==data.payload.conversions[lhnConv].type)lhnJsSdk.track_conversion(data.payload.conversions[lhnConv].id,null);else if(1==data.payload.conversions[lhnConv].type&&_typeof("undefined"!=data.payload.conversions[lhnConv].fieldSelector))data.payload.conversions[lhnConv].fieldSelector.indexOf("[")<0?lhnConvPrice=window[data.payload.conversions[lhnConv].fieldSelector]:lhnConvPrice=eval(data.payload.conversions[lhnConv].fieldSelector),lhnJsSdk.track_conversion(data.payload.conversions[lhnConv].id,lhnConvPrice);else if(2==data.payload.conversions[lhnConv].type&&_typeof("undefined"!=data.payload.conversions[lhnConv].fieldSelector))$el=lhnQuery("#"+data.payload.conversions[lhnConv].fieldSelector),0==$el.length&&($el=lhnQuery("."+data.payload.conversions[lhnConv].fieldSelector)),$el[0]?lhnConvPrice=lhnQuery($el[$el.length-1]).text():lhnConvPrice=null,lhnJsSdk.track_conversion(data.payload.conversions[lhnConv].id,lhnConvPrice);else if(3==data.payload.conversions[lhnConv].type&&_typeof("undefined"!=data.payload.conversions[lhnConv].fieldSelector)){var regex=JSON.parse(data.payload.conversions[lhnConv].fieldSelector),lhnConvRegEx=new RegExp(regex.RegexMatch,regex.RegexOptions);null!==lhnConvRegEx.exec(document.body.innerHTML)&&lhnJsSdk.track_conversion(data.payload.conversions[lhnConv].id,lhnConvRegEx.exec(document.body.innerHTML)[1])}!function(e,n,t,a){var l=e.getElementsByTagName("head")[0],o=e.createElement("script");o.type="text/javascript",o.src=a;var s=!1;o.onload=o.onreadystatechange=function(){if(!(s||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState)){if(s=!0,connectSocket(null,vchanConnect),lhnJsSdk.chatSession)joinChatSession();else if(1==started_jump_logic&&"jump_logic"==preChatType)openHOC("c");else if(void 0!==lhnJsSdk.settings.autoinvite&&1==lhnJsSdk.settings.autoinvite.enabled&&"true"!=lhnStorage.getData("lhnAutoInviteShown")&&(1==lhnJsSdk.isOnline||"jump_logic"==preChatType&&void 0!==lhnJsSdk.settings.autoinvite.type&&"message"!=lhnJsSdk.settings.autoinvite.type)&&setTimeout((function(){if(!lhnQuery("#lhnHelpOutCenter").hasClass("lhnActive")){showInvite(lhnJsSdk.settings.autoinvite.message,0,!0,"auto",{type:void 0!==lhnJsSdk.settings.autoinvite.type?lhnJsSdk.settings.autoinvite.type:"message"}),lhnStorage.setData("lhnAutoInviteShown","true",3600);var e={message_type:1,message_sub_type:7,message:"Auto invitation shown: "+lhnJsSdk.settings.autoinvite.message};chatSessionId=null==lhnJsSdk.chatSession?0:lhnJsSdk.chatSession,ajaxCall(appurl+apiversion+"/chat/"+chatSessionId+"/message/",e,"POST",null,{}),ajaxCall(appurl+apiversion+"/analytics/chat/invite_tracking",e={invite_type:"auto"},"POST",null,{})}}),1e3*lhnJsSdk.settings.autoinvite.delay),void 0!==data.payload.invites&&data.payload.invites.length>0)for(var e=0;e<data.payload.invites.length;e++){var n={visitor_chat_session:{chat_message:data.payload.invites[e].message},operator:{id:data.payload.invites[e].createdBy},trigger:{delay:data.payload.invites[e].delaySec,id:data.payload.invites[e].createdBy}};switch(data.payload.invites[e].type){case"proactive":proactiveMsgReceived(n);break;case"trigger":triggerMsgReceived(n);break;case"promo":triggerPromoReceived(n)}}"function"==typeof window.lhnJsSdkReady&&window.lhnJsSdkReady()}},l.appendChild(o)}(document,0,0,appurl+"/js/socket.js")}function track_conversion(e,n){n&&(n=n.toString().replace(/[^0-9.]/g,"")),ajaxCall(appurl+apiversion+"/conversion/",{id:e,value:n,chat_session_id:lhnJsSdk.chatSession},"PUT"),doGaTrack("LiveChat","Conversion",!1),"function"==typeof window.lhnConversion&&window.lhnConversion(e,n)}function setup(){lhnJsSdk.controls=void 0!==lhnJsSdk.controls?lhnJsSdk.controls:[{type:"default"}];for(var e=0;e<lhnJsSdk.controls.length;e++)switch(log("Installation Type",lhnJsSdk.controls[e].type),log("ID",lhnJsSdk.controls[e].id),lhnJsSdk.controls[e].type){case"hoc":hocInit(lhnJsSdk.controls[e]),lhnJsSdk.isHOC=!0;break;case"chat_button":embedChatButton(lhnJsSdk.controls[e].element||null,lhnJsSdk.controls[e].id,lhnJsSdk.controls[e].window||0);break;default:lhnJsSdk.chatSession=void 0===lhnJsSdk.chatSession||null==lhnJsSdk.chatSession?lhnStorage.getData("lhnChatSession"):lhnJsSdk.chatSession,visitorSetup(),buildDictionary(),setTimeout((function(){lhnQuery("#lhnHocButton").show()}),50)}}function updateOnlineStatus(e){void 0!==e.chat.online_status&&void 0!==e.chat.online_type&&(0!=lhnJsSdk.options.dept&&"department"==e.chat.online_type||0==lhnJsSdk.options.dept&&"client"==e.chat.online_type)&&(lhnJsSdk.isOnline=null!=lhnJsSdk.chatSession||e.chat.online_status,"function"==typeof window.lhnStatusUpdate&&window.lhnStatusUpdate(),updateButtons(),lhnJsSdk.isHOC?updateEmbeddedChat():void 0===e.el||void 0===e.win||0!=lhnJsSdk.isOnline||""==lhnQuery("#"+e.chat.el).html()||lhnJsSdk.chatSession||embedPreChat(e.el,e.win))}function embedChatButton(e,n,t){var a={system:"chat",layout:"",partial:"button",button_id:n,opts:{online_status:lhnJsSdk.isOnline||!1}};ajaxCall(appurl+apiversion+"/ui/element/",a,"GET",embedChatButtonCallback,{el:e,win:t})}function embedChatButtonCallback(e,n){void 0!==e.payload&&(n.el=null==n.el?"body":"#"+n.el,lhnQuery(e.payload).appendTo(n.el),lhnQuery(document).on("click","#aLHNBTN",(function(){openChat(n.win)})))}function updateButtons(){var e=0==lhnJsSdk.isOnline?"offline":"online";lhnQuery(".lhnchatimg").each((function(){lhnQuery(this).attr("src",lhnQuery(this).attr(e))}));var n=0==lhnJsSdk.isOnline?"livechat_offline":"livechat";lhnQuery("#lhnHocButton .lhnHocChatTxtCont span").text(lhnJsSdk.dict[n]),void 0===lhnJsSdk.settings.styles||void 0===lhnJsSdk.settings.styles.button_offline||lhnJsSdk.isOnline||"hidden"!=lhnJsSdk.settings.styles.button_offline?lhnQuery("#lhnHocButton").show():lhnQuery("#lhnHocButton").hide()}function updateEmbeddedChat(){var e=0;"timeout"!=chatType&&(0!=lhnJsSdk.isOnline||lhnJsSdk.chatSession||firstOpen.chat||"jump_logic"==preChatType)||(firstOpen.chat=!0,lhnQuery.each(lhnJsSdk.settings.systems,(function(n){"chat"==lhnQuery(this)[0].system&&(e=lhnQuery(this)[0].window)})),embedPreChat("hocSyschat",e))}function openChat(e){if(lhnQuery("#hocSyschat").length>0)openHOC("c");else{if(document.getElementById("Zsmenu")&&(document.getElementById("Zsmenu").style.display="none"),"function"==typeof CustomOpenLHNChat)return CustomOpenLHNChat(),!1;if("undefined"!=typeof lhnWin&&lhnWin&&!lhnWin.closed)return lhnWin.blur(),setTimeout(lhnWin.focus(),10),!1;var n=(screen.width-500-32)/2,t=(screen.height-500-96)/2,a=0==lhnJsSdk.isOnline?"yes":"no";lhnWin=window.open("//www.livehelpnow.net/lhn/livechatvisitor.aspx?zzwindow="+e.win+"&lhnid=1&d="+lhnJsSdk.options.dept,"lhnchat","left="+n+",top="+t+",width=500,height=500,toolbar=no,location=no,directories=no,status=yes,menubar=no,scrollbars="+a+",copyhistory=no,resizable=yes"),"undefined"!=typeof _gaq&&_gaq&&_gaq.push(["_trackEvent","LiveHelpNow","Chat button clicked",""]),"undefined"!=typeof ga&&ga&&ga("send","event","LiveHelpNow","Chat button clicked")}}function hocInit(e){ajaxCall(appurl+apiversion+"/ui/hoc/"+e.id+"/init/",{current_url:document.location.href},"GET",hocSetup,e)}function hocSetup(e,n){if(null!=_typeof(e.payload)&&void 0!==e.payload.options){var t=void 0===e.payload.options.language?"english":e.payload.options.language;lhnJsSdk.settings={systems:e.payload.options.systems,styles:e.payload.options.styles,poweredby:e.payload.options.poweredby,department:e.payload.options.department,autoinvite:e.payload.options.autoinvite,general:{docWidth:lhnQuery(document).width(),winWidth:window.screen.width,ratio:lhnQuery(document).width()/window.screen.width},button:void 0!==e.payload.options.button?e.payload.options.button:"slide",language:t,file_upload_allowed:void 0!==e.payload.options.file_upload_allowed&&e.payload.options.file_upload_allowed},lhnJsSdk.settings.styles.layout=void 0===lhnJsSdk.settings.styles.layout?"modern":lhnJsSdk.settings.styles.layout,lhnJsSdk.settings.styles.position=void 0===lhnJsSdk.settings.styles.position?"left":lhnJsSdk.settings.styles.position,lhnJsSdk.settings.styles.button_position=void 0===lhnJsSdk.settings.styles.button_position?"right":lhnJsSdk.settings.styles.button_position,void 0!==lhnJsSdk.options.autoinvite&&lhnQuery.extend(lhnJsSdk.settings.autoinvite,lhnJsSdk.options.autoinvite),buildDictionary(),isMobile()&&(lhnJsSdk.settings.styles.layout="sidebar"),o=document,s=appurl+"/css/modern/"+lhnJsSdk.settings.styles.theme+".css",i=o.getElementsByTagName("head")[0],(r=o.createElement("link")).type="text/css",r.rel="stylesheet",r.href=s,r.crossOrigin="anonymous",i.insertBefore(r,i.firstChild),function(e,n,t,a){var l=e.getElementsByTagName("head")[0],o=e.createElement("link");o.type="text/css",o.rel="stylesheet",o.href=a,o.crossOrigin="anonymous",l.insertBefore(o,l.firstChild)}(document,0,0,appurl+"/css/fonts/opensans.css"),function(e,n,t,a){var l=e.getElementsByTagName("head")[0],o=e.createElement("link");o.type="text/css",o.rel="stylesheet",o.href=a,o.crossOrigin="anonymous",l.insertBefore(o,l.firstChild)}(document,0,0,appurl+"/css/modern/button.css"),function(e,n,t,a){css_done=!1;var l=e.getElementsByTagName("head")[0],o=e.createElement("link");o.type="text/css",o.rel="stylesheet",o.href=a,o.crossOrigin="anonymous",o.onload=o.onreadystatechange=function(){css_done||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(css_done=!0,setTimeout((function(){lhnQuery("#lhnHelpOutCenter").show()}),100))},l.insertBefore(o,l.firstChild)}(document,0,0,appurl+"/css/modern/hoc.css"),void 0!==n.css&&function(e,n,t,a){var l=e.getElementsByTagName("head")[0],o=e.createElement("link");o.type="text/css",o.rel="stylesheet",o.href=a,o.crossOrigin="anonymous",l.appendChild(o)}(document,0,0,n.css),function(n,t){var a=n.getElementsByTagName("body");(a=n.createElement("div")).id="lhnHelpOutCenter",a.className="lhn"+lhnJsSdk.settings.styles.position+" lhnWindow circleButton lhnWindow-"+lhnJsSdk.settings.styles.layout,a.innerHTML=e.payload.template,a.style.display="none",n.body.appendChild(a)}(document),lhnJsSdk.settings.general.hocWidth=isMobile()?"100%":330,lhnQuery("#lhnHelpOutCenter").width(lhnJsSdk.settings.general.hocWidth);var a=Object.keys(lhnJsSdk.settings.systems).length;for(var l in function(e,n,t){var a,l=e.getElementById("lhnHocMenuContainer");(a=e.createElement("ul")).id="lhnHocMenu",l.appendChild(a)}(document),lhnJsSdk.settings.systems)switch(function(e,n,t,o,s){var i,r=e.getElementById("lhnHocMenu");(i=e.createElement("li")).setAttribute("systemorder",o),i.setAttribute("systemtype",s),i.setAttribute("tabindex","0"),i.className="lhnHocTab",i.innerHTML=lhnJsSdk.dict[lhnJsSdk.settings.systems[l].system+"Menu"],i.style.width=100/a+"%",r.appendChild(i)}(document,0,0,l,lhnJsSdk.settings.systems[l].system),function(e,n,t,a,l,o){var s,i=e.getElementById("hocContainer");(s=e.createElement("div")).setAttribute("systemorder",a),s.setAttribute("systemtype",l),s.id="hocSys"+l,s.className="lhnHocSection",i.appendChild(s)}(document,0,0,l,lhnJsSdk.settings.systems[l].system,lhnJsSdk.settings.systems[l].window),a>1?lhnQuery(".lhnHocToggleMenu, .lhnWindow-tabs").show():lhnQuery("#hocContainer").addClass("no-menu"),lhnJsSdk.settings.systems[l].system){case"chat":lhnJsSdk.chatSession=lhnJsSdk.settings.systems[l].active_chat_session_id||null,started_jump_logic=lhnJsSdk.settings.systems[l].started_jump_logic||null,custName=lhnStorage.getData("lhnCustName"),chatSurveyId=void 0!==lhnJsSdk.settings.systems[l].survey?lhnJsSdk.settings.systems[l].survey:null,system_windows.chat=void 0===lhnJsSdk.options.chatWindowId?lhnJsSdk.settings.systems[l].window:lhnJsSdk.options.chatWindowId,preChatType=1==lhnJsSdk.settings.systems[l].jump_logic?"jump_logic":preChatType,chatOfflineType=void 0!==lhnJsSdk.settings.systems[l].offline?lhnJsSdk.settings.systems[l].offline:{offline:0},chatMode=void 0!==lhnJsSdk.settings.systems[l].mode?lhnJsSdk.settings.systems[l].mode:"standard",chatMode="jump_logic"==preChatType?"standard":chatMode,disableEndChat=void 0!==lhnJsSdk.settings.systems[l].disableEndChat&&lhnJsSdk.settings.systems[l].disableEndChat,disableEndChat=void 0!==lhnJsSdk.options.disableEndChat?lhnJsSdk.options.disableEndChat:disableEndChat;break;case"callback":system_windows.callback=void 0===lhnJsSdk.options.callbackWindowId?lhnJsSdk.settings.systems[l].window:lhnJsSdk.options.callbackWindowId;break;case"ticket":system_windows.ticket=void 0===lhnJsSdk.options.ticketkWindowId?lhnJsSdk.settings.systems[l].window:lhnJsSdk.options.ticketkWindowId;break;default:system_windows[lhnJsSdk.settings.systems[l].system]=lhnJsSdk.settings.systems[l].window}visitorSetup(),setTimeout((function(){null==lhnJsSdk.chatSession||isMobile()||openHOC("c")}),1e3),lhnQuery(document).ready((function(){void 0!==lhnJsSdk.settings.styles.nobutton&&0!=lhnJsSdk.settings.styles.nobutton||function(e,n,t){var a="",l=0==lhnJsSdk.isOnline?"livechat_offline":"livechat";a+='<div class="lhnHocChatBtnCont" title="Live Chat Button">',a+='<div class="lhnHocChatBtn">',a+='<div class="lhnHocChatBubbleCont">',a+='<div class="lhnHocChatBubble lhnHocFrontBubble">',a+='<div id="lhnOpType" class="lhnHocCtCont">',a+='<div class="lhnHocChatTalk lhnHocCt1"></div>',a+='<div class="lhnHocChatTalk lhnHocCt2"></div>',a+='<div class="lhnHocChatTalk lhnHocCt3"></div>',a+='<div class="lhnHocButtonClear"></div>',a+="</div>",a+="</div>",a+='<div class="lhnHocChatBubble lhnHocBackBubble"></div>',a+="</div>",a+='<div class="lhnHocChatTxtCont">',a+='<span role="button" tabindex="0" aria-pressed="false">'+lhnJsSdk.dict[l]+"</span>",a+="</div>",a+='<div class="lhnHocButtonClear"></div>',a+="</div>",a+="</div>";var o=e.getElementsByTagName("body");(o=e.createElement("div")).id="lhnHocButton",o.className="lhn"+lhnJsSdk.settings.styles.button_position+" lhn"+lhnJsSdk.settings.button,o.innerHTML=a,o.style.display="none",e.body.appendChild(o)}(document),isMobile()&&lhnQuery("#lhnHelpOutCenter, #lhnHocButton, #lhnHocInvite").addClass("lhnMobileHoc"),setTimeout((function(){(void 0!==lhnJsSdk.settings.styles&&void 0===lhnJsSdk.settings.styles.button_offline||lhnJsSdk.isOnline||!lhnJsSdk.isOnline&&"hidden"!=lhnJsSdk.settings.styles.button_offline)&&lhnQuery("#lhnHocButton").show(),"function"==typeof window.lhnStatusUpdate&&window.lhnStatusUpdate()}),200),lhnQuery(".lhnHocTab").click((function(){return switchHocTab(lhnQuery(this).attr("systemtype")),!1})),lhnQuery(".lhnHocClose, .lhnWindow-header-minimizer").click((function(){return closeHOC(),!1})),lhnQuery(".lhnHocChatClose, .lhnWindow-header-closer").click((function(){return(null!=lhnJsSdk.chatSession||lhnQuery(".lhnCustomerMessage").length>0&&(lhnQuery(".lhnOperatorMessage.jumplogic").length>0||lhnQuery(".lhnOperatorMessage.oldjumplogic").length>0))&&"c"==activeTab&&(0==disableEndChat||1==disableEndChat&&null==lhnJsSdk.chatSession)?(null!=webrtc.callManager&&webrtc.callManager.isActive?lhnQuery(".lhnPromptMsg.webrtcWarning").show():lhnQuery(".lhnPromptMsg.webrtcWarning").hide(),lhnQuery(".lhnPrompt.closechat, .lhnPromptOverlay.closechat").show(),setTimeout((function(){lhnQuery(".lhnPromptAccept.closechat").focus()}),50)):closeHOC(),!1})),lhnQuery(document).off("click",".lhnPromptAccept.closechat").on("click",".lhnPromptAccept.closechat",(function(){lhnQuery(this).prop("disabled",!0),endChat()})),lhnQuery(document).off("click",".lhnPromptDecline.closechat").on("click",".lhnPromptDecline.closechat",(function(){lhnQuery(".lhnPrompt, .lhnPromptOverlay").hide(),closeHOC()})),lhnQuery(".lhnHocExternalClose").click((function(){return externalPageClose(),!1})),lhnQuery(".lhnHocToggleMenu").click((function(){return lhnQuery("#lhnHocMenuContainer").slideToggle(200),!1})),lhnQuery("#lhnHocButton").click((function(e){lhnQuery(e.target).is(".lhnClose")||("visible"==lhnQuery("#lhnHelpOutCenter").css("visibility")?lhnJsSdk.closeHOC():openHOC())})),lhnQuery("#lhnHocButton").keypress((function(e){lhnQuery(e.target).is(".lhnClose")||13!=e.keyCode&&32!=e.keyCode||("visible"==lhnQuery("#lhnHelpOutCenter").css("visibility")?lhnJsSdk.closeHOC():openHOC())})),lhnQuery(document).off("keyup",".lhnHocInviteButton.lhnstart").on("keyup",".lhnHocInviteButton.lhnstart",(function(e){32!=e.keyCode&&13!=e.keyCode||lhnQuery(this).click()})),lhnQuery(document).off("click",".lhnHocInviteButton.lhnstart").on("click",".lhnHocInviteButton.lhnstart",(function(){openHOC("c",{motive:motive=lhnQuery("#lhnHocInvite").hasClass("lhn_auto")?"auto_invite":lhnQuery("#lhnHocInvite").hasClass("lhn_proactive")?"proactive_invite":lhnQuery("#lhnHocInvite").hasClass("lhn_trigger")?"trigger_invite:"+lhnQuery("#lhnHocInvite").attr("rel"):lhnQuery("#lhnHocInvite").hasClass("lhn_manual")?"manual_invite":null}),"function"==typeof window.lhnJsSdkInviteAccepted&&window.lhnJsSdkInviteAccepted(),clearTimeout(lhnJsSdk.trigger_timeout),hideInvite(),null!=motive&&doGaTrack("LiveChat","Invite-Accepted",!1)})),lhnQuery(document).off("keyup",".lhnHocInviteButton.lhncancel").on("keyup",".lhnHocInviteButton.lhncancel",(function(e){32!=e.keyCode&&13!=e.keyCode||lhnQuery(this).click()})),lhnQuery(document).off("click",".lhnHocInviteButton.lhncancel").on("click",".lhnHocInviteButton.lhncancel",(function(){if(lhnQuery("#lhnHocInvite").hasClass("lhn_auto"))var e={message_type:1,message_sub_type:136,message:"Auto invitation dismissed"};else if(lhnQuery("#lhnHocInvite").hasClass("lhn_proactive"))e={message_type:1,message_sub_type:137,message:"Proactive invitation dismissed"};else if(lhnQuery("#lhnHocInvite").hasClass("lhn_trigger"))e={message_type:1,message_sub_type:138,message:"Trigger invitation dismissed"};else e=null;hideInvite(),"function"==typeof window.lhnJsSdkInviteRejected&&window.lhnJsSdkInviteRejected(),null!=e&&(chatSessionId=null==lhnJsSdk.chatSession?0:lhnJsSdk.chatSession,ajaxCall(appurl+apiversion+"/chat/"+chatSessionId+"/message/",e,"POST",null,{}),doGaTrack("LiveChat","Invite-Declined",!1))})),lhnQuery(document).on("click",".heart-click",(function(){var e=lhnQuery(this).attr("article-id");lhnQuery("label.heart").removeClass("selected all");for(var n=lhnQuery(this).val(),t=0;t<n;t++)lhnQuery("label.heart.heart-"+(t+1)+" i").removeClass("far fa-heart").addClass("fas fa-heart"),4==t&&lhnQuery("label.heart").addClass("all");ajaxCall(appurl+apiversion+"/kb/article/"+e+"/rating/",{rating:n},"POST",articleRatingCallback,{})}))}))}var o,s,i,r}function generateHocContents(e,n){switch(e){case"chat":if(system_windows[e]=void 0===lhnJsSdk.options.chatWindowId?system_windows.chat:lhnJsSdk.options.chatWindowId,null==lhnJsSdk.lhnsocket||0==lhnJsSdk.lhnsocket.isConnected())if("undefined"==typeof Socket){var t=document.getElementsByTagName("head")[0],a=document.createElement("script");a.type="text/javascript",a.src=appurl+"/js/socket.js";var l=!1;a.onload=a.onreadystatechange=function(){l||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(l=!0,connectSocket(null,vchanConnect),sleep(500).then((function(){embedPreChat("hocSys"+e,system_windows[e],n)})))},t.appendChild(a)}else connectSocket(null,vchanConnect),sleep(500).then((function(){embedPreChat("hocSys"+e,system_windows[e],n)}));else embedPreChat("hocSys"+e,system_windows[e],n);break;case"ticket":embedTicket("hocSys"+e,system_windows[e]);break;case"knowledge":embedKbLookup("hocSys"+e,system_windows[e]);break;case"callback":system_windows[e]=void 0===lhnJsSdk.options.callbackWindowId?system_windows.callback:lhnJsSdk.options.callbackWindowId,embedCallback("hocSys"+e,system_windows[e])}}function embedPreChat(e,n,t){if(lhnQuery("#hocSyschat").html(""),lhnJsSdk.chatSession="timeout"==chatType?null:void 0===lhnJsSdk.chatSession?lhnStorage.getData("lhnChatSession"):lhnJsSdk.chatSession,lhnJsSdk.chatSession)firstOpen.chat=!1,embedChat(e,n,null);else if("conversation"==chatMode&&1==lhnJsSdk.isOnline)lookupConversation(e,n,t);else if("jump_logic"!=preChatType&&"hocSyschat"!=e&&void 0!==(a=ajaxCall(appurl+apiversion+"/chat/is_bot/",{view_id:n},"GET","inline",{async:!1})).responseJSON.payload&&(preChatType=1==a.responseJSON.payload.is_bot?"jump_logic":preChatType),lhnQuery(".lhnHocOverlay").show(),lhnQuery(".lhnloading").show(),0==lhnJsSdk.isOnline&&("jump_logic"!=preChatType||"jump_logic"==preChatType&&"timeout"==chatType))switch(Object.keys(chatOfflineType)[0]){case"callback":lhnQuery(".lhnHocSection[systemtype='callback']").length>0?(lhnQuery(".lhnHocSection[systemtype='chat']").remove(),lhnQuery(".lhnHocTab[systemtype='chat']").remove(),lhnQuery(".lhnHocTab").length>1?lhnQuery(".lhnHocTab").css("width",100/lhnQuery(".lhnHocTab").length+"%"):(lhnQuery(".lhnHocToggleMenu, .lhnWindow-tabs").hide(),lhnQuery("#hocContainer").addClass("no-menu")),setTimeout((function(){openHOC("cb")}),0)):(embedCallback(e,chatOfflineType.callback),chatType="offline",updateHeaderFooter("chat"));break;case"ticket":lhnQuery(".lhnHocSection[systemtype='ticket']").length>0?(lhnQuery(".lhnHocSection[systemtype='chat']").remove(),lhnQuery(".lhnHocTab[systemtype='chat']").remove(),lhnQuery(".lhnHocTab").length>1?lhnQuery(".lhnHocTab").css("width",100/lhnQuery(".lhnHocTab").length+"%"):(lhnQuery(".lhnHocToggleMenu, .lhnWindow-tabs").hide(),lhnQuery("#hocContainer").addClass("no-menu")),setTimeout((function(){openHOC("t")}),0)):(embedTicket(e,chatOfflineType.ticket),chatType="offline",updateHeaderFooter("chat"));break;case"bot":preChatType="jump_logic",embedPreChat(e,chatOfflineType.bot,t);break;default:ajaxCall(appurl+apiversion+"/ui/form/",a={system:"chat",layout:"hoc",partial:"offline",view_id:n},"GET",embedOfflineChatCallback,{el:e,win:n})}else{t=void 0!==t?t:{};var a,l={el:e,win:n};if("jump_logic"==preChatType||void 0!==t.invite)void 0!==t&&(l=lhnQuery.extend(l,t)),ajaxCall(appurl+apiversion+"/ui/form/",a={system:"chat",layout:"hoc",partial:"conversation",view_id:n,type:"jump_logic"},"GET",embedJumpLogic,l);else ajaxCall(appurl+apiversion+"/ui/form/",a={system:"chat",layout:"hoc",partial:"pre_conversation",view_id:n},"GET",embedPreChatCallback,l)}}function embedJumpLogic(e,n){void 0!==lhnJsSdk.lhnsocket&&null!=lhnJsSdk.lhnsocket&&0!=lhnJsSdk.lhnsocket.isConnected()||connectSocket(null,vchanConnect),void 0!==e.payload&&0==lhnQuery(".lhnChat").length&&embedChatSetup(e,n,"jumplogic",fetchSubmittedJumpLogic,jumpLogicStartChat),lhnQuery(".lhnHocOverlay").hide(),lhnQuery(".lhnloading").hide()}function fetchSubmittedJumpLogic(e,n){ajaxCall(appurl+apiversion+"/chat/prechat_question/submitted",{view_id:e},"GET",fetchSubmittedJumpLogicCallback,n)}function fetchSubmittedJumpLogicCallback(e,n){if(void 0!==e.payload)if(stopInactivityTimer(),null!=e.payload.messages){void 0===lhnJsSdk.fieldData&&(lhnJsSdk.fieldData={});for(var t=0;t<e.payload.messages.length;t++){lhnJsSdk.fieldData[e.payload.messages[t].crm]=e.payload.messages[t].answer,n.jumplogic=JSON.parse(e.payload.messages[t].jump_logic),n.value=e.payload.messages[t].answer,n.fetch=!0,n.submitted=!0;var a=parseInt(e.payload.messages[t].field_info.split("_")[1]);lhnQuery(".lhnChat").append('<div class="lhnOperatorMessage oldjumplogic lhnWindow-message--container"><span></span><div class="lhnWindow-message">'+jumpLogicTokenReplace(e.payload.messages[t].question)+'</div><span class="lhnTime"></span></div>'),lhnQuery(".lhnChat").append("<div id='"+e.payload.messages[t].field_info+"' class=\"lhnCustomerMessage lhnWindow-message--container\" attr='"+a+'\'><span></span><div class="lhnWindow-message">'+e.payload.messages[t].answer+'</div><span class="lhnTime"></span></div>'),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight),n.field_id=parseInt(e.payload.messages[t].field_info.split("_")[2]),preChatFunc({},n)}}else fetchNextJumpLogic(n.win,1,n)}function fetchNextJumpLogic(e,n,t){var a={view_id:e,order:n};t.submitted=!1,0==lhnQuery("[id^=fld_"+n+"_]").length&&ajaxCall(appurl+apiversion+"/chat/prechat_question",a,"GET",embedPreChatQuestionCallback,t)}function jumpLogicTokenReplace(e){for(var n=/{{(\d*)}}/,t=n.exec(e);null!=t;){var a=lhnQuery(".lhnCustomerMessage[attr='"+t[1]+"'] .lhnWindow-message").text();e=e.replace(t[0],a),t=n.exec(e)}return e}function embedPreChatQuestionCallback(e,n){void 0!==e.payload&&(chatTypingStatus({operator_typing:!0}),setTimeout((function(){chatTypingStatus({operator_typing:!1});var t=checkMsgForVideoLinks(e.payload.html);t=jumpLogicTokenReplace(t=convertUrlsAndImages(t)),lhnQuery(t).appendTo("#"+n.el),playSound(),1==lhnJsSdk.options.jumplogic.allow_messages&&lhnJsSdk.isOnline&&lhnQuery(".lhnWindow-chat_input > form").show(),lhnQuery(".lhnWindow-message--container:last-child .lhnInput").focus(),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight),n.jumplogic=JSON.parse(e.payload.jump_logic),lhnQuery(document).off("click",".lhnChat .lhnOption").on("click",".lhnChat .lhnOption",(function(e){lhnQuery(this).closest(".lhnFieldInput").hide(),submitPreChatQuestion(lhnQuery(this).closest(".lhnFieldInput").find("> input").attr("name"),lhnQuery(this).attr("value"),lhnQuery(this).text(),lhnQuery(this).closest(".lhnFieldInput").find("> input").attr("crm"),n),lhnQuery(document).off("click",".lhnChat .lhnOption")})),lhnQuery(document).off("click",".lhnChat .jumplogic .lhnRadioGroup label > span").on("click",".lhnChat .jumplogic .lhnRadioGroup label > span",(function(e){lhnQuery(this).closest(".lhnFieldInput").hide(),submitPreChatQuestion(lhnQuery(this).parent().find("> input").attr("name"),lhnQuery(this).text(),lhnQuery(this).text(),lhnQuery(this).closest(".lhnFieldInput").find("> input").attr("crm"),n),lhnQuery(document).off("click",".lhnChat .jumplogic .lhnRadioGroup label > span")})),lhnQuery(document).off("click",".lhnChat .jumplogic .lhnSendButton").on("click",".lhnChat .jumplogic .lhnSendButton",(function(e){if(validate(n.el)){if(lhnQuery(this).parent().hide(),void 0!==lhnQuery(this).closest(".lhnPhoneField")[0])var t=lhnQuery(this).parent().parent().find("input[type='hidden']");else t=lhnQuery(this).parent().find(".lhnInput");return submitPreChatQuestion(t.attr("name"),t.val(),t.val(),t.attr("crm"),n),lhnQuery(document).off("keyup",".lhnChat .jumplogic .lhnInput"),lhnQuery(document).off("click",".lhnChat .jumplogic .lhnSendButton"),lhnQuery(this).prop("disabled","disabled"),e.preventDefault(),!1}})),lhnQuery(document).off("keydown",".lhnChat .jumplogic .lhnInput").on("keydown",".lhnChat .jumplogic .lhnInput",(function(e){if(13==e.which||9==e.which)return e.preventDefault(),!1})),lhnQuery(document).off("keyup",".lhnChat .jumplogic .lhnInput").on("keyup",".lhnChat .jumplogic .lhnInput",(function(e){if((13==e.which||9==e.which)&&validate(n.el))return lhnQuery(this).parent().hide(),submitPreChatQuestion(lhnQuery(this).attr("name"),lhnQuery(this).val(),lhnQuery(this).val(),lhnQuery(this).attr("crm"),n),lhnQuery(document).off("keyup",".lhnChat .jumplogic .lhnInput"),lhnQuery(document).off("click",".lhnChat .jumplogic .lhnSendButton"),lhnQuery(this).prop("disabled","disabled"),e.preventDefault(),!1;""!=lhnQuery.trim(lhnQuery(this).val())?lhnQuery(this).parent().parent().find("button").addClass("lhnShow"):lhnQuery(this).parent().parent().find("button").removeClass("lhnShow")})),lhnQuery(document).ready((function(){autoFillForm("lhnChat",null,{}),"19"==e.payload.field_type&&($el=lhnQuery(".lhnOperatorMessage.jumplogic").last().find("label"),submitPreChatQuestion($el.attr("for"),"","",$el.attr("crm"),n))}))}),1e3))}function submitPreChatQuestion(e,n,t,a,l){vchanConnect(),t=html2text(t);var o={field_info:e,value:n};l.value=n;var s=parseInt(e.split("_")[3]),i=parseInt(e.split("_")[1]);if(l.field_id=parseInt(e.split("_")[2]),28==s&&""!=lhnQuery.trim(n)?(custName=lhnQuery.trim(n),lhnStorage.setData("lhnCustName",custName)):111==s&&""!=lhnQuery.trim(n).split(" ")[0]&&(custName=lhnQuery.trim(n).split(" ")[0],lhnStorage.setData("lhnCustName",custName)),void 0===lhnJsSdk.fieldData&&(lhnJsSdk.fieldData={}),lhnJsSdk.fieldData[a]=n,""!=n?ajaxCall(appurl+apiversion+"/chat/prechat_question",o,"PUT",preChatFunc,l):preChatFunc({},l),t=convertUrlsAndImages(t=checkMsgForVideoLinks(t)),""!=n&&(lhnQuery(".lhnChat").append("<div id='"+e+"' class=\"lhnCustomerMessage lhnWindow-message--container\" attr='"+i+'\'><span></span><div class="lhnWindow-message">'+t+'</div><span class="lhnTime"></span></div>'),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight)),"function"==typeof window.lhnJsSdkBotInputReceived){var r=lhnQuery.trim(lhnQuery("label[for='"+e+"'] p").text());window.lhnJsSdkBotInputReceived(r,n)}lhnJsSdk.vChan.push("jump_logic:message",{field_info:e,order:i,text:t},1e4)}function submitPreChatQuestionCallback(e,n){void 0!==e.jwt&&null!=e.jwt&&lhnStorage.setData("lhnJWT",e.jwt,e.jwt_expire);for(var t=null,a=!1,l=0;l<n.jumplogic.length;l++)if(!a){var o=n.jumplogic[l].conditions;if(null==o)t=n.jumplogic[l].actions;else{for(var s=0;s<o.length&&(a=jumpLogicConditionCheck(o[s],n.value));s++);a&&(t=n.jumplogic[l].actions)}}parseAction(t,0,n)}function submitPreChatQuestionBe(e,n){jl_working=!0,void 0!==e.jwt&&null!=e.jwt&&lhnStorage.setData("lhnJWT",e.jwt,e.jwt_expire),n.chat_session_id=lhnJsSdk.chatSession,n.pre_chat_type=preChatType,n.current_dept=lhnJsSdk.options.dept,n.is_online=lhnJsSdk.isOnline,n.current_url=window.location.href,n.submitted=n.submitted,n.tab_id=tabId,n.fetch=n.fetch,ajaxCall(appurl+apiversion+"/chat/jump_logic",n,"POST",null,n)}function processActions(e){e.tab_id=tabId,ajaxCall(appurl+apiversion+"/chat/jump_logic/actions",e,"POST",null,null)}function preChatFunc(e,n){submitPreChatQuestionBe(e,n)}function jumpLogicConditionCheck(e,n){switch(Object.keys(e)[0]){case"selection":return e.selection==n;case"is":return e.is==n;case"isnot":return e.isnot!=n;case">":return n>parseInt(e[">"]);case">=":return n>=parseInt(e[">="]);case"<":return n<parseInt(e["<"]);case"<=":return n<=parseInt(e["<="]);case"contains":return n.indexOf(e.contains)>-1;case"notcontains":return n.indexOf(e.notcontains)<0;case"online":return lhnJsSdk.isOnline==e.online;case"regex":return new RegExp(e.regex,"gi").test(n);case"current_page":return window.location.href.indexOf(e.current_page)>-1;case"previous_question":for(var t=lhnQuery(".lhnCustomerMessage[attr='"+e.previous_question.question+"'] .lhnWindow-message").text(),a=!1,l=e.previous_question.conditions,o=0;o<l.length;o++){if(!(a=jumpLogicConditionCheck(l[o],t)))break}return a}}function parseAction(actions,i,opts){var action_length=actions.length,action=actions[i];switch(i+=1,jl_working=!0,Object.keys(action)[0]){case"goto":(void 0===opts.fetch||void 0!==opts.fetch&&1!=opts.fetch)&&(fetchNextJumpLogic(opts.win,action.goto,opts),lhnJsSdk.vChan.push("jump_logic:new_question",{win:opts.win,goto:action.goto,opts:opts},1e4));break;case"text":lhnQuery(".lhnChat").append('<div class="lhnOperatorMessage lhnWindow-message--container"><span></span><div class="lhnWindow-message">'+jumpLogicTokenReplace(action.text)+'</div><span class="lhnTime"></span></div>'),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight);break;case"close_window":lhnJsSdk.closeHOC();break;case"start_chat":(void 0===opts.fetch||void 0!==opts.fetch&&1!=opts.fetch)&&jumpLogicStartChat(opts);break;case"start_sms":(void 0===opts.fetch||void 0!==opts.fetch&&1!=opts.fetch)&&ajaxCall(appurl+apiversion+"/chat/create/sms",{client_sms:action.start_sms},"POST",null,{});break;case"end_chat":endChat();break;case"dept":lhnJsSdk.options.dept!=action.dept&&(lhnJsSdk.options.dept=action.dept,ajaxCall(appurl+apiversion+"/visitor/update_dept",{dept:action.dept},"POST",null,{}),vchanLeave(),vchanConnect(),lhnJsSdk.vChan.push("jump_logic:dept",{dept:action.dept},1e4));break;case"email":(void 0===opts.fetch||void 0!==opts.fetch&&1!=opts.fetch)&&1!=opts.submitted&&ajaxCall(appurl+apiversion+"/chat/0/email_transcript",action.email,"POST",null,{});break;case"kb_article":lhnQuery(".lhnChat").append('<div class="lhnOperatorMessage lhnWindow-message--container"><span></span><div class="lhnWindow-message"><div id="lhnKbEmbed"></div></div><span class="lhnTime"></span></div>'),setTimeout((function(){lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight)}),200);var lhnArticleId=action.kb_article;embedKbArticle(lhnArticleId,"lhnKbEmbed"),lhnQuery(document).ready((function(){lhnQuery(document).off("click","#lhnKbEmbed").on("click","#lhnKbEmbed",(function(){if(lhnQuery(".lhnExternal").length<1){if(lhnJsSdk.isHOC)var e=lhnJsSdk.settings.styles.position;else e="right";n=document,t=appurl+"/css/modern/external.css",a=n.getElementsByTagName("head")[0],(l=n.createElement("link")).type="text/css",l.rel="stylesheet",l.href=t,a.appendChild(l),lhnJsSdk.options.embedArticleDirection=void 0===lhnJsSdk.options.embedArticleDirection?e:lhnJsSdk.options.embedArticleDirection,lhnExternal=document.createElement("div"),lhnExternal.className="lhnExternal standalone "+lhnJsSdk.options.embedArticleDirection,lhnExternal.style.display="none",lhnExternal.innerHTML='<a href="#" class="lhnHocExternalClose">close</a><div class="lhnExternalContainer"></div>',document.body.appendChild(lhnExternal),lhnQuery(document).ready((function(){lhnQuery(document).off("click",".lhnHocExternalClose").on("click",".lhnHocExternalClose",(function(){return externalPageClose(),!1})),lhnQuery(".lhnExternal.standalone").show()}))}var n,t,a,l;embedKbArticle(lhnArticleId,"lhnExternal")}))}));break;case"callback":if(void 0===opts.fetch||void 0!==opts.fetch&&1!=opts.fetch){var cb=action.callback;lhnQuery(".lhnChat").append('<div rel="cb'+cb+'" class="lhnWindow-message--container"><div class="hocSecureForm"><div class="form_chat_btn form_not_filled">'+lhnJsSdk.dict.callbackTitle+"</div></div></div>"),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight),lhnQuery("#hocSyschat").append('<div id="cb'+cb+'" class="secure_forms" style="display: none;"><div class="form_close"></div><div class="sf_main_form"></div></div>'),embedCallback("cb"+cb+" .sf_main_form",cb),lhnQuery(document).ready((function(){lhnQuery(document).on("click","[rel='cb"+cb+"']",(function(){return lhnQuery("#cb"+cb).show(),!1})),lhnQuery(document).on("click",".secure_forms .form_close",(function(){return lhnQuery("#cb"+cb).hide(),!1}))}))}break;case"ticket":if(void 0===opts.fetch||void 0!==opts.fetch&&1!=opts.fetch){var ticket=action.ticket;lhnQuery(".lhnChat").append('<div rel="ticket'+ticket+'" class="lhnWindow-message--container"><div class="hocSecureForm"><div class="form_chat_btn form_not_filled">'+lhnJsSdk.dict.ticketTitle+"</div></div></div>"),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight),lhnQuery("#hocSyschat").append('<div id="ticket'+ticket+'" class="secure_forms" style="display: none;"><div class="form_close"></div><div class="sf_main_form"></div></div>'),embedTicket("ticket"+ticket+" .sf_main_form",ticket),lhnQuery(document).ready((function(){lhnQuery(document).on("click","[rel='ticket"+ticket+"']",(function(){return lhnQuery("#ticket"+ticket).show(),!1})),lhnQuery(document).on("click",".secure_forms .form_close",(function(){return lhnQuery("#ticket"+ticket).hide(),!1}))}))}break;case"push_visitor":(void 0===opts.fetch||void 0!==opts.fetch&&1!=opts.fetch)&&ajaxCall(appurl+apiversion+"/visitor/push",{push_to:action.push_visitor},"POST",null,{});break;case"record_outcome":(void 0===opts.fetch||void 0!==opts.fetch&&1!=opts.fetch)&&ajaxCall(appurl+apiversion+"/visitor/record_bot_outcome",{outcome:action.record_outcome,window_id:opts.win},"POST",null,{});break;case"secure_form":if(void 0===opts.fetch||void 0!==opts.fetch&&1!=opts.fetch){var msg=action.secure_form,html="<div id='sf"+i+"' class='lhnWindow-message--container'></div>";lhnQuery(".lhnChat").append(html),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight),loadSecureForms("sf"+i,msg,{prechat:!0})}break;case"delay":return sleep(1e3*action.delay).then((function(){i<action_length&&parseAction(actions,i,opts)})),!1;case"custom_js":custom_js_obj="object"!=_typeof(action.custom_js)?JSON.parse(action.custom_js):action.custom_js,custom_js=jumpLogicTokenReplace(custom_js_obj.js),callback_index=i,"feedback"==custom_js_obj.type?(window.lhnBotCustomJsCallback=function(e){lhnQuery(".lhnChat").append('<div class="lhnOperatorMessage lhnWindow-message--container"><span></span><div class="lhnWindow-message">'+jumpLogicTokenReplace(e)+'</div><span class="lhnTime"></span></div>'),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight),parseAction(actions,callback_index,opts)},window.lhnBotCallback=lhnBotCustomJsCallback,i=action_length,eval(custom_js)):eval(custom_js)}i<action_length?parseAction(actions,i,opts):jl_working=!1,lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight)}"function"!=typeof JSON.parse&&"function"==typeof JSON.decode&&(JSON.parse=JSON.decode,JSON.stringify=JSON.encode);var sleep=function(e){return new Promise((function(n){setTimeout(n,e)}))};function jumplogic_chatended(e,n){startInactivityTimer(),"chat"==chatType&&(closeHOC(),chatType="prechat",lhnQuery("#hocSyschat").html(""),firstOpen.chat=!0)}function jumpLogicStartChat(e){"function"==typeof window.lhnJsSdkPreChatSubmitted&&window.lhnJsSdkPreChatSubmitted(),null!=lhnQuery(".lhnChat").attr("invite")&&""!=lhnQuery(".lhnChat").attr("invite")&&(motive=lhnQuery(".lhnChat").attr("invite"),doGaTrack("LiveChat","Invite-Accepted",!1));var n={view_id:e.win,launch_url:lhnJsSdk.options.pageurl,custom1:lhnJsSdk.options.custom1,custom2:lhnJsSdk.options.custom2,custom3:lhnJsSdk.options.custom3,custom1Label:lhnJsSdk.options.custom1Label,custom2Label:lhnJsSdk.options.custom2Label,custom3Label:lhnJsSdk.options.custom3Label,motive:motive,jumplogic:!0};void 0!==lhnJsSdk.options.operator_id&&(n.operator_id=lhnJsSdk.options.operator_id),ajaxCall(appurl+apiversion+"/chat/create/",n,"POST",joinChatCallback,e),launchedChat=!0,doGaTrack("LiveChat","Chat-Started",!1)}function embedPreChatCallback(e,n){if(void 0!==e.message&&"Department now offline"==e.message)return online_type=0!=lhnJsSdk.options.dept?"department":"client",firstOpen.chat=!1,void updateOnlineStatus({chat:{online_status:!1,online_type:online_type},el:n.el,win:n.win});void 0!==e.payload&&(""==e.payload?(firstOpen.chat=!1,embedChat(n.el,n.win,null)):(lhnQuery("#hocSyschat").html(""),lhnQuery(e.payload.replace(/\r/g,"<br />")).appendTo("#"+n.el),lhnQuery(".lhnHocOverlay").hide(),lhnQuery(".lhnloading").hide(),lhnQuery(document).ready((function(){!lhnStorage.getData("lhnShowedSMS")&&null!=lhnQuery(".lhnPromptAccept.sms").attr("rel")&&""!=lhnQuery(".lhnPromptAccept.sms").attr("rel")&&isMobile()&&lhnQuery(".lhnPrompt.sms, .lhnPromptOverlay.sms").show(),lhnQuery(document).off("click",".lhnSubmit.hocPrechat").on("click",".lhnSubmit.hocPrechat",(function(){return validatePreChatForm(n.el,n.win),!1})),lhnQuery(document).off("keypress",".lhnPreChatForm input[type='text'], .lhnPreChatForm textarea").on("keypress",".lhnPreChatForm input[type='text'], .lhnPreChatForm textarea",(function(e){if(13==e.keyCode&&lhnQuery(".lhnHocOverlay").is(":visible"))return validatePreChatForm(n.el,n.win),!1})),lhnQuery(".lhnPromptAccept.sms").click((function(){"function"==typeof window.lhnJsSdkSmsChatShown&&window.lhnJsSdkSmsChatShown(),window.location="sms:"+lhnQuery(this).attr("rel")})),lhnQuery(".lhnPromptDecline.sms").click((function(){lhnQuery(".lhnPrompt, .lhnPromptOverlay").hide(),lhnStorage.setData("lhnShowedSMS",!0)})),lhnJsSdk.fieldData=void 0!==lhnJsSdk.fieldData?lhnJsSdk.fieldData:void 0!==lhnJsSdk.preChatData?lhnJsSdk.preChatData:void 0,autoFillForm("lhnPreChatForm",validatePreChatForm,n),lhnQuery(".lhnFormButton.hocPrechat").html(lhnJsSdk.dict.startChat)})),chatType="prechat",updateHeaderFooter("chat"),firstOpen.chat=!1,doGaTrack("LiveChat","Prechat-Survey",!1),"function"==typeof window.lhnJsSdkPreChatShown&&window.lhnJsSdkPreChatShown()))}function validatePreChatForm(e,n){lhnQuery(".lhnHocOverlay").show(),lhnQuery(".lhnloading").show(),validate(e)?(lhnQuery(".lhnPreChatForm input, .lhnPreChatForm textarea").each((function(){var e=parseInt(lhnQuery(this).attr("id").split("_")[3]);if(28==e&&""!=lhnQuery.trim(lhnQuery(this).val()))return custName=html2text(lhnQuery.trim(lhnQuery(this).val())),void lhnStorage.setData("lhnCustName",custName);111==e&&""!=lhnQuery.trim(lhnQuery(this).val()).split(" ")[0]&&(custName=html2text(lhnQuery.trim(lhnQuery(this).val()).split(" ")[0]),lhnStorage.setData("lhnCustName",custName))})),null==lhnJsSdk.lhnsocket||0==lhnJsSdk.lhnsocket.isConnected()?(connectSocket(null,vchanConnect),setTimeout((function(){1==lhnJsSdk.isOnline&&embedChat(e,n,lhnQuery(".lhnPreChatForm form").serializeObject(null))}),200)):embedChat(e,n,lhnQuery(".lhnPreChatForm form").serializeObject(null)),lhnQuery(".lhnPreChatForm").hide(),"function"==typeof window.lhnJsSdkPreChatSubmitted&&window.lhnJsSdkPreChatSubmitted()):(lhnQuery(".lhnHocOverlay").hide(),lhnQuery(".lhnloading").hide())}function preChatErrorCallback(e){lhnQuery("#lhnChatTable").remove(),lhnQuery(".lhnPreChatForm").show()}function embedOfflineChatCallback(e,n){void 0!==e.payload&&(lhnQuery("#hocSyschat").html(""),lhnQuery(e.payload).appendTo("#"+n.el),lhnQuery(".lhnHocOverlay").hide(),lhnQuery(".lhnloading").hide(),lhnQuery(document).ready((function(){lhnQuery(document).off("click",".lhnSubmit.hocOffline").on("click",".lhnSubmit.hocOffline",(function(){return validateOfflineChatForm(n.el,n.win),!1})),lhnJsSdk.fieldData=void 0!==lhnJsSdk.fieldData?lhnJsSdk.fieldData:void 0!==lhnJsSdk.preChatData?lhnJsSdk.preChatData:void 0,autoFillForm("lhnOfflineForm",validateOfflineChatForm,n),lhnQuery(".lhnFormButton.hocOffline").html(lhnJsSdk.dict.submit)})),chatType="offline",updateHeaderFooter("chat"),firstOpen.chat=!1,doGaTrack("LiveChat","Offline-Form-Opened",!1),autoFillForm("lhnOfflineForm",validateOfflineChatForm,n),"function"==typeof window.lhnJsSdkOfflineShown&&window.lhnJsSdkOfflineShown())}function validateOfflineChatForm(e,n){if(lhnQuery(".lhnHocOverlay").show(),lhnQuery(".lhnloading").show(),validate(e)){var t=lhnQuery(".lhnOfflineForm form").serializeObject(n);t=lhnQuery.extend(t,{department_id:lhnJsSdk.options.dept});ajaxCall(appurl+apiversion+"/chat/offline",t,"PUT",validateOfflineFormCallback,{el:e})}else lhnQuery(".lhnHocOverlay").hide(),lhnQuery(".lhnloading").hide()}function validateOfflineFormCallback(e,n){void 0!==e.message&&(lhnQuery("#"+n.el+" .lhnOfflineForm").remove(),lhnQuery("#lhnHocFooter button").remove(),lhnQuery("<div class='lhnmsgbox lhnOfflineSuccess'>"+lb2br(e.message)+"</div>").appendTo("#"+n.el),doGaTrack("LiveChat","Offline-Form-Submitted",!1),"function"==typeof window.lhnJsSdkOfflineSubmitted&&window.lhnJsSdkOfflineSubmitted()),lhnQuery(".lhnHocOverlay").hide(),lhnQuery(".lhnloading").hide(),chatType="prechat",firstOpen.chat=!0}function lookupConversation(e,n,t){void 0!==(t=void 0!==t?t:{})&&(t=lhnQuery.extend({el:e,win:n},t));var a={view_id:t.win,launch_url:lhnJsSdk.options.pageurl,custom1:lhnJsSdk.options.custom1,custom2:lhnJsSdk.options.custom2,custom3:lhnJsSdk.options.custom3,motive:motive};void 0!==lhnJsSdk.options.operator_id&&(a.operator_id=lhnJsSdk.options.operator_id),ajaxCall(appurl+apiversion+"/chat/conversation",a,"GET",lookupConversationCallback,t)}function lookupConversationCallback(e,n){if(void 0!==e.payload&&1==e.payload.has_chatted){e={system:"chat",layout:"hoc",partial:"conversation",view_id:n.win,type:"conversation"};ajaxCall(appurl+apiversion+"/ui/form/",e,"GET",embedConversation,n)}else chatMode="standard",embedPreChat(n.el,n.win)}function embedChatSetup(e,n,t,a,l){lhnQuery(e.payload).appendTo("#"+n.el),lhnQuery("#"+n.el+" .lhnPromptMsg").hide(),lhnQuery("#"+n.el+" .lhnPromptAccept.closechat").text(lhnJsSdk.dict.endChat),lhnQuery("#"+n.el+" .lhnPromptDecline.closechat").text(lhnJsSdk.dict.hide),lhnQuery("#"+n.el+" .lhnSendButton").text(lhnJsSdk.dict.send),lhnQuery("#"+n.el+" .lhnChatActions .lhnHocEndChatAction").text(lhnJsSdk.dict.endChat),lhnQuery("#"+n.el+" .lhnChatActions .lhnHocEmailAction").text(lhnJsSdk.dict.email),lhnQuery("#"+n.el+" .lhnChatActions .lhnHocFileUploadAction").text(lhnJsSdk.dict.uploadFile),lhnQuery("#"+n.el+" #lhnChatMessageBox .message").attr("placeholder",lhnJsSdk.dict.chatBoxPlaceholder),lhnQuery("#"+n.el+" #lhnChatMessageBox label").text(lhnJsSdk.dict.chatBoxPlaceholder),firstOpen.chat=!1;chatType="chat",updateHeaderFooter("chat"),"function"==typeof window.lhnJsSdkPreChatShown&&window.lhnJsSdkPreChatShown(),lhnQuery(document).ready((function(){if(disableEndChat&&lhnQuery("#"+n.el+" .lhnChatActions .lhnHocEndChatAction").remove(),lhnQuery(".lhnHocBillboards").length>0){lhnQuery("#hocSyschat.lhnHocSection").addClass("hasBillboard");var e=lhnQuery(".lhnHocBillboards").attr("data-cycle-slides"),o=lhnQuery(".lhnHocBillboards "+e).length,s=o;lhnQuery(".lhnHocBillboards "+e).each((function(){s==o&&lhnQuery(this).addClass("lhnCurrentBillboard"),lhnQuery(this).css("z-index",s),s--})),lhn_billboard_rotate=setInterval((function(){lhnQuery(".lhnCurrentBillboard").fadeOut("slow",(function(){lhnQuery(this).css("z-index",0),lhnQuery(this).removeClass("lhnCurrentBillboard"),lhnQuery(this).index()<o-1?lhnQuery(this).next().addClass("lhnCurrentBillboard"):lhnQuery(this).siblings().first().addClass("lhnCurrentBillboard"),lhnQuery(this).show(),lhnQuery(".lhnHocBillboards "+e).each((function(){lhnQuery(this).css("z-index",parseInt(lhnQuery(this).css("z-index"))+1)}))}))}),lhnQuery(".lhnHocBillboards").attr("data-cycle-timeout"))}if("chat"!=t){if(lhnQuery(".lhnCustomerMessage > div, .lhnOperatorMessage > div").css("border-radius","5px"),lhnQuery(".lhnCustomerMessage > span, .lhnOperatorMessage > span").css("font-size","12px"),lhnQuery(document).off("keypress","#lhnChatMessageBox > textarea").on("keypress","#lhnChatMessageBox > textarea",(function(e){return 13==e.keyCode&&""!=lhnQuery.trim(lhnQuery("#lhnChatMessageBox > textarea").val())?(null!=custName&&(n.from_name=custName),lhnJsSdk.chatSession||(n.new_message=lhnQuery("#lhnChatMessageBox > textarea").val(),l(n)),!1):13==e.keyCode||lhnQuery(this).val().length>=4e3?(e.preventDefault(),!1):void 0})),lhnQuery(document).off("input","#lhnChatMessageBox > textarea").on("input","#lhnChatMessageBox > textarea",(function(e){if(oldCustomerTyping=isCustomerTyping,""!=lhnQuery.trim(lhnQuery("#lhnChatMessageBox > textarea").val())){var n=!0;isCustomerTyping=!0,lhnQuery(".lhnInput-chat_input-buttons .lhnSendButton").addClass("lhnShow")}else{n=!1;isCustomerTyping=!1,lhnQuery(".lhnInput-chat_input-buttons .lhnSendButton").removeClass("lhnShow")}oldCustomerTyping!=isCustomerTyping&&null!=lhnJsSdk.chatSession&&ajaxCall(appurl+apiversion+"/chat/"+lhnJsSdk.chatSession+"/set_typing_status/",{status:n},"POST",null,{})})),lhnQuery(document).off("click",".lhnSendButton").on("click",".lhnSendButton",(function(){return""!=lhnQuery.trim(lhnQuery("#lhnChatMessageBox > textarea").val())&&(null!=custName&&(n.from_name=custName),lhnJsSdk.chatSession||(n.new_message=lhnQuery("#lhnChatMessageBox > textarea").val(),l(n))),!1})),lhnQuery(document).off("click",".lhnChatActionsMenu").on("click",".lhnChatActionsMenu",(function(e){lhnQuery(".lhnChatActions").toggle(),lhnQuery(".lhnChatActions").is(":visible")&&lhnQuery(".lhnChatActions .lhnHocEndChatAction").focus()})),lhnQuery(document).off("keyup",".lhnChatActionsMenu").on("keyup",".lhnChatActionsMenu",(function(e){32!=e.keyCode&&13!=e.keyCode||lhnQuery(this).click()})),lhnQuery(document).on("click","#lhnHelpOutCenter, #lhnHelpOutCenter *",(function(e){lhnQuery(e.target).is(".lhnChatActions, .lhnChatActions *, .lhnChatActionsMenu, .lhnChatActionsMenu *")||lhnQuery(".lhnChatActions").hide()})),lhnQuery(document).off("click",".lhnChatActions .lhnHocEndChatAction").on("click",".lhnChatActions .lhnHocEndChatAction",(function(e){return endChat(),lhnQuery(".lhnChatActions").hide(),!1})),lhnQuery(document).off("click",".lhnChatActions .lhnHocEmailAction").on("click",".lhnChatActions .lhnHocEmailAction",(function(e){return displayEmailForm(),lhnQuery(".lhnChatActions").hide(),!1})),lhnQuery(document).off("click",".lhnChatActions .lhnHocFileUploadAction").on("click",".lhnChatActions .lhnHocFileUploadAction",(function(e){return displayFileUpload(""),lhnQuery(".lhnChatActions").hide(),!1})),lhnQuery(document).off("keyup",".lhnChat #lhnHocEmailTo").on("keyup",".lhnChat #lhnHocEmailTo",(function(){""==lhnQuery.trim(lhnQuery(this).val())?lhnQuery(".lhnChat .hocEmailChat").hide():lhnQuery(".lhnChat .hocEmailChat").show()})),lhnQuery(document).off("click",".lhnChat .hocEmailChat").on("click",".lhnChat .hocEmailChat",(function(e){return emailChat(lhnQuery(this).parent().find(".lhnHocEmailTo").val(),lhnQuery(this).parent()),!1})),n.el=n.el+" .lhnChat",void 0!==n.invite&&"open_chat_window"!=n.invite){"conversation"==t&&a(n.win,n);var i=new Date,r=i.getHours()+":"+("0"+i.getMinutes()).slice(-2),h=checkMsgForVideoLinks(n.invite);h=convertUrlsAndImages(h);var c="proactive"==n.invite_type?n.invite_id:"invite";lhnQuery(".lhnChat").append("<div id='"+c+"' class='lhnOperatorMessage lhnWindow-message--container'><span></span><div class=\"lhnWindow-message\">"+h+'</div><span class="lhnTime">'+r+"</span></div>"),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight),"trigger"==n.invite_type?lhnQuery(".lhnChat").attr("invite",n.invite_type+"_invite:"+n.invite_id):lhnQuery(".lhnChat").attr("invite",n.invite_type+"_invite"),lhnQuery(".lhnWindow-chat_input > form").show(),setTimeout((function(){playSound()}),800)}else!lhnStorage.getData("lhnShowedSMS")&&null!=lhnQuery(".lhnPromptAccept.sms").attr("rel")&&""!=lhnQuery(".lhnPromptAccept.sms").attr("rel")&&isMobile()?lhnQuery(".lhnPrompt.sms, .lhnPromptOverlay.sms").show():a(n.win,n);lhnQuery(".lhnPromptAccept.sms").click((function(){"function"==typeof window.lhnJsSdkSmsChatShown&&window.lhnJsSdkSmsChatShown(),window.location="sms:"+lhnQuery(this).attr("rel")})),lhnQuery(".lhnPromptDecline.sms").click((function(){a(n.win,n),lhnQuery(".lhnPrompt, .lhnPromptOverlay").hide(),lhnStorage.setData("lhnShowedSMS",!0)})),"conversation"==t&&lhnQuery(".lhnWindow-chat_input > form").show()}}))}function embedConversation(e,n){if(void 0!==e.message&&"Department now offline"==e.message)return online_type=0!=lhnJsSdk.options.dept?"department":"client",firstOpen.chat=!1,void updateOnlineStatus({chat:{online_status:!1,online_type:online_type},el:n.el,win:n.win});"undefined"!=e.payload&&0==lhnQuery(".lhnChat").length&&(embedChatSetup(e,n,"conversation",fetchConversation,conversationStartChat),lhnQuery(document).ready((function(){lhnQuery(".lhnChat").scroll((function(){if(lhnQuery(".lhnChat").scrollTop()<=300&&moreMessages&&!isLoadingMessages){isLoadingMessages=!0;var e={limit:15,ending_message_id:firstMessageId=lhnQuery(".lhnChat .lhnWindow-message--container").first().attr("id")};ajaxCall("conversation"==chatMode?appurl+apiversion+"/chat/visitor/history/":appurl+apiversion+"/chat/"+lhnJsSdk.chatSession+"/history/",e,"GET",moreChatMessagesCallback,{})}}))}))),lhnQuery(".lhnHocOverlay").hide(),lhnQuery(".lhnloading").hide()}function fetchConversation(e,n){ajaxCall(appurl+apiversion+"/chat/visitor/history/",{limit:15},"GET",moreChatMessagesCallback,n)}function conversationStartChat(e){"function"==typeof window.lhnJsSdkPreChatSubmitted&&window.lhnJsSdkPreChatSubmitted(),null!=lhnQuery(".lhnChat").attr("invite")&&""!=lhnQuery(".lhnChat").attr("invite")&&(motive=lhnQuery(".lhnChat").attr("invite"),doGaTrack("LiveChat","Invite-Accepted",!1));var n={view_id:e.win,launch_url:lhnJsSdk.options.pageurl,custom1:lhnJsSdk.options.custom1,custom2:lhnJsSdk.options.custom2,custom3:lhnJsSdk.options.custom3,custom1Label:lhnJsSdk.options.custom1Label,custom2Label:lhnJsSdk.options.custom2Label,custom3Label:lhnJsSdk.options.custom3Label,motive:motive,jumplogic:!0};void 0!==lhnJsSdk.options.operator_id&&(n.operator_id=lhnJsSdk.options.operator_id),ajaxCall(appurl+apiversion+"/chat/conversation/",n,"POST",joinChatCallback,e),launchedChat=!0,doGaTrack("LiveChat","Chat-Started",!1)}function embedChat(e,n,t){lhnQuery(".lhnHocOverlay").show(),lhnQuery(".lhnloading").show();var a={system:"chat",layout:"hoc",partial:"conversation",view_id:n};lhnJsSdk.chatSession&&(a.args={chat_session:lhnJsSdk.chatSession});var l={el:e,win:n};void 0!==t&&null!=t&&(l.prechat=t),ajaxCall(appurl+apiversion+"/ui/form/",a,"GET",embedChatCallback,l)}function embedChatCallback(e,n){if(void 0!==e.message&&"Department now offline"==e.message){var t=0!=lhnJsSdk.options.dept?"department":"client";return firstOpen.chat=!1,void updateOnlineStatus({chat:{online_status:!1,online_type:t},el:n.el,win:n.win})}if(void 0!==e.payload&&0==lhnQuery(".lhnChat").length)if(embedChatSetup(e,n,"chat"),null==lhnJsSdk.chatSession){e={view_id:n.win,launch_url:lhnJsSdk.options.pageurl,custom1:lhnJsSdk.options.custom1,custom2:lhnJsSdk.options.custom2,custom3:lhnJsSdk.options.custom3,custom1Label:lhnJsSdk.options.custom1Label,custom2Label:lhnJsSdk.options.custom2Label,custom3Label:lhnJsSdk.options.custom3Label,motive:motive};var a={el:n.el};"undefined"!=n.prechat&&null!=n.prechat&&(e.prechat=n.prechat,a.errorCallback=preChatErrorCallback),void 0!==lhnJsSdk.options.operator_id&&(e.operator_id=lhnJsSdk.options.operator_id),!lhnStorage.getData("lhnShowedSMS")&&isMobile()&&lhnQuery(".lhnPrompt.sms").length>0?lhnQuery(".lhnPrompt.sms, .lhnPromptOverlay.sms").show():(ajaxCall(appurl+apiversion+"/chat/create/",e,"POST",joinChatCallback,a),launchedChat=!0,doGaTrack("LiveChat","Chat-Started",!1)),lhnQuery(document).ready((function(){lhnQuery(".lhnPromptAccept.sms").click((function(){"function"==typeof window.lhnJsSdkSmsChatShown&&window.lhnJsSdkSmsChatShown(),window.location="sms:"+lhnQuery(this).attr("rel")})),lhnQuery(".lhnPromptDecline.sms").click((function(){lhnQuery(".lhnPrompt, .lhnPromptOverlay").hide(),lhnStorage.setData("lhnShowedSMS",!0),ajaxCall(appurl+apiversion+"/chat/create/",e,"POST",joinChatCallback,a),launchedChat=!0,doGaTrack("LiveChat","Chat-Started",!1)}))}))}else joinChatCallback({payload:{}},n);lhnQuery(".lhnHocOverlay").hide(),lhnQuery(".lhnloading").hide()}function joinChatCallback(e,n){if(void 0!==e.jwt&&null!=e.jwt&&lhnStorage.setData("lhnJWT",e.jwt,e.jwt_expire),void 0!==e.payload&&(lhnJsSdk.chatSession||void 0!==e.payload.chat_session_id)){lhnQuery(".lhnPreChatForm").remove(),lhnQuery(".lhnWindow-chat_input > form").show(),lhnJsSdk.chatSession=lhnJsSdk.chatSession?lhnJsSdk.chatSession:e.payload.chat_session_id,0==lhnJsSdk.isHOC&&lhnStorage.setData("lhnChatSession",lhnJsSdk.chatSession,300),void 0!==e.payload.operator&&(lhnQuery(".lhnOperatorName").text(e.payload.operator.name),lhnQuery(".lhnOperatorDesc").text(e.payload.operator.description),lhnQuery(".lhnWindow-header h4").html('<span class="lhnAgentStatus lhnAgentStatus--active"></span>'+e.payload.operator.name),""!=e.payload.operator.image?(lhnQuery(".lhnOperatorImage, .lhnWindow-header-avatar--img").addClass("hasImage"),lhnQuery(".lhnOperatorImage, .lhnWindow-header-avatar--img").html('<img src="'+e.payload.operator.image+'" />')):(lhnQuery(".lhnOperatorImage, .lhnWindow-header-avatar--img").removeClass("hasImage"),lhnQuery(".lhnOperatorImage, .lhnWindow-header-avatar--img").html(""))),launchedChat&&"function"==typeof window.lhnJsSdkChatStarted&&window.lhnJsSdkChatStarted(),joinChatSessionCallback();lhnQuery(document).ready((function(){lhnQuery(".lhnHocBillboards").length>0&&lhnQuery("#hocSyschat.lhnHocSection").addClass("hasBillboard"),lhnQuery(".lhnCustomerMessage > div, .lhnOperatorMessage > div").css("border-radius","5px"),lhnQuery(".lhnCustomerMessage > span, .lhnOperatorMessage > span").css("font-size","12px"),lhnQuery(document).on("keyup","#lhnChatMessageBox > textarea",(function(e){return 13==e.keyCode&&""!=lhnQuery.trim(lhnQuery(this).val())?(null!=custName&&(n.from_name=custName),chatMsgSent(lhnQuery.trim(lhnQuery(this).val()),n),e.preventDefault(),!1):13==e.keyCode||lhnQuery(this).val().length>=4e3?(e.preventDefault(),!1):void(lhnQuery.trim(lhnQuery(this).val()).length>0?lhnQuery("#hocSyschat").addClass("lhnTextboxActive"):lhnQuery("#hocSyschat").removeClass("lhnTextboxActive"))})),lhnQuery(document).on("keyup","#lhnChatMessageBox > textarea",(function(e){var n=isCustomerTyping;if(""!=lhnQuery.trim(lhnQuery(this).val())){var t=!0;isCustomerTyping=!0,lhnQuery(".lhnInput-chat_input-buttons .lhnSendButton").addClass("lhnShow")}else{t=!1;isCustomerTyping=!1,lhnQuery(".lhnInput-chat_input-buttons .lhnSendButton").removeClass("lhnShow")}n!=isCustomerTyping&&null!=lhnJsSdk.chatSession&&ajaxCall(appurl+apiversion+"/chat/"+lhnJsSdk.chatSession+"/set_typing_status/",{status:t},"POST",null,{}),lhnJsSdk.chatChan.push("visitor_typing:capture",{visitor_text:lhnQuery.trim(lhnQuery(this).val()),customer_language:custLanguageId,operator_language:operLanguageId},lhnJsSdk.chatSession)})),lhnQuery(document).on("click",".lhnSendButton",(function(){return""!=lhnQuery.trim(lhnQuery("#lhnChatMessageBox > textarea").val())&&(null!=custName&&(n.from_name=custName),chatMsgSent(lhnQuery.trim(lhnQuery("#lhnChatMessageBox > textarea").val()),n)),!1})),lhnQuery(document).off("click",".lhnChatActionsMenu").on("click",".lhnChatActionsMenu",(function(e){lhnQuery(".lhnChatActions").toggle(),lhnQuery(".lhnChatActions").is(":visible")&&lhnQuery(".lhnChatActions .lhnHocEndChatAction").focus()})),lhnQuery(document).off("keyup",".lhnChatActionsMenu").on("keyup",".lhnChatActionsMenu",(function(e){32!=e.keyCode&&13!=e.keyCode||lhnQuery(this).click()})),lhnQuery(document).on("click","#lhnHelpOutCenter, #lhnHelpOutCenter *",(function(e){lhnQuery(e.target).is(".lhnChatActions, .lhnChatActions *, .lhnChatActionsMenu, .lhnChatActionsMenu *")||lhnQuery(".lhnChatActions").hide()})),lhnQuery(document).off("click",".lhnChatActions .lhnHocEndChatAction").on("click",".lhnChatActions .lhnHocEndChatAction",(function(e){return endChat(),lhnQuery(".lhnChatActions").hide(),!1})),lhnQuery(document).off("click",".lhnChatActions .lhnHocEmailAction").on("click",".lhnChatActions .lhnHocEmailAction",(function(e){return displayEmailForm(),lhnQuery(".lhnChatActions").hide(),!1})),lhnQuery(document).off("click",".lhnChatActions .lhnHocFileUploadAction").on("click",".lhnChatActions .lhnHocFileUploadAction",(function(e){return displayFileUpload(""),lhnQuery(".lhnChatActions").hide(),!1})),lhnQuery(document).on("click",".removeAttachment",(function(){lhnAttachmentCount--,lhnQuery(this).parent().remove(),0==lhnAttachmentCount&&lhnQuery(".uploadNote").show()})),lhnQuery(document).off("keyup",".lhnChat #lhnHocEmailTo").on("keyup",".lhnChat #lhnHocEmailTo",(function(){""==lhnQuery.trim(lhnQuery(this).val())?lhnQuery(".lhnChat .hocEmailChat").hide():lhnQuery(".lhnChat .hocEmailChat").show()})),lhnQuery(document).off("click",".lhnChat .hocEmailChat").on("click",".lhnChat .hocEmailChat",(function(e){return emailChat(lhnQuery(this).parent().find(".lhnHocEmailTo").val(),lhnQuery(this).parent()),!1})),lhnQuery(document).on("click",".lhnChat #submitAttachments",(function(){return 0==lhnQuery("#dropContainer").find(".attachmentContainer").length?(lhnQuery(".uploadNote").text("Please click here or drop a file to upload an attachment").css("color","#a94442").delay(5e3).queue((function(e){lhnQuery(".uploadNote").text("Click here or drop a file to add up to 5 attachments. Use buttons below to submit or delete all attachments.").css("color","inherit"),e()})),!1):(lhnQuery("#submitAttachments").hide(),lhnQuery("#removeAttachments").hide(),lhnQuery("#dropContainer").find(".attachmentContainer").each((function(){uploadFile(lhnQuery(this).find(".attachmentData").val(),lhnQuery(this).parent().parent().parent());var e={message_id:lhnQuery(this).parent().parent().parent().attr("id")};""!=e.message_id&&ajaxCall(appurl+apiversion+"/chat/"+lhnJsSdk.chatSession+"/ack/",e,"POST",null,{})})),lhnQuery("#dropContainer").remove(),lhnAttachmentCount=0,!1)})),lhnQuery(document).on("click","#removeAttachments",(function(){lhnQuery(".hocActionFileUpload").remove()})),lhnQuery(document).off("click","#dropContainer").on("click","#dropContainer",(function(e){"removeAttachment"!=e.target.className&&lhnQuery("#fileUpload").trigger("click")})),document.addEventListener("dragover",(function(e){e.preventDefault()}),!1),document.addEventListener("drop",(function(e){"dropLocation"!=e.target.className&&"uploadNote"!=e.target.className&&"fileName"!=e.target.className&&"attachmentIcon"!=e.target.className&&"attachmentContainer"!=e.target.className&&"removeAttachment"!=e.target.className||(e.preventDefault(),fileUpload(e))}),!1),document.addEventListener("change",(function(e){"file-upload"==e.target.name&&(e.preventDefault(),fileUpload(e),lhnQuery("#fileUpload").val(""))}),!1),lhnQuery(document).off("click",".lhnChat .hocRemoteAssistAccept").on("click",".lhnChat .hocRemoteAssistAccept",(function(e){var n={message:"-Desktop-Sharing-Accept-"+lhnQuery(this).closest(".hocRemoteAssist").attr("rel"),message_type:1,message_sub_type:55};ajaxCall(appurl+apiversion+"/chat/"+lhnJsSdk.chatSession+"/message/",n,"POST",null,{});n={message_id:lhnQuery(this).parent().attr("id")};return ajaxCall(appurl+apiversion+"/chat/"+lhnJsSdk.chatSession+"/ack/",n,"POST",null,{}),lhnQuery(this).parent().remove(),!1})),lhnQuery(document).off("click",".lhnChat .hocRemoteAssistDecline").on("click",".lhnChat .hocRemoteAssistDecline",(function(e){var n={message:"Desktop sharing session invitation has been declined by the visitor.",message_type:1,message_sub_type:56};ajaxCall(appurl+apiversion+"/chat/"+lhnJsSdk.chatSession+"/message/",n,"POST",null,{});n={message_id:lhnQuery(this).parent().attr("id")};return ajaxCall(appurl+apiversion+"/chat/"+lhnJsSdk.chatSession+"/ack/",n,"POST",null,{}),lhnQuery(this).parent().remove(),!1})),lhnQuery(document).off("click",".lhnChat .hocChatTimeoutAccept").on("click",".lhnChat .hocChatTimeoutAccept",(function(e){return ajaxCall(appurl+apiversion+"/chat/"+lhnJsSdk.chatSession+"/message/",{message:"Chat timeout has been accepted by the visitor.",message_type:1,message_sub_type:145},"POST",null,{}),lhnJsSdk.isOnline=!1,chatSurveyId=0,chatType="timeout",endChat(),updateEmbeddedChat(),!1})),lhnQuery(document).off("click",".lhnChat .hocChatTimeoutDecline").on("click",".lhnChat .hocChatTimeoutDecline",(function(e){return ajaxCall(appurl+apiversion+"/chat/"+lhnJsSdk.chatSession+"/message/",{message:"Chat timeout has been declined by the visitor.",message_type:1,message_sub_type:146},"POST",null,{}),lhnQuery(this).parent().remove(),!1})),lhnQuery(document).off("click","#lhnHelpOutCenter #hocSyschat .form_close").on("click","#lhnHelpOutCenter #hocSyschat .form_close",(function(e){var n=lhnQuery(this).closest(".secure_forms").attr("id");return lhnQuery("#hocSyschat").find('[rel="'+n+'"]').each((function(){if(lhnQuery(this).hasClass("success")){var e={message_id:lhnQuery(this).closest(".lhnWindow-message--container").attr("id")};ajaxCall(appurl+apiversion+"/chat/"+lhnJsSdk.chatSession+"/ack/",e,"POST",null,{})}lhnQuery("#"+n).remove()})),!1})),lhnQuery(".lhnChat").scroll((function(){if(lhnQuery(".lhnChat").scrollTop()<=300&&moreMessages&&!isLoadingMessages){isLoadingMessages=!0;var e={limit:15,ending_message_id:firstMessageId};ajaxCall("conversation"==chatMode?appurl+apiversion+"/chat/visitor/history/":appurl+apiversion+"/chat/"+lhnJsSdk.chatSession+"/history/",e,"GET",moreChatMessagesCallback,{})}})),lhnQuery("#lhnChatMessageBox .message").attr("placeholder",lhnJsSdk.dict.chatBoxPlaceholder),lhnQuery("#"+n.el+" #lhnChatMessageBox label").text(lhnJsSdk.dict.chatBoxPlaceholder),lhnQuery(document).off("click",".lhnChat .hocCallOfferAccept").on("click",".lhnChat .hocCallOfferAccept",(function(e){if(webrtc.isJsLoaded){webrtc.callManager=initCallManager(tabId,lhnJsSdk.lhnsocket),webrtc.callManager.setupCall(lhnStorage.getData("lhnJWT"));var n={message_id:lhnQuery(this).parent().attr("id")};ajaxCall(appurl+apiversion+"/chat/"+lhnJsSdk.chatSession+"/ack/",n,"POST",null,{})}else t=document,a=appurl+"/js/visitor-webrtc.js",(l=t.createElement("script")).setAttribute("type","text/javascript"),l.setAttribute("src",a),l.onload=l.onreadystatechange=function(){if(!this.readyState||"loaded"===this.readyState||"complete"===this.readyState){webrtc.isJsLoaded=!0,webrtc.callManager=initCallManager(tabId,lhnJsSdk.lhnsocket),webrtc.callManager.setupCall(lhnStorage.getData("lhnJWT"));var e={message_id:lhnQuery(".lhnChat .hocCallOfferAccept").parent().attr("id")};ajaxCall(appurl+apiversion+"/chat/"+lhnJsSdk.chatSession+"/ack/",e,"POST",null,{})}},l.onerror=function(){webrtc.isJsLoaded=!1,ajaxCall(appurl+apiversion+"/chat/"+lhnJsSdk.chatSession+"/message/",{message:"Webrtc JS load failed",message_type:1,message_sub_type:184},"POST",null,{})},t.getElementsByTagName("head")[0].appendChild(l);var t,a,l;return lhnQuery(this).parent().remove(),!1})),lhnQuery(document).off("click",".lhnChat .hocCallOfferDecline").on("click",".lhnChat .hocCallOfferDecline",(function(e){var n={message:"Call Offer Declined",message_type:1,message_sub_type:185};ajaxCall(appurl+apiversion+"/chat/"+lhnJsSdk.chatSession+"/message/",n,"POST",null,{});n={message_id:lhnQuery(this).parent().attr("id")};return ajaxCall(appurl+apiversion+"/chat/"+lhnJsSdk.chatSession+"/ack/",n,"POST",null,{}),lhnQuery(this).parent().remove(),!1}))})),void 0!==n.new_message&&chatMsgSent(lhnQuery.trim(n.new_message),n)}}function joinChatSession(){""==lhnQuery("#hocSyschat").html()&&0==lhnQuery(".lhnChat").length?lhnQuery.each(lhnJsSdk.settings.systems,(function(e){"chat"==lhnQuery(this)[0].system&&generateHocContents(lhnQuery(this)[0].system)})):joinChatSessionCallback()}function joinChatSessionCallback(){if(null!=lhnJsSdk.chatSession)if(isSocketReady()){if(isChatChannelReady())return;messageReadInterval=setInterval((function(){markMessagesRead()}),1e3),lhnJsSdk.chatChan=lhnJsSdk.lhnsocket.channel("chat_session:"+lhnJsSdk.chatSession,{token:lhnStorage.getData("lhnJWT"),last_message_id:null,chat_mode:chatMode}),lhnJsSdk.chatChan.on("message:received",(function(e){1==lhnQuery.isNumeric(e.visitor_chat_session.id)&&(opts={status:"delivered"},ajaxCall(appurl+apiversion+"/chat/"+lhnJsSdk.chatSession+"/message_status/",{status:"delivered",message_id:e.visitor_chat_session.id},"POST",null,{})),chatMsgReceived(e),lhnJsSdk.chatChan.params.last_message_id=e.visitor_chat_session.id})),lhnJsSdk.chatChan.on("message:status",(function(e){lhnQuery("#"+e.message_id+" .lhnStatus").text(e.status)})),lhnJsSdk.chatChan.on("typing_status:changed",(function(e){chatTypingStatus(e)})),lhnJsSdk.chatChan.on("bus:status",(function(e){"changed"==e.status.name&&"operator"==e.status.type?(lhnQuery(".lhnOperatorName").text(e.metadata.name),lhnQuery(".lhnOperatorDesc").text(e.metadata.description),lhnQuery(".lhnWindow-header h4").html('<span class="lhnAgentStatus lhnAgentStatus--active"></span>'+e.metadata.name),""!=e.metadata.image&&null!=e.metadata.image?(lhnQuery(".lhnOperatorImage, .lhnWindow-header-avatar--img").addClass("hasImage"),lhnQuery(".lhnOperatorImage, .lhnWindow-header-avatar--img").html('<img src="'+e.metadata.image+'" />')):(lhnQuery(".lhnOperatorImage, .lhnWindow-header-avatar--img").removeClass("hasImage"),lhnQuery(".lhnOperatorImage, .lhnWindow-header-avatar--img").html(""))):"timeout"==e.status.name&&"chat"==e.status.type?chatTimeout(e.message):"closed"==e.status.name&&"chat"==e.status.type&&chatEnded()})),lhnJsSdk.chatChan.join().receive("ok",(function(e){lhnJsSdk.log("Joined Channel","chat_session:"+lhnJsSdk.chatSession),stopInactivityTimer(),operLanguageId=e.operator_language,custLanguageId=e.customer_language,initChatMsgReceived(e,{}),e.messages.length>0&&(moreMessages=e.more_messages,lhnJsSdk.chatChan.params.last_message_id=e.messages[e.messages.length-1].messageId),startSocketTimer()})).receive("error",(function(e){"Invalid Chat Session"==e.response&&(chatSurveyId=null,chatEnded())})).receive("timeout",(function(e){lhnJsSdk.log("chat channel timeout",lhnJsSdk.chatSession)})),lhnJsSdk.chatChan.onClose((function(){lhnJsSdk.log("chat channel closed",lhnJsSdk.chatSession)}))}else setTimeout((function(){connectSocket(null,reconnectChannels)}),500)}function moreChatMessagesCallback(e,n){moreMessages=e.payload.more_messages,historyChatMsgReceived(e.payload,n)}function showInvite(e,n,t,a,l){if(1==lhnJsSdk.isHOC){a=void 0!==a?a:"manual";var o=void 0!==(l=void 0!==l?l:{}).type?l.type:"message";if(("jump_logic"!=preChatType||"message"!=o)&&1!=lhnJsSdk.options.invite_as_chat&&"open_chat_window"!=e||"promo"==a||isMobile()&&"proactive"!=a&&"trigger"!=a)if("jump_logic"!=o||"auto"!=a||isMobile()){if("jump_logic"==o&&"auto"==a&&isMobile())return!1;"slide"==lhnJsSdk.settings.button&&setTimeout((function(){lhnQuery("#lhnHocButton").addClass("lhndown"),setTimeout((function(){lhnQuery("#lhnHocButton").hide()}),1500)}),Math.max(1e3*n-1500,0)),setTimeout((function(){!function(n,t,l){var o='<div class="lhnHocInviteCont">';o+='<div id="lhnOpMsg" class="lhnMsg">'+e+"</div>",o+='<div class="lhnHocInviteButtons">',o+='<div class="lhnHocInviteButton lhncancel" tabindex="0" role="button">'+lhnJsSdk.dict.inviteCancel+"</div>","promo"!=a&&(o+='<div class="lhnHocInviteButton lhnstart" tabindex="0" role="button">'+lhnJsSdk.dict.inviteStart+"</div>"),o+='<div class="lhnHocButtonClear"></div>',o+="</div>",o+="</div>";var s=n.getElementsByTagName("body");(s=n.createElement("div")).id="lhnHocInvite",s.className="lhn"+lhnJsSdk.settings.styles.button_position+" lhn_"+a,s.innerHTML=o,s.style.display="none",n.body.appendChild(s)}(document),void 0!==l&&lhnQuery("#lhnHocInvite").attr("rel",l),t&&playSound(),lhnQuery("#lhnHocInvite").show(),lhnQuery("#lhnHocInvite .lhnMsg").focus(),doGaTrack("LiveChat","Invite-Shown",!0),ajaxCall(appurl+apiversion+"/visitor/invite",{},"DELETE",null,{})}),1e3*n)}else openHOC("c"),doGaTrack("LiveChat","Invite-Shown",!0),ajaxCall(appurl+apiversion+"/visitor/invite",{},"DELETE",null,{});else 1!=started_jump_logic&&setTimeout((function(){openHOC("c",{invite:e,invite_type:a,invite_id:l}),doGaTrack("LiveChat","Invite-Shown",!0),ajaxCall(appurl+apiversion+"/visitor/invite",{},"DELETE",null,{})}),1e3*n)}"function"==typeof window.lhnJsSdkInviteReceived&&"chat"!=a&&window.lhnJsSdkInviteReceived(e,n,a)}function hideInvite(){lhnQuery("#lhnHocInvite").addClass("lhncancel"),setTimeout((function(){lhnQuery("#lhnHocInvite").hide(),lhnQuery("#lhnHocInvite").remove()}),1500),"slide"==lhnJsSdk.settings.button&&setTimeout((function(){lhnQuery("#lhnHocButton").show(),lhnQuery("#lhnHocButton").removeClass("lhndown")}),1500)}function displayEmailForm(){if(0==lhnQuery(".conversationForm.hocEmail").length){var e='<div class="conversationForm hocEmail lhnWindow-message--container">';e+='<label for="lhnHocEmailTo">'+lhnJsSdk.dict.emailTranscript+"</label>:<br />",e+='<input type="text" id="lhnHocEmailTo" class="lhnHocEmailTo" />',e+='<button class="hocEmailChat" style="display:none;">'+lhnJsSdk.dict.send+"</button>",e+="</div>",lhnQuery(".lhnChat").append(e),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight)}}function emailChat(e,n){var t={email_address:e};ajaxCall(appurl+apiversion+"/chat/"+lhnJsSdk.chatSession+"/email_transcript/",t,"POST",emailChatCallback,{el:n,email:e})}function emailChatCallback(e,n){lhnJsSdk.log("Email","Send successfully"),lhnQuery(n.el).html(lhnJsSdk.dict.emailSuccess+" "+n.email),lhnQuery(n.el).removeClass("hocEmail")}function displayFileUpload(e){lhnQuery(".lhnChat").find(".hocActionFileUpload").length>0&&lhnQuery(".lhnChat").find(".hocActionFileUpload").remove();var n='<div id="'+e+'" class="conversationForm hocActionFileUpload lhnWindow-message--container">';n+='<div id="dropContainer" class="dropContainer">',n+='<div class="dropLocation">',n+='<p id="attachmentErrorMsg"></p>',n+='<span class="uploadNote">Click here or drop a file to add up to 5 attachments. Use buttons below to submit or delete all attachments.</span>',n+="</div>",n+="</div>",n+='<input id="fileUpload" type="file" name="file-upload"></input>',n+='<button id="submitAttachments">&#10003;</button>',n+='<button id="removeAttachments">X</button>',n+="</div>",lhnQuery(".lhnChat").append(n),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight)}var LhnUpload=function(e){this.file=e};function fileUpload(e){if(e.stopPropagation(),e.preventDefault(),lhnAttachmentCount>=5)lhnQuery("#attachmentErrorMsg").show().text("Attachments are limited to 5").delay(5e3).queue((function(e){lhnQuery("#attachmentErrorMsg").hide().text(""),e()}));else if("drop"==e.type||"change"==e.type){var n="change"==e.type?new LhnUpload(e.target.files[0]):new LhnUpload(e.dataTransfer.files[0]),t=new FileReader,a=n.file.name;t.readAsDataURL(n.file),t.onload=function(e){lhnAttachmentCount++;var n=a+";"+e.total+";"+e.target.result;0==lhnAttachmentCount?lhnQuery(".uploadNote").show():lhnQuery(".uploadNote").hide(),filename_formatted=a.length>28?a.slice(0,28)+"...":a,attachmentHtml='<div class="attachmentContainer"><p class="removeAttachment">X</p><div class="attachmentIcon"><p class="fileName">'+filename_formatted+'</p></div><input class="attachmentData" type="hidden" value="'+n+'"></div>',lhnQuery(".dropLocation").append(attachmentHtml)}}}function displayPhoneField(e,n){ajaxCall(appurl+apiversion+"/ui/element/",{system:"shared",partial:"phone_field"},"GET",displayPhoneFieldCallback,{id:e,msg:n})}function displayPhoneFieldCallback(e,n){var t='<div id="'+n.id+'" class="conversationForm hocPhoneField lhnWindow-message--container">';t+=e.payload,t+="</div>",lhnQuery(".lhnChat").append(t),lhnQuery("#"+n.id+" input.lhnInput").keypress((function(e){13==e.which&&(client_sms=n.msg.split(" - ")[1],lhnQuery(this).blur(),lhnQuery(this).hide(),setTimeout((function(){visitor_sms=lhnQuery("#"+n.id+" #fld_0_0_0").val(),data={visitor_sms:visitor_sms,client_sms:client_sms,from_name:custName},ajaxCall(appurl+apiversion+"/chat/"+lhnJsSdk.chatSession+"/submit_phone/",data,"POST",null,{})}),250))})),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight)}function uploadFile(e,n){var t=e.split(";"),a={name:t[0],length:t[1],data:t[2]+";"+t[3],from_name:custName};ajaxCall(appurl+apiversion+"/chat/"+lhnJsSdk.chatSession+"/upload_file/",a,"POST",uploadFileCallback,{el:n})}function uploadFileCallback(e,n){lhnJsSdk.log("File","Upload successful"),lhnQuery(n.el).html(lhnJsSdk.dict.uploadFileSuccess),chatMsgSentCallback(e,n)}function displayRemoteAssistance(e,n){var t='<div id="'+e+'" class="conversationForm hocRemoteAssist lhnWindow-message--container" rel="'+n+'">';t+=lhnJsSdk.dict.remoteAssistance+":<br />",t+='<button class="hocRemoteAssistAccept">Accepts</button>',t+='<button class="hocRemoteAssistDecline">Decline</button>',t+="</div>",lhnQuery(".lhnChat").append(t),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight)}function loadSecureForms(e,n,t){t=void 0===t?{}:t,"undefined"!=typeof LHN_Forms||formsWorking?loadSecureForm(e,n):(formsWorking=!0,function(a,l,o,s){var i=a.getElementsByTagName("head")[0],r=a.createElement("script");r.src=s;var h=!1;r.onload=r.onreadystatechange=function(){h||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(h=!0,r.onload=r.onreadystatechange=null,function(a,l,o,s){var i=a.getElementsByTagName("head")[0],r=a.createElement("script");r.src=s;var h=!1;r.onload=r.onreadystatechange=function(){h||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(h=!0,r.onload=r.onreadystatechange=null,top.LHN_Forms=LHN_Forms,LHN_Forms.secureForms.properties.windowType="HOC",LHN_Forms.secureForms.properties.systemId=t.systemId||1,LHN_Forms.secureForms.properties.prechat=t.prechat||!1,LHN_Forms.secureForms.properties.contextId=JSON.parse(decodeBase64(lhnStorage.getData("lhnJWT").split(".")[1])).resource.id,LHN_Forms.secureForms.properties.departmentId=lhnJsSdk.options.dept,LHN_Forms.secureForms.properties.visitorName=custName,LHN_Forms.properties.clientId=lhnJsSdk.setup.account,LHN_Forms.properties.jwtToken=lhnStorage.getData("lhnJWT"),LHN_Forms.secureForms.loadForm(LHN_Forms.properties.clientId,{},1,(function(){loadSecureForm(e,n),formsWorking=!1})))},i.appendChild(r)}(document,0,0,appurl+"/js/forms.js"))},i.appendChild(r)}(document,0,0,appurl+"/js/lhn-common.js"))}function loadSecureForm(e,n){if(formsWorking)setTimeout((function(){loadSecureForm(e,n)}),500);else{var t='<div class="hocSecureForm">';t+=LHN_Forms.secureForms.findAndConvertCommands(n,1),t+="</div>",lhnQuery("#"+e).append(t),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight)}}function checkMsgForTenor(e){return e.indexOf("s://media.tenor.co/images/")>-1&&(e=e.replace(/(^|[^"'])(https?:\/\/\S*(png|jpg|jpeg|gif|raw))([\s<]|$)/gi,'$1<div class=lhngif><img src="$2" /><div class=lhncredit>via Tenor</div></div>$4')),e}function checkMsgForVideoLinks(e){if(e.indexOf("youtube.com/watch")>-1||e.indexOf("youtube.com/v/")>-1||e.indexOf("youtu.be/")>-1||e.indexOf("vimeo.com/")>-1)var n=/(http:|https:|)\/\/(player.|www.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com))\/(groups\/(.*?)\/videos\/|channels\/(.*?)\/|video\/|embed\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(\&\S+)?/gi;return e=e.replace(n,(function(e,n,t,a,l,o,s,i,r){return a.indexOf("youtu")>-1&&"user"!=r&&"oembed"!=r&&"attribution_link"!=r&&"playlist"!=r?'<iframe width="200" height="113" src="https://www.youtube.com/embed/'+r+'?rel=0&amp;showinfo=0" frameborder="0" allowfullscreen></iframe>':a.indexOf("vimeo.com")>-1?'<iframe src="https://player.vimeo.com/video/'+r+'?title=0&byline=0&portrait=0" width="200" height="120" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>':e}))}function checkMsgForLinks(e){return e.replace(/[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}/g,(function(e){return'<a href="mailto:'+e+'">'+e+"</a>"}))}function endChat(){lhnJsSdk.chatSession||"jump_logic"!=preChatType?ajaxCall(appurl+apiversion+"/chat/"+lhnJsSdk.chatSession+"/terminate/",{},"POST",chatEnded,{}):(ajaxCall(appurl+apiversion+"/chat/jumplogic/terminate/",{},"POST",jumplogic_chatended,{}),lhnJsSdk.vChan.push("jump_logic:ended",{},1e4))}function chatEnded(){(stopSocketTimer(),startInactivityTimer(),clearInterval(messageReadInterval),null!=chatSurveyId&&0!=chatSurveyId)?(lhnQuery(".lhnHocOverlay").show(),lhnQuery(".lhnloading").show(),embedSurvey(lhnQuery(".lhnChat").parent().attr("id"),chatSurveyId,lhnJsSdk.chatSession)):("function"==typeof window.lhnJsSdkChatEnded&&window.lhnJsSdkChatEnded(lhnJsSdk.chatSession),"chat"==chatType&&(closeHOC(),chatType="prechat",lhnQuery("#hocSyschat").html(""),firstOpen.chat=!0,launchedChat=!1));"undefined"!=typeof lhn_billboard_rotate&&clearInterval(lhn_billboard_rotate),lhnQuery("#hocSyschat").removeClass("hasBillboard"),lhnJsSdk.chatChan.leave().receive("ok",(function(){lhnJsSdk.chatSession=null,lhnStorage.removeData("lhnChatSession"),lhnJsSdk.chatChan=null,custName=null})),1==lhnJsSdk.isHOC&&void 0!==lhnJsSdk.settings.systems[hoc_chat_order]&&(lhnJsSdk.settings.systems[hoc_chat_order].active_chat_session_id=null),lhnStorage.removeData("lhnShowedSMS"),lhnQuery(".lhnPromptAccept.closechat").prop("disabled",!1)}function chatTimeout(e){html='<div class="conversationForm hocChatTimeout lhnWindow-message--container">',html+=e+"<br />",html+='<button class="hocChatTimeoutAccept">Accepts</button>',html+='<button class="hocChatTimeoutDecline">Decline</button>',html+="</div>",lhnQuery(".lhnChat").append(html),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight),"function"==typeof window.lhnJsSdkChatTimeout&&window.lhnJsSdkChatTimeout(e)}function initChatMsgReceived(e,n){if(void 0!==e.messages){if(void 0!==e.chat_fields&&null!=e.chat_fields&&lhnQuery(".lhnOperatorMessage.jumplogic").length<1&&"prepend"!=n.type)for(var t=0;t<e.chat_fields.length;t++){var a=parseInt(e.chat_fields[t].field_info.split("_")[1]);lhnQuery(".lhnChat").append('<div class="lhnOperatorMessage lhnWindow-message--container"><span></span><div class="lhnWindow-message">'+jumpLogicTokenReplace(e.chat_fields[t].question)+'</div><span class="lhnTime"></span></div>'),lhnQuery(".lhnChat").append("<div id='"+e.chat_fields[t].field_info+"' class=\"lhnCustomerMessage lhnWindow-message--container\" attr='"+a+'\'><span></span><div class="lhnWindow-message">'+e.chat_fields[t].answer+'</div><span class="lhnTime"></span></div>'),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight)}for(var l=0;l<e.messages.length;l++){var o=e.messages[l];if(0==l&&(firstMessageId=o.messageId),lhnQuery(".lhnChatMessageContainer #"+o.messageId).length<1){switch(o.messageType){case 1:className="lhnSystemMessage lhnWindow-message--container",fromName="";break;case 3:if(5===o.messageSubType)className="lhnSystemMessage lhnWindow-message--container",fromName="";else className=0==o.operatorId?"lhnCustomerMessage lhnWindow-message--container":"lhnOperatorMessage lhnWindow-message--container",fromName=o.fromName}var s=convertTime(o.createdTime);n.status=o.messageStatus,chat_message=o.chatMessage,"conversation"==chatMode&&2==o.messageSubType&&(chat_message=chat_message.replace("/session_ended","")),insertMessage(o.messageId,className,fromName,chat_message,s,n)}}setTimeout((function(){lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight)}),800)}isLoadingMessages=!1}function historyChatMsgReceived(e,n){if(void 0!==e.messages){if(e.messages=e.messages.reverse(),initChatMsgReceived(e,{type:"prepend"}),void 0!==e.chat_fields&&null!=e.chat_fields&&lhnQuery(".lhnOperatorMessage.jumplogic").length<1)for(var t=0;t<e.chat_fields.length;t++){var a=parseInt(e.chat_fields[t].field_info.split("_")[1]);lhnQuery(".lhnChat").prepend("<div id='"+e.chat_fields[t].field_info+"' class=\"lhnCustomerMessage lhnWindow-message--container\" attr='"+a+'\'><span></span><div class="lhnWindow-message">'+e.chat_fields[t].answer+'</div><span class="lhnTime"></span></div>'),lhnQuery(".lhnChat").prepend('<div class="lhnOperatorMessage lhnWindow-message--container"><span></span><div class="lhnWindow-message">'+jumpLogicTokenReplace(e.chat_fields[t].question)+'</div><span class="lhnTime"></span></div>')}"proactive_invite"==n.motive&&"conversation"==chatMode&&conversationStartChat(n)}}function checkFocus(){return document.hasFocus()}function markMessagesRead(){1==checkFocus()&&"visible"==lhnQuery("#lhnHelpOutCenter").css("visibility")&&lhnQuery(".lhnOperatorMessage[status!=read], .lhnSystemMessage[status!=read]").each((function(){1==lhnQuery.isNumeric(lhnQuery(this).attr("id"))&&(lhnJsSdk.chatChan.push("message:status",{message_id:lhnQuery(this).attr("id"),status:"read"},lhnJsSdk.chatSession),lhnQuery(".lhnChat #"+lhnQuery(this).attr("id")).attr("status","read"))}))}function chatMsgReceived(e){if(void 0!==e.visitor_chat_session&&lhnQuery(".lhnChat #"+e.visitor_chat_session.id).length<1){if(191==e.visitor_chat_session.message_sub_type||188==e.visitor_chat_session.message_sub_type)return;var n="lhnOperatorMessage lhnWindow-message--container",t="operator";1==e.visitor_chat_session.message_type||3==e.visitor_chat_session.message_type&&5==e.visitor_chat_session.message_sub_type?(n="lhnSystemMessage lhnWindow-message--container",t="system"):0==e.visitor_chat_session.operator_id&&(n="lhnCustomerMessage lhnWindow-message--container",t="customer");var a=convertTime(e.visitor_chat_session.created_time);insertMessage(e.visitor_chat_session.id,n,e.visitor_chat_session.from_name,e.visitor_chat_session.chat_message,a),"function"==typeof window.lhnJsSdkChatNewMessage&&window.lhnJsSdkChatNewMessage(e.visitor_chat_session.id,e.visitor_chat_session.chat_message,t),1==lhnJsSdk.isHOC&&(parseInt(lhnQuery("#lhnHelpOutCenter").css(lhnJsSdk.settings.styles.position))<0||!lhnQuery("#hocSyschat").hasClass("hocactive")||"hidden"==lhnQuery("#lhnHelpOutCenter").css("visibility"))&&openHOC("c"),playSound(),lhnQuery(".lhnQueueInfo").fadeOut("slow"),lhnQuery(".lhnQueueInfo").text(""),lhnQuery(".lhnOperatorInfo .lhnOperatorStatus").removeClass("queued"),lhnQuery(".lhnAgentStatus").addClass("lhnAgentStatus--active"),lhnQuery(".lhnSendButton").prop("disabled",!1),lhnQuery("#lhnChatMessage").prop("disabled",!1)}}function insertMessage(id,className,fromName,msg,timestamp,opts){lhnQuery(".lhnChat").attr("aria-busy","true"),opts=void 0!==opts?opts:{},""==lhnQuery("#hocSyschat").html()&&embedChat();var d=new Date(timestamp),t=d.getHours()+":"+("0"+d.getMinutes()).slice(-2);if(msg=lhnQuery.trim(msg),msg=checkMsgForTenor(msg),msg=checkMsgForVideoLinks(msg),msg=checkMsgForLinks(msg),0==msg.indexOf('{"/set_language')){msg=msg.replace(/\//i,"");var json=eval("("+msg+")");operLanguageId=json.set_language[0].oper,custLanguageId=json.set_language[1].cust}else if("/file_request"==msg)displayFileUpload(id);else if(msg.indexOf("/desktop_sharing")>-1)msg.indexOf("joinme")>-1?displayRemoteAssistance(id,"joinme"):msg.indexOf("zoom")>-1&&displayRemoteAssistance(id,"zoom");else if(0==msg.indexOf('{"/send_secure_form')){var html="<div id='"+id+"' class='lhnWindow-message--container'></div>";null!=opts.type&&"prepend"==opts.type?lhnQuery(".lhnChat").prepend(html):(lhnQuery(".lhnChat").append(html),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight)),loadSecureForms(id,msg)}else-1!==msg.indexOf("/session_ended")?chatEnded():msg.indexOf("/offer_sms")>-1?displayPhoneField(id,msg):"/call_offer"==msg?displayCallOffer(id):lhnQuery(".lhnChat #"+id).length<1&&(msg=convertUrlsAndImages(msg),html="<div id='"+id+"' class='"+className+"' status='"+(opts.status||"")+"'><span>"+fromName+'</span><div class="lhnWindow-message">'+msg+'</div><span class="lhnTime">'+t+'</span><span class="lhnStatus"></span></div>',null!=opts.type&&"prepend"==opts.type?lhnQuery(".lhnChat").prepend(html):(lhnQuery(".lhnChat").append(html),setTimeout((function(){lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight),lhnQuery(".lhnChat").attr("aria-busy","false")}),800)))}function displayCallOffer(e){var n='<div id="'+e+'" class="conversationForm hocCallOffer lhnWindow-message--container" rel="call">';n+=lhnJsSdk.dict.callAssistance+":<br />",n+='<button class="hocCallOfferAccept">Accepts</button>',n+='<button class="hocCallOfferDecline">Decline</button>',n+="</div>",lhnQuery(".lhnChat").append(n),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight)}function proactiveMsgReceived(e){if(void 0!==e.visitor_chat_session){showInvite(e.visitor_chat_session.chat_message,1,!0,"proactive",e.visitor_chat_session.id);var n={message:"Proactive invitation shown",message_type:1,message_sub_type:135};chatSessionId=null==lhnJsSdk.chatSession?0:lhnJsSdk.chatSession,ajaxCall(appurl+apiversion+"/chat/"+chatSessionId+"/message/",n,"POST",null,{});n={invite_type:"proactive",department_id:lhnJsSdk.options.dept,operator_id:e.operator.id};ajaxCall(appurl+apiversion+"/analytics/chat/invite_tracking",n,"POST",null,{})}}function triggerMsgReceived(e){if(void 0!==e.visitor_chat_session&&void 0!==e.trigger&&void 0!==e.trigger.delay){showInvite(e.visitor_chat_session.chat_message,e.trigger.delay,!0,"trigger",e.trigger.id),lhnJsSdk.trigger_timeout=setTimeout((function(){hideInvite();chatSessionId=null==lhnJsSdk.chatSession?0:lhnJsSdk.chatSession,ajaxCall(appurl+apiversion+"/chat/"+chatSessionId+"/message/",{message:"Trigger invitation dismissed",message_type:1,message_sub_type:138},"POST",null,{})}),3e4+1e3*e.trigger.delay);var n={message:"Trigger invitation shown",message_type:1,message_sub_type:139};chatSessionId=null==lhnJsSdk.chatSession?0:lhnJsSdk.chatSession,ajaxCall(appurl+apiversion+"/chat/"+chatSessionId+"/message/",n,"POST",null,{}),ajaxCall(appurl+apiversion+"/analytics/chat/invite_tracking",n={invite_type:"trigger"},"POST",null,{})}}function triggerPromoReceived(e){if(void 0!==e.visitor_chat_session&&void 0!==e.trigger&&void 0!==e.trigger.delay)if("function"==typeof lhnPromo)lhnPromo(e.visitor_chat_session.chat_message);else{showInvite(e.visitor_chat_session.chat_message,e.trigger.delay,!0,"promo",e.trigger.id);chatSessionId=null==lhnJsSdk.chatSession?0:lhnJsSdk.chatSession,ajaxCall(appurl+apiversion+"/chat/"+chatSessionId+"/message/",{message:"Trigger promo shown",message_type:1,message_sub_type:156},"POST",null,{})}}function updateQueueStatus(e){lhnQuery(".lhnQueueInfo").text(e.visitor_chat_session.chat_message),lhnQuery(".lhnQueueInfo").fadeIn("slow"),lhnQuery(".lhnOperatorInfo .lhnOperatorStatus").addClass("queued"),lhnQuery(".lhnAgentStatus").removeClass("lhnAgentStatus--active")}function chatMsgSent(e,n){lhnQuery("#lhnChatMessageBox > textarea").val(""),lhnQuery(".lhnSendButton").removeClass("lhnShow"),lhnQuery("#hocSyschat").removeClass("lhnTextboxActive");var t={message:e=html2text(e)};void 0!==n.message_type&&(t.message_type=n.message_type),void 0!==n.message_sub_type&&(t.message_sub_type=n.message_sub_type),void 0!==n.from_name&&(t.from_name=n.from_name),chatSessionId=null==lhnJsSdk.chatSession?0:lhnJsSdk.chatSession,isSocketReady()||lhnSendError(JSON.parse(decodeBase64(lhnStorage.getData("lhnJWT").split(".")[1])).jti+" 15.1 - socket disconnected on chat msg sent",navigator.userAgent),isChatChannelReady()||(lhnSendError(JSON.parse(decodeBase64(lhnStorage.getData("lhnJWT").split(".")[1])).jti+" 15.1 - chat channel not ready on chat msg sent",navigator.userAgent),joinChatSessionCallback()),""!=operLanguageId&&""!=custLanguageId&&operLanguageId!=custLanguageId?(t.message_sub_type=76,t.cust_lang=custLanguageId,t.oper_lang=operLanguageId,ajaxCall(appurl+apiversion+"/chat/"+chatSessionId+"/message/",t,"POST",chatMsgSentCallback,{})):ajaxCall(appurl+apiversion+"/chat/"+chatSessionId+"/message/",t,"POST",chatMsgSentCallback,{})}function chatMsgSentCallback(e,n){if(_typeof(e.payload.messageId)&&lhnQuery(".lhnChat #"+e.payload.messageId).length<1&&lhnQuery(".lhnChat").length>0){var t=convertTime(e.payload.createdTime),a=new Date(t),l=a.getHours()+":"+("0"+a.getMinutes()).slice(-2),o="lhnCustomerMessage lhnWindow-message--container";""==e.payload.fromName&&(o="lhnSystemMessage lhnWindow-message--container");var s=checkMsgForVideoLinks(e.payload.chatMessage);s=convertUrlsAndImages(s),lhnQuery(".lhnChat").append("<div id='"+e.payload.messageId+"' class='"+o+"'><span>"+e.payload.fromName+'</span><div class="lhnWindow-message">'+s+'</div><span class="lhnTime">'+l+"</span></div>"),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight),"function"==typeof window.lhnJsSdkChatNewMessage&&window.lhnJsSdkChatNewMessage(e.payload.messageId,s,"customer")}}function chatTypingStatus(e){void 0!==e.operator_typing&&((isOperatorTyping=1==e.operator_typing||"true"==e.operator_typing)&&!lhnQuery("#lhnOperatorTyping").is(":visible")?(lhnQuery("#lhnHocButton #lhnOpType").show(),lhnQuery(".lhnChat").append("<div id='lhnOperatorTyping' class='lhnOperatorMessage lhnWindow-message--container'><span></span><div class='lhnWindow-message'><div class='lhnTypingDot'></div><div class='lhnTypingDot'></div><div class='lhnTypingDot'></div><div style='text-indent:-9999999px;position:absolute;'>Operator is typing</div></div></div>"),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight)):isOperatorTyping||(lhnQuery("#lhnHocButton #lhnOpType").hide(),lhnQuery(".lhnChat #lhnOperatorTyping").remove(),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight)))}function playSound(){""!=lhnJsSdk.options.sound&&function(e,n,t){var a=e.createElement("audio");a.setAttribute("controls",""),a.setAttribute("autoplay",""),a.id="lhnHocBellSound",a.style.position="absolute",a.style.left="-300px",a.style.top="-300px",a.style.width="0",a.style.height="0",a.visible="false";var l=document.createElement("source");l.src=lhnJsSdk.options.sound+"?rnd="+Math.floor(1e3*Math.random()),l.type="audio/wav",a.appendChild(l),e.body.appendChild(a)}(document),setTimeout((function(){lhnQuery("#lhnHocBellSound").remove()}),5e3)}function embedSurvey(e,n,t){ajaxCall(appurl+apiversion+"/ui/form/",{system:"survey",layout:"hoc",partial:"form",view_id:n},"GET",embedSurveyCallback,{el:e,id:t})}function embedSurveyCallback(e,n){void 0!==e.payload&&(chatType="survey",updateHeaderFooter("chat"),lhnQuery("#"+n.el).html(""),lhnQuery(e.payload).appendTo("#"+n.el),lhnQuery(document).ready((function(){lhnQuery(document).on("click",".lhnRadioGroup span",(function(){lhnQuery(this).hasClass("selected")||(lhnQuery(this).closest(".lhnRadioGroup").find("span").removeClass("lhnSelected"),lhnQuery(this).addClass("lhnSelected"),lhnQuery(this).closest(".lhnRadioGroup").find("input").prop("checked",!1),lhnQuery(this).parent().find("input").prop("checked",!0))})),lhnQuery(document).off("click",".lhnSubmit.hocSurvey").on("click",".lhnSubmit.hocSurvey",(function(){return validateSurveyForm(n.el,n.win,n.id),!1})),lhnQuery(".lhnFormButton.hocSurvey").html(lhnJsSdk.dict.submit)})),lhnQuery(".lhnHocOverlay").hide(),lhnQuery(".lhnloading").hide(),doGaTrack("Survey","Form-Opened",!1),firstOpen.chat=!0,"function"==typeof window.lhnJsSdkSurveyShown&&window.lhnJsSdkSurveyShown())}function validateSurveyForm(e,n,t){lhnQuery(document).off("click",".lhnSubmit.hocSurvey"),lhnQuery(".lhnHocOverlay").show(),lhnQuery(".lhnloading").show();var a=!0;if(lhnQuery(".lhnField.lhnrating").each((function(){1!=lhnQuery("input[name='"+lhnQuery(this).find("input[type='radio']").first().attr("name")+"']").is(":checked")&&(a=!1)})),a){var l=lhnQuery(".lhnSurveyForm form").serializeObject(n);l.survey_id=chatSurveyId,l.link_id=t,ajaxCall(appurl+apiversion+"/survey/",l,"PUT",validateSurveyFormCallback,{el:e,chat_session:t})}else lhnQuery(document).on("click",".lhnSubmit.hocSurvey",(function(){return validateSurveyForm(opts.el,opts.win,opts.id),!1})),alert("Please answer all questions"),lhnQuery(".lhnHocOverlay").hide(),lhnQuery(".lhnloading").hide()}function validateSurveyFormCallback(e,n){void 0!==e.message&&("function"==typeof window.lhnJsSdkSurveySubmitted&&(survey_data=[],lhnQuery.each(lhnQuery(".lhnSurveyForm form").serializeArray(),(function(){lhnQuery(this)[0].name.indexOf("fld")>=0&&(o={},o[lhnQuery.trim(lhnQuery("label[for='"+lhnQuery(this)[0].name+"']").text().replace("*",""))]=lhnQuery(this)[0].value,survey_data.push(o))})),window.lhnJsSdkSurveySubmitted(survey_data)),lhnQuery("#"+n.el+" .lhnSurveyForm").remove(),lhnQuery("<div class='lhnmsgbox lhnSurveySuccess'>"+lb2br(e.message)+"</div>").appendTo("#"+n.el),chatType="prechat",firstOpen.chat=!0,launchedChat=!1,doGaTrack("Survey","Form-Submitted",!1)),lhnJsSdk.vChan.push("survey:submitted",{},1e4),"function"==typeof window.lhnJsSdkChatEnded&&window.lhnJsSdkChatEnded(n.chat_session),lhnQuery(".lhnHocOverlay").hide(),lhnQuery(".lhnloading").hide()}function embedKbLookup(e,n){lhnQuery(".lhnHocOverlay").show(),lhnQuery(".lhnloading").show(),ajaxCall(appurl+apiversion+"/ui/form/",{system:"kb",layout:"hoc",partial:"search",view_id:n},"GET",embedKbLookupCallback,{el:e})}function embedKbLookupCallback(e,n){if(void 0!==e.payload){lhnQuery(e.payload).appendTo("#"+n.el),lhnQuery("#txtKeyword").attr("placeholder",lhnJsSdk.dict.knowledgeSearch);var t=1==lhnJsSdk.isHOC?lhnJsSdk.settings.styles.position:"right";if(lhnJsSdk.options.embedArticle){l=document,o=appurl+"/css/modern/external.css",s=l.getElementsByTagName("head")[0],(i=l.createElement("link")).type="text/css",i.rel="stylesheet",i.href=o,s.appendChild(i),lhnJsSdk.options.embedArticleDirection=void 0===lhnJsSdk.options.embedArticleDirection?t:lhnJsSdk.options.embedArticleDirection;var a=document.createElement("div");a.className="lhnExternal standalone "+lhnJsSdk.options.embedArticleDirection,a.style.display="none",a.innerHTML='<a href="#" class="lhnHocExternalClose">close</a><div class="lhnExternalContainer"></div>',document.body.appendChild(a),lhnQuery(document).ready((function(){lhnQuery(document).on("click",".lhnHocExternalClose",(function(){return externalPageClose(),!1})),lhnQuery(document).on("click","#searchResultsContainer .lhn_result a",(function(e){e.preventDefault(),embedKbArticle(lhnQuery(this).attr("rel"),"lhnExternal")})),lhnQuery(".lhnExternal.standalone").show()}))}wireKbLookup({searchBox:lhnQuery("#txtKeyword"),resultsContainerNode:lhnQuery("#searchResultsContainer"),categories:lhnJsSdk.options.kb_categories||null}),firstOpen.knowledge=!1}var l,o,s,i;lhnQuery(".lhnHocOverlay").hide(),lhnQuery(".lhnloading").hide()}function wireKbLookup(e){var n,t,a;n=document,t=appurl+"/js/kb/jquery-jqote2.js",(a=n.createElement("script")).setAttribute("type","text/javascript"),a.setAttribute("src",t),n.getElementsByTagName("head")[0].appendChild(a),function(e,n,t,a){var l=e.createElement("script");l.setAttribute("type","text/javascript"),l.setAttribute("src",a),e.getElementsByTagName("head")[0].appendChild(l)}(document,0,0,appurl+"/js/kb/lhn-localization-1.0.0.js"),function(n,t,a,l){var o=n.createElement("script");o.setAttribute("type","text/javascript"),o.setAttribute("src",l);var s=!1;o.onload=o.onreadystatechange=function(){if(!(s||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState)){s=!0;var n={clientID:lhnJsSdk.setup.account,url:appurl+apiversion+"/kb/article/search/",JWT:lhnStorage.getData("lhnJWT")};void 0!==e&&lhnQuery.extend(n,e),typeahead=new lhnQuery.typeahead(n),void 0!==lhnJsSdk.search_term?(typeahead.searchBox.val(lhnJsSdk.search_term),typeahead.searchBox.keyup()):lhnJsSdk.isHOC&&(typeahead.searchBox.focus(),getKbTopArticles())}},n.getElementsByTagName("head")[0].appendChild(o)}(document,0,0,appurl+"/js/kb/lhn-typeahead-1.0.0.js")}function getKbTopArticles(){var e={category_ids:lhnJsSdk.options.kb_categories||null};ajaxCall(appurl+apiversion+"/kb/articles/top/",e,"GET",getKbTopArticleCallback,{})}function getKbTopArticleCallback(e){if(void 0!==e.payload)for(var n=e.payload.entries,t=0;t<n.length;t++){for(var a=n[t],l=a.vote_total/a.vote_count,o="",s=0;s<5;s++)o+=l-s>=1?'<img src="//www.livehelpnow.net/lhn/images/global/rating14.gif"/>':l-s>0?'<img src="//www.livehelpnow.net/lhn/images/global/rating14_half.gif"/>':'<img src="//www.livehelpnow.net/lhn/images/global/rating14_empty.gif"/>';var i=e.payload.links[t].html.show;lhnQuery('<div class="lhn_result"><div class="lhn_content"><div class="lhn_content_header"><a target="_blank" rel="'+a.article_id+'" href="'+i+'">'+stripToSize(a.question,200)+(a.question.lnegth>200?"...":"")+'</a></div><div class="lhn_content_body">'+stripToSize(a.answer,200)+(a.answer.length>200?"...":"")+'</div><div class="lhn_content_footer"><div class="lhn_views">'+a.view_count+' views</div><div class="lhn_ratings">'+o+"</div></div></div></div>").appendTo("#searchResultsContainer .results")}}function embedKbArticle(e,n){var t=!1;null!=lhnStorage.getData("Heart-"+e)&&(t=!0),ajaxCall(appurl+apiversion+"/ui/kb/article/"+e,{system:"kb",layout:"jssdk",partial:"show",args:{},article_rated:t},"GET",embedKbArticleCallback,{el:n})}function embedKbArticleCallback(e,n){var t="";void 0!==e.payload&&(t=e.payload),"lhnExternal"==n.el?externalPage(t):lhnQuery("#"+n.el).html(t)}function articleRatingCallback(e){"ok"==e.status&&(lhnQuery("#heart-rating-label").text(e.msg),lhnStorage.setData("Heart-"+e.article_id,e.rating),setTimeout((function(){lhnQuery(".hearts").hide(),e.rating<5&&(lhnJsSdk.showInvite("Sorry the article didn't have the answer you needed<br />If you'd like, you can ask the team for help here.",1,!0),externalPageClose())}),6e3))}function embedTicket(e,n){lhnQuery(".lhnHocOverlay").show(),lhnQuery(".lhnloading").show(),ajaxCall(appurl+apiversion+"/ui/form/",{system:"ticket",layout:"hoc",partial:"form",view_id:n},"GET",embedTicketCallback,{el:e,win:n})}function embedTicketCallback(e,n){var t,a,l;void 0!==e.payload&&(lhnQuery("#"+n.el).html(""),t=document,a=baseurl+"Scripts/jquery.scrollTo.js",(l=t.createElement("script")).setAttribute("type","text/javascript"),l.setAttribute("src",a),t.getElementsByTagName("head")[0].appendChild(l),lhnQuery(e.payload).appendTo("#"+n.el),lhnQuery(document).ready((function(){lhnQuery("input[type='file']").change((function(e){var n=lhnQuery(this).attr("id"),t=lhnQuery(this).val().substring(lhnQuery(this).val().lastIndexOf("\\")+1),a=new FileReader;a.onload=function(e){fileData=t+";"+e.total+";"+e.target.result;var a=fileData.split(";"),l={name:a[0],length:a[1],data:a[2]+";"+a[3],from_name:custName};ajaxCall(appurl+apiversion+"/attachment/ticket/",l,"PUT",formFileUploadCallback,{field_id:n})},a.readAsDataURL(e.target.files[0])})),lhnQuery(document).off("click",".lhnSubmit.hocTicket").on("click",".lhnSubmit.hocTicket",(function(){return lhnQuery(".lhnSubmit.hocTicket").prop("disabled",!0),validateTicketForm(n.el,n.win),!1})),lhnQuery(".lhnFormButton.hocTicket").html(lhnJsSdk.dict.submit),autoFillForm("lhnTicketForm",validateTicketForm,n)})),doGaTrack("Ticket","Form-Opened",!1),"function"==typeof window.lhnJsSdkTicketShown&&window.lhnJsSdkTicketShown()),lhnQuery(".lhnHocOverlay").hide(),lhnQuery(".lhnloading").hide()}function formFileUploadCallback(e,n){if(void 0!==e.payload){var t=n.field_id.replace("filename","filedata"),a=n.field_id.replace("filename","fld");lhnQuery("#"+t).val(e.payload.attachment_id),lhnQuery("#"+a).val("[attachment: "+e.payload.attachment_id+"]")}}function validateTicketForm(e,n){lhnQuery(".lhnHocOverlay").show(),lhnQuery(".lhnloading").show(),validate(e)?ajaxCall(appurl+apiversion+"/ticket/",{fields:lhnQuery(".lhnTicketForm form").serializeObject(n)},"PUT",validateTicketFormCallback,{el:e,view_id:n}):(lhnQuery(".lhnSubmit.hocTicket").prop("disabled",!1),lhnQuery(".lhnHocOverlay").hide(),lhnQuery(".lhnloading").hide())}function validateTicketFormCallback(e,n){void 0!==e.payload&&void 0!==e.message&&(lhnQuery("#"+n.el+" .lhnTicketForm").remove(),lhnQuery("<div class='lhnmsgbox lhnTicketSuccess'>"+e.message.replace("###ticketid###",e.payload.ticket_id)+"</div>").appendTo("#"+n.el),firstOpen.ticket=!0,doGaTrack("Ticket","Form-Submitted",!1),"function"==typeof window.lhnJsSdkTicketSubmitted&&window.lhnJsSdkTicketSubmitted()),lhnQuery(".lhnHocOverlay").hide(),lhnQuery(".lhnloading").hide(),lhnQuery(".lightpick").hide()}function embedCallback(e,n){lhnQuery(".lhnHocOverlay").show(),lhnQuery(".lhnloading").show(),ajaxCall(appurl+apiversion+"/ui/form/",{system:"callback",layout:"hoc",partial:"form",view_id:n},"GET",embedCallbackCallback,{el:e,win:n})}function embedCallbackCallback(e,n){var t,a,l;void 0!==e.payload?(lhnQuery("#"+n.el).html(""),t=document,a=baseurl+"Scripts/jquery.scrollTo.js",(l=t.createElement("script")).setAttribute("type","text/javascript"),l.setAttribute("src",a),t.getElementsByTagName("head")[0].appendChild(l),lhnQuery(e.payload).appendTo("#"+n.el),lhnQuery(document).ready((function(){lhnQuery(document).off("click",".lhnSubmit.hocCallback").on("click",".lhnSubmit.hocCallback",(function(){return lhnQuery(".lhnSubmit.hocCallback").prop("disabled",!0),validateCallForm(n.el,n.win),!1})),autoFillForm("lhnCallbackForm",validateCallForm,n),lhnQuery(".lhnFormButton.hocCallback").html(lhnJsSdk.dict.submit)})),doGaTrack("Callback","Form-Opened",!1),"function"==typeof window.lhnJsSdkCallbackShown&&window.lhnJsSdkCallbackShown()):e&&void 0!==e.status&&"error"==e.status&&(lhnQuery("#"+n.el+" .lhnmsgbox").remove(),lhnQuery("<div class='error'>"+e.error+"</div>").appendTo("#"+n.el)),lhnQuery(".lhnHocOverlay").hide(),lhnQuery(".lhnloading").hide()}function validateCallForm(e,n){if(lhnQuery(".lhnHocOverlay").show(),lhnQuery(".lhnloading").show(),validate(e)){var t={};t.fields=lhnQuery(".lhnCallbackForm form").serializeObject(n),t.current_page=lhnJsSdk.options.pageurl,ajaxCall(appurl+apiversion+"/callback/",t,"PUT",validateCallFormCallback,{el:e,win:n})}else lhnQuery(".lhnHocOverlay").hide(),lhnQuery(".lhnloading").hide(),lhnQuery(".lhnSubmit.hocCallback").prop("disabled",!1)}function validateCallFormCallback(e,n){void 0!==e.payload&&void 0!==e.message&&(lhnQuery("#"+n.el+" .lhnCallbackForm").remove(),lhnQuery("<div class='lhnmsgbox lhnCallbackSuccess'>"+e.message+"</div>").appendTo("#"+n.el),firstOpen.callback=!0,doGaTrack("Callback","Form-Submitted",!1),"function"==typeof window.lhnJsSdkCallbackSubmitted&&window.lhnJsSdkCallbackSubmitted(),void 0!==n.win&&(lhnQuery("[rel='cb"+n.win+"']").remove(),setTimeout((function(){lhnQuery("#cb"+n.win+" .form_close").click()}),3e3))),lhnQuery(".lhnHocOverlay").hide(),lhnQuery(".lhnloading").hide()}function openHOC(e,n){isWorking||void 0===lhnJsSdk.settings.general||(isWorking=!0,activeTab=null==activeTab?systems_long[lhnJsSdk.settings.systems[1].system]:activeTab,e=systems[e=void 0===e?activeTab:e],void 0!==n&&void 0!==n.search_term&&(lhnJsSdk.search_term=n.search_term),switchHocTab(e,n)?(lhnQuery("#lhnHelpOutCenter").addClass("lhnActive"),isWorking=!1,void 0!==lhnJsSdk.options.hideButtonWhenOpen&&1==lhnJsSdk.options.hideButtonWhenOpen&&("slide"==lhnJsSdk.settings.button?(lhnQuery("#lhnHocButton").addClass("lhndown"),setTimeout((function(){lhnQuery("#lhnHocButton").hide()}),1e3)):lhnQuery("#lhnHocButton").hide()),"function"==typeof window.lhnJsSdkEmbeddedOpened&&window.lhnJsSdkEmbeddedOpened(),setTimeout((function(){lhnQuery("#lhnHelpOutCenter #lhnWindowCloser").focus()}),50)):isWorking=!1);return!1}function closeHOC(){void 0!==lhnJsSdk.settings.general&&(lhnQuery("#lhnHelpOutCenter").removeClass("lhnActive"),"slide"==lhnJsSdk.settings.button?setTimeout((function(){lhnQuery("#lhnHocButton").show(),lhnQuery("#lhnHocButton").removeClass("lhndown")}),500):lhnQuery("#lhnHocButton").show(),lhnQuery("#lhnHocButton").focus(),"function"==typeof window.lhnJsSdkEmbeddedClosed&&window.lhnJsSdkEmbeddedClosed())}function switchHocTab(e,n){vchanConnect();var t=lhnQuery(".lhnHocTab[systemtype='"+e+"']").attr("systemorder");return log("tab system type",e),log("tab order",t),lhnQuery.each(systems,(function(n,t){t==e&&(activeTab=n)})),void 0===t?(lhnJsSdk.log("HOC Error","Invalid HOC Tab"),!1):(firstOpen[e]?("chat"==lhnJsSdk.settings.systems[t].system&&(lhnJsSdk.settings.chatSystemMessages=lhnJsSdk.settings.systems[t].messages,hoc_chat_order=t),generateHocContents(lhnJsSdk.settings.systems[t].system,n),"ticket"!=e&&"callback"!=e||(firstOpen[e]=!0)):"knowledge"==e&&void 0!==lhnJsSdk.search_term&&(typeahead.searchBox.val(lhnJsSdk.search_term),typeahead.searchBox.keyup()),updateHeaderFooter(lhnJsSdk.settings.systems[t].system),lhnQuery(".lhnHocSection.hocactive").removeClass("hocactive"),lhnQuery(".lhnHocSection[systemtype='"+e+"']").addClass("hocactive"),lhnQuery(".lhnHocTab.hocactive").removeClass("hocactive"),lhnQuery(".lhnHocTab[systemtype='"+e+"']").addClass("hocactive"),!0)}function updateHeaderFooter(e){if(1==lhnJsSdk.isHOC){if(clearInterval(poweredByInterval),poweredByInterval=setInterval((function(){lhnQuery("#lhnWindowFooter, .lhnHocPoweredBy").show(),lhnQuery(".lhnHocPoweredBy a").attr("href")!=lhnJsSdk.settings.poweredby.link&&(lhnQuery(".lhnHocPoweredBy a").html(lhnJsSdk.settings.poweredby.text),lhnQuery(".lhnHocPoweredBy a").attr("href",lhnJsSdk.settings.poweredby.link))}),5e3),lhnQuery("#lhnWindowFooter").html(""),lhnQuery("#lhnWindowFooter").hide(),lhnQuery(".lhnWindow-header-avatar").hide(),lhnQuery(".lhnWindow-header-text").removeClass("lhnWindow-chat"),lhnQuery(".lhnWindow-header-text h4").html(""),""==lhnJsSdk.settings.poweredby.text)var n="";else n='<div class="lhnHocPoweredBy">Powered by <a href="'+lhnJsSdk.settings.poweredby.link+'" target="_blank">'+lhnJsSdk.settings.poweredby.text+"</a></div>";switch(e){case"chat":"prechat"==chatType?(lhnQuery("#lhnHocHeader span").text(lhnJsSdk.dict.newChatTitle),lhnQuery("#lhnWindowFooter").show()):"offline"==chatType?(lhnQuery("#lhnHocHeader span").text(lhnJsSdk.dict.offlineTitle),lhnQuery("#lhnWindowFooter").show()):"survey"==chatType?(lhnQuery("#lhnHocHeader span").text(lhnJsSdk.dict.surveyTitle),lhnQuery("#lhnWindowFooter").show()):(1==lhnJsSdk.settings.file_upload_allowed?(lhnQuery("#lhnHelpOutCenter div.lhnChatActions").css("top","-82px"),lhnQuery(".lhnHocFileUploadAction").show()):lhnQuery(".lhnHocFileUploadAction").remove(),lhnQuery("#lhnHocHeader span").text(lhnJsSdk.dict.chatTitle),lhnQuery("#lhnWindowFooter").show(),lhnQuery(".lhnWindow-header-avatar").show(),lhnQuery(".lhnWindow-header-text").addClass("lhnWindow-chat"),lhnQuery(".lhnWindow-header-text h4").html('<span class="lhnAgentStatus"></span> '+lhnJsSdk.dict.agentConnecting),""!=lhnQuery(".lhnOperatorInfo .lhnOperatorName").text().trim()&&lhnQuery(".lhnWindow-header-text h4").html('<span class="lhnAgentStatus lhnAgentStatus--active"></span> '+lhnQuery(".lhnOperatorInfo .lhnOperatorName").text()),lhnQuery(".lhnOperatorInfo .lhnOperatorImage.hasImage").length>0&&lhnQuery(".lhnWindow-header-avatar--img").html(lhnQuery(".lhnOperatorInfo .lhnOperatorImage.hasImage").html()));break;case"ticket":lhnQuery("#lhnHocHeader span").text(lhnJsSdk.dict.ticketTitle),lhnQuery("#lhnWindowFooter").show();break;case"knowledge":lhnQuery("#lhnHocHeader span").text(lhnJsSdk.dict.knowledgeTitle),lhnQuery("#lhnWindowFooter").show();break;case"callback":lhnQuery("#lhnHocHeader span").text(lhnJsSdk.dict.callbackTitle),lhnQuery("#lhnWindowFooter").show()}lhnQuery("#lhnWindowFooter").append(n)}}function autoFillForm(e,n,t){void 0!==lhnJsSdk.fieldData&&(lhnQuery.each(lhnJsSdk.fieldData,(function(n,t){"_readonly"==n.substring(n.length-9,n.length)&&(n=n.substring(0,n.length-9),lhnQuery("."+e+" [crm='"+n+"']").attr("readonly","readonly")),lhnQuery("."+e+" [crm='"+n+"']").val(t),lhnQuery("."+e+" [crm='"+n+"']").parent().find(".lhnSendButton").addClass("lhnShow")})),void 0!==lhnJsSdk.fieldData.auto_submit&&1==lhnJsSdk.fieldData.auto_submit&&null!=n&&n(t.el,t.win))}function externalPage(e){new RegExp("^https?:").test(e)&&(e="<iframe src='"+e+"'></iframe>"),lhnQuery(".lhnExternalContainer").html(e),externalPageOpen()}function externalPageOpen(){if(lhnQuery(".lhnExternal").hasClass("standalone"))var e=lhnJsSdk.options.embedArticleDirection,n=400;else e=lhnJsSdk.settings.styles.position,n=lhnJsSdk.settings.general.hocWidth;if(parseInt(lhnQuery(".lhnExternal").css(e))<0){var t={};t[e]="+="+n,lhnQuery(".lhnExternal").animate(t,500)}}function externalPageClose(){if(lhnQuery(".lhnExternal").hasClass("standalone"))var e=lhnJsSdk.options.embedArticleDirection,n=400;else e=lhnJsSdk.settings.styles.position,n=lhnJsSdk.settings.general.hocWidth;if(parseInt(lhnQuery(".lhnExternal").css(e))>=0){var t={};t[e]="-="+n,lhnQuery(".lhnExternal").animate(t,800,(function(){lhnQuery(".lhnExternal .lhnExternalContainer").html("")}))}}function log(e,n,t){t=void 0!==t&&t,(develop||t)&&"undefined"!=typeof console&&console.log(e+": "+n)}function isMobile(){var e,n=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(n=!0),n}function convertTime(e){if("Z"==e.substr(-1)){e=e.substr(0,e.length-1)+"-0400";var n=new Date(e)}else{var t=e.split(/\D/),a=new Date(t[0],--t[1],t[2],t[3],t[4]),l=a.getTimezoneOffset();n=dateAdd(a,"minute",240-l)}return n}function dateAdd(e,n,t){var a=new Date(e);switch(n.toLowerCase()){case"year":a.setFullYear(a.getFullYear()+t);break;case"quarter":a.setMonth(a.getMonth()+3*t);break;case"month":a.setMonth(a.getMonth()+t);break;case"week":a.setDate(a.getDate()+7*t);break;case"day":a.setDate(a.getDate()+t);break;case"hour":a.setTime(a.getTime()+36e5*t);break;case"minute":a.setTime(a.getTime()+6e4*t);break;case"second":a.setTime(a.getTime()+1e3*t);break;default:a=void 0}return a}function ajaxCall(e,n,t,a,l){if(!isBlocked){if((l=void 0!==l?l:{}).delay=void 0!==l.delay?l.delay:5e3,lhnasync=void 0===l.async||l.async,n.dept=lhnJsSdk.options.dept,lhnStorage.getData("lhnJWT")||1!=visitorValidated||!(e.indexOf("api")>0)){if("XDomainRequest"in window&&null!==window.XDomainRequest){var o=new XDomainRequest;o&&(o.onload=function(){for(var e=o.responseText;"object"!=_typeof(e);)e=JSON.parse(e);e&&void 0!==e.status&&"error"!=e.status&&null!=a?a(e,l):"error"==e.status&&void 0!==e.message&&(log("REST Error",e.message,!0),"undefined"!=l.errorCallback&&l.errorCallback?l.errorCallback(l):void 0!==l.el&&l.el&&(lhnQuery("#"+l.el+" .lhnmsgbox").remove(),lhnQuery("<div class='error'>"+e.message+"</div>").appendTo("#"+l.el)))},o.onerror=function(){log("Ajax Error","XDR Error",!0),a==chatMsgSentCallback&&setTimeout((function(){l.delay=2*l.delay,ajaxCall(e,n,t,a,l)}),l.delay)},o.ontimeout=function(){},o.onprogress=function(){},o.open(t,e+"?"+lhnQuery.param(n)+"&token="+lhnStorage.getData("lhnJWT")),o.send())}else lhnAjaxData=lhnQuery.ajax({url:e,data:n,type:t,async:lhnasync,success:function(e){(e="object"!=_typeof(e)?JSON.parse(e):e)&&(void 0!==e.status&&"error"!=e.status&&null!=a&&"inline"!=a||void 0!==e.token_type)?a(e,l):"error"==e.status&&void 0!==e.message&&(log("REST Error",e.message,!0),"undefined"!=l.errorCallback&&l.errorCallback?l.errorCallback(l):void 0!==l.el&&l.el&&(lhnQuery("#"+l.el+" .lhnmsgbox").remove(),lhnQuery("<div class='error'>"+e.message+"</div>").appendTo("#"+l.el),lhnQuery(".lhnHocOverlay").hide(),lhnQuery(".lhnloading").hide(),void 0!==l.temp_id&&lhnQuery("#lhnCustomerMsgSent."+l.temp_id).remove()))},error:function(o,s,i){log("Ajax Error",s+" - "+i,!0),a==chatMsgSentCallback&&(5e3==l.delay&&(l.temp_id=Math.floor(99999998*Math.random())+1,lhnQuery(".lhnChat").append("<div id='lhnCustomerMsgSent' class='lhnCustomerMessage lhnWindow-message--container "+l.temp_id+"'><span></span><div class='lhnWindow-message'><div class='lhnTypingDot'></div><div class='lhnTypingDot'></div><div class='lhnTypingDot'></div></div></div>")),setTimeout((function(){l.delay=2*l.delay,ajaxCall(e,n,t,a,l)}),l.delay))},beforeSend:function(e,n){e.setRequestHeader("Authorization","Bearer "+lhnStorage.getData("lhnJWT"))}});return lhnAjaxData}refresh_opts={url:e,data:n,type:t,successCallback:a,options:l},refreshOAuth(refresh_opts)}}function validate(e){var n=!0;return lhnQuery("#"+e+" input, #"+e+" textarea, #"+e+" select").removeClass("lhnError"),lhnQuery("#"+e+" .lhnField").removeClass("lhnNot-valid"),lhnQuery(".lhnErrorMsg").remove(),lhnQuery("#"+e+" [rel*=required]:visible").each((function(){var t="#"+e+" #"+lhnQuery(this).attr("id");if(("requiredText"==lhnQuery(t).attr("rel")&&""==lhnQuery(t).val()||"requiredDDL"==lhnQuery(t).attr("rel")&&-1==lhnQuery(t+" option:selected").attr("value"))&&(lhnQuery(this).addClass("lhnError"),lhnQuery(this).closest(".lhnField").addClass("lhnNot-valid"),""!=lhnJsSdk.dict.error_msg_empty&&(lhn_error_msg=lhnJsSdk.dict.error_msg_empty.replace("$$$label$$$",lhnQuery(this).closest(".lhnField").find("label p").text()),lhnQuery(this).parent().append('<span class="lhnErrorMsg">'+lhn_error_msg+"</span>")),lhnQuery(this).focus(),n=!1),"email"!=lhnQuery(t).attr("validatefor")||isValidEmailAddress(lhnQuery(t).val())?"phone"!=lhnQuery(t).attr("validatefor")||isValidPhone(lhnQuery(t).val())?"url"!=lhnQuery(t).attr("validatefor")||isValidUrl(lhnQuery(t).val())?"number"!=lhnQuery(t).attr("validatefor")||isValidNumber(lhnQuery(t).val())||(lhnQuery(this).addClass("lhnError"),lhnQuery(this).closest(".lhnField").addClass("lhnNot-valid"),""!=lhnJsSdk.dict.error_msg_number&&(lhn_error_msg=lhnJsSdk.dict.error_msg_number.replace("$$$label$$$",lhnQuery(this).closest(".lhnField").find("label p").text()),lhnQuery(this).parent().append('<span class="lhnErrorMsg">'+lhn_error_msg+"</span>")),lhnQuery(this).focus(),n=!1):(lhnQuery(this).addClass("lhnError"),lhnQuery(this).closest(".lhnField").addClass("lhnNot-valid"),""!=lhnJsSdk.dict.error_msg_url&&(lhn_error_msg=lhnJsSdk.dict.error_msg_url.replace("$$$label$$$",lhnQuery(this).closest(".lhnField").find("label p").text()),lhnQuery(this).parent().append('<span class="lhnErrorMsg">'+lhn_error_msg+"</span>")),lhnQuery(this).focus(),n=!1):(lhnQuery(this).addClass("lhnError"),lhnQuery(this).closest(".lhnField").addClass("lhnNot-valid"),""!=lhnJsSdk.dict.error_msg_phone&&(lhn_error_msg=lhnJsSdk.dict.error_msg_phone.replace("$$$label$$$",lhnQuery(this).closest(".lhnField").find("label p").text()),lhnQuery(this).parent().append('<span class="lhnErrorMsg">'+lhn_error_msg+"</span>")),lhnQuery(this).focus(),n=!1):(lhnQuery(this).addClass("lhnError"),lhnQuery(this).closest(".lhnField").addClass("lhnNot-valid"),""!=lhnJsSdk.dict.error_msg_email&&(lhn_error_msg=lhnJsSdk.dict.error_msg_email.replace("$$$label$$$",lhnQuery(this).closest(".lhnField").find("label p").text()),lhnQuery(this).parent().append('<span class="lhnErrorMsg">'+lhn_error_msg+"</span>")),lhnQuery(this).focus(),n=!1),0==n)return n})),n}function isValidPhone(e){return!!(/^[0-9-+.]+$/.test(e)&&e.length>5)}function isValidEmailAddress(e){return new RegExp(/^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i).test(e)}function isValidUrl(e){return new RegExp(/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$/).test(e)}function isValidNumber(e){return new RegExp(/^\W?\s?(([1-9]\d{0,2}(,\d{3})*)(.\d+)*)?$/).test(e)}function isAlphaOnly(e){return!!/^[^*!@%_0-9\^]+$/.test(e)}function isValidIp(e){return new RegExp(/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/).test(e)}function stripToSize(e,n){return e.replace(/^(.{200}[^\s]*).*/,"$1")}function connectSocket(e,n){connectionAttempted=!0,isSocketConnecting()||(closeSocketConnection(),lhnJsSdk.lhnsocket=void 0!==e&&null!=e?new Socket(sockurl+"/socket",{timeout:2e4,heartbeatIntervalMs:2e4,transport:e,reconnectAfterMs:reconnectSocketInterval}):new Socket(sockurl+"/socket",{timeout:2e4,heartbeatIntervalMs:2e4,reconnectAfterMs:reconnectSocketInterval}),lhnJsSdk.lhnsocket.onOpen((function(){void 0!==n&&null!=n&&n(),startInactivityTimer()})),lhnJsSdk.lhnsocket.onClose((function(){lhnjti=null==lhnStorage.getData("lhnJWT")?"nocookie":JSON.parse(decodeBase64(lhnStorage.getData("lhnJWT").split(".")[1])).jti,lhnJsSdk.log("visitor socket closed",lhnjti,navigator.userAgent)})),lhnJsSdk.lhnsocket.onError((function(e,n,t){lhnjti=null==lhnStorage.getData("lhnJWT")?"nocookie":JSON.parse(decodeBase64(lhnStorage.getData("lhnJWT").split(".")[1])).jti,lhnJsSdk.log("visitor socket closed",lhnjti,navigator.userAgent),n===WebSocket&&0===t?(longPollAttempted=!0,lhnJsSdk.lhnsocket.replaceTransport(LongPoll),lhnJsSdk.lhnsocket.connect()):(n!==WebSocket&&0===t&&!0===longPollAttempted||n!==WebSocket&&t>0)&&(lhnJsSdk.lhnsocket.disconnect(),longPollAttempted=!1)})),lhnJsSdk.lhnsocket.connect())}function reconnectSocketInterval(e){return[500,1e3,1e3,2e3,3e3][e-1]||5e3}function startSocketTimer(){socketTimerStarted||(socketTimerStarted=!0,socket_timer=setInterval((function(){isSocketReady()?isVisitorChannelReady()&&isChatChannelReady()||reconnectChannels():connectSocket(null,reconnectChannels)}),3e4))}function stopSocketTimer(){clearInterval(socket_timer),socketTimerStarted=!1}function closeSocketConnection(){void 0!==lhnJsSdk.lhnsocket&&null!=lhnJsSdk.lhnsocket&&(lhnJsSdk.lhnsocket.disconnect(),lhnJsSdk.lhnsocket=null)}function startInactivityTimer(){inactivityTimerStarted||(inactivityTimerStarted=!0,inactivity_timer=setInterval((function(){null==lhnJsSdk.chatSession&&(stopSocketTimer(),stopInactivityTimer(),closeSocketConnection(),0==lhnJsSdk.isOnline&&"jump_logic"!=preChatType&&("visible"==lhnQuery("#lhnHelpOutCenter").css("visibility")&&lhnJsSdk.closeHOC(),firstOpen.chat=!0,lhnQuery("#hocSyschat").html("")))}),3e5))}function stopInactivityTimer(){clearInterval(inactivity_timer),inactivityTimerStarted=!1}function isSocketConnecting(){return void 0!==lhnJsSdk.lhnsocket&&(null!=lhnJsSdk.lhnsocket&&(lhnJsSdk.lhnsocket.isConnected()||"connecting"===lhnJsSdk.lhnsocket.connectionState()))}function isSocketReady(){return void 0!==lhnJsSdk.lhnsocket&&(null!=lhnJsSdk.lhnsocket&&lhnJsSdk.lhnsocket.isConnected())}function isVisitorChannelReady(){if(!isSocketReady())return!1;if(0==lhnJsSdk.lhnsocket.channels.length)return!1;var e=getChannel("visitor_session");return null!=e&&"joined"===e.state}function isChatChannelReady(){if(!isSocketReady())return!1;if(null==lhnJsSdk.chatSession)return!0;if(0==lhnJsSdk.lhnsocket.channels.length)return!1;var e=getChannel("chat_session");return null!=e&&"joined"===e.state}function getChannel(e){for(var n=0;n<lhnJsSdk.lhnsocket.channels.length;++n){var t=lhnJsSdk.lhnsocket.channels[n];if(t.topic.startsWith(e))return t}return null}function reconnectChannels(){lhnJsSdk.vChan=null,lhnJsSdk.chatChan=null,vchanConnect(),setTimeout((function(){joinChatSessionCallback()}),1e3)}function vchanConnect(){if(isSocketReady()){if(isVisitorChannelReady())return;lhnJsSdk.vChan=lhnJsSdk.lhnsocket.channel("visitor_session:"+JSON.parse(decodeBase64(lhnStorage.getData("lhnJWT").split(".")[1])).jti,{token:lhnStorage.getData("lhnJWT"),department_id:lhnJsSdk.options.dept||0}),lhnJsSdk.vChan.on("online_status:changed",(function(e){updateOnlineStatus(e)})),lhnJsSdk.vChan.on("proactive_message:received",(function(e){proactiveMsgReceived(e)})),lhnJsSdk.vChan.on("trigger_invitation:received",(function(e){triggerMsgReceived(e)})),lhnJsSdk.vChan.on("trigger_promo:received",(function(e){triggerPromoReceived(e)})),lhnJsSdk.vChan.on("queue:status",(function(e){updateQueueStatus(e),1==lhnJsSdk.options.disableChatInQueue&&(lhnQuery(".lhnSendButton").prop("disabled",!0),lhnQuery("#lhnChatMessage").prop("disabled",!0))})),lhnJsSdk.vChan.on("visitor:banned",(function(e){isBlocked=!0,lhnQuery("#lhnHocButton, #lhnHelpOutCenter, #lhnHocInvite").hide()})),lhnJsSdk.vChan.on("chat:created",(function(e){setTimeout((function(){null==lhnJsSdk.chatSession&&(lhnJsSdk.chatSession=e.chat_session_id,lhnQuery("#hocSyschat").html(""),firstOpen.chat=!0,openHOC("c"))}),1e3)})),lhnJsSdk.vChan.on("jump_logic:message",(function(e){""!=e.text&&(1==lhnJsSdk.isHOC&&(parseInt(lhnQuery("#lhnHelpOutCenter").css(lhnJsSdk.settings.styles.position))<0||!lhnQuery("#hocSyschat").hasClass("hocactive")||"hidden"==lhnQuery("#lhnHelpOutCenter").css("visibility"))?openHOC("c"):(lhnQuery(".lhnChat .lhnFieldInput").hide(),lhnQuery(".lhnChat").append("<div id='"+e.field_info+"' class=\"lhnCustomerMessage lhnWindow-message--container\" attr='"+e.order+'\'><span></span><div class="lhnWindow-message">'+e.text+'</div><span class="lhnTime"></span></div>'),void 0!==lhnQuery(".lhnChat")[0]&&lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight)))})),lhnJsSdk.vChan.on("jump_logic:new_question",(function(e){1==lhnJsSdk.isHOC&&(parseInt(lhnQuery("#lhnHelpOutCenter").css(lhnJsSdk.settings.styles.position))<0||!lhnQuery("#hocSyschat").hasClass("hocactive")||"hidden"==lhnQuery("#lhnHelpOutCenter").css("visibility"))?openHOC("c"):void 0!==e.html?(lhnQuery(".lhnChat").append(e.html),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight)):setTimeout((function(){fetchNextJumpLogic(e.win,e.goto,e.opts)}),1500)})),lhnJsSdk.vChan.on("jump_logic:dept",(function(e){lhnJsSdk.isOnline=null!=lhnJsSdk.chatSession||e.chat.online_status,lhnJsSdk.options.dept=e.dept,online_type=0!=lhnJsSdk.options.dept?"department":"client",updateOnlineStatus({chat:{online_status:lhnJsSdk.isOnline,online_type:online_type}}),"function"==typeof window.lhnStatusUpdate&&window.lhnStatusUpdate()})),lhnJsSdk.vChan.on("jump_logic:ended",(function(e){jumplogic_chatended()})),lhnJsSdk.vChan.on("survey:submitted",(function(){"survey"==chatType&&(closeHOC(),chatType="prechat",lhnQuery("#hocSyschat").html(""),firstOpen.chat=!0,launchedChat=!1)})),lhnJsSdk.vChan.on("jump_logic:goto",(function(e){jl_working&&embedPreChatQuestionCallback(e,e.opts)})),lhnJsSdk.vChan.on("jump_logic:text",(function(e){0==lhnQuery("#"+e.message_id).length&&(lhnQuery(".lhnChat").append('<div id="'+e.message_id+'" class="lhnOperatorMessage lhnWindow-message--container"><span></span><div class="lhnWindow-message">'+jumpLogicTokenReplace(e.text)+'</div><span class="lhnTime"></span></div>'),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight))})),lhnJsSdk.vChan.on("jump_logic:close_window",(function(e){lhnJsSdk.closeHOC()})),lhnJsSdk.vChan.on("jump_logic:start_chat",(function(e){isOrigin(e)&&jl_working&&jumpLogicStartChat(e.opts)})),lhnJsSdk.vChan.on("jump_logic:restart_bot",(function(e){lhnQuery(".lhnChat [id^='fld_'], .lhnChat [for^='fld_'], .lhnChat .lhnOperatorMessage, .lhnChat .lhnCustomerMessage").attr("id","")})),lhnJsSdk.vChan.on("jump_logic:chat_ended",(function(e){chatEnded()})),lhnJsSdk.vChan.on("jump_logic:kb_article",(function(e){0==lhnQuery("#"+e.message_id).length&&(lhnQuery(".lhnChat").append('<div id="'+e.message_id+'" class="lhnOperatorMessage lhnWindow-message--container"><span></span><div class="lhnWindow-message"><div id="lhnKbEmbed"></div></div><span class="lhnTime"></span></div>'),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight),embedKbArticleCallback(e,{el:"lhnKbEmbed"}),lhnQuery(document).ready((function(){lhnQuery(document).on("click","#lhnKbEmbed",(function(){if(lhnQuery(".lhnExternal").length<1){if(lhnJsSdk.isHOC)var n=lhnJsSdk.settings.styles.position;else n="right";t=document,a=appurl+"/css/modern/external.css",l=t.getElementsByTagName("head")[0],(o=t.createElement("link")).type="text/css",o.rel="stylesheet",o.href=a,l.appendChild(o),lhnJsSdk.options.embedArticleDirection=void 0===lhnJsSdk.options.embedArticleDirection?n:lhnJsSdk.options.embedArticleDirection,lhnExternal=document.createElement("div"),lhnExternal.className="lhnExternal standalone "+lhnJsSdk.options.embedArticleDirection,lhnExternal.style.display="none",lhnExternal.innerHTML='<a href="#" class="lhnHocExternalClose">close</a><div class="lhnExternalContainer"></div>',document.body.appendChild(lhnExternal),lhnQuery(document).ready((function(){lhnQuery(document).on("click",".lhnHocExternalClose",(function(){return externalPageClose(),!1})),lhnQuery(".lhnExternal.standalone").show()}))}var t,a,l,o;embedKbArticleCallback(e,{el:"lhnExternal"})})),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight)})))})),lhnJsSdk.vChan.on("jump_logic:callback",(function(e){if(0==lhnQuery("#"+e.message_id).length){var n=e.action.callback;lhnQuery(".lhnChat").append('<div id="'+e.message_id+'" rel="cb'+n+'" class="lhnWindow-message--container"><div class="hocSecureForm"><div class="form_chat_btn form_not_filled">'+lhnJsSdk.dict.callbackTitle+"</div></div></div>"),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight),lhnQuery("#hocSyschat").append('<div id="cb'+n+'" class="secure_forms" style="display: none;"><div class="form_close"></div><div class="sf_main_form"></div></div>'),embedCallbackCallback(e,{el:"cb"+n+" .sf_main_form",win:n}),lhnQuery(document).ready((function(){lhnQuery(document).on("click","[rel='cb"+n+"']",(function(){return lhnQuery("#cb"+n).show(),!1})),lhnQuery(document).on("click",".secure_forms .form_close",(function(){return lhnQuery("#cb"+n).hide(),!1}))}))}})),lhnJsSdk.vChan.on("jump_logic:ticket",(function(e){if(0==lhnQuery("#"+e.message_id).length){var n=e.action.ticket;lhnQuery(".lhnChat").append('<div id="'+e.message_id+'" rel="ticket'+n+'" class="lhnWindow-message--container"><div class="hocSecureForm"><div class="form_chat_btn form_not_filled">'+lhnJsSdk.dict.ticketTitle+"</div></div></div>"),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight),lhnQuery("#hocSyschat").append('<div id="ticket'+n+'" class="secure_forms" style="display: none;"><div class="form_close"></div><div class="sf_main_form"></div></div>'),embedTicketCallback(e,{el:"ticket"+n+" .sf_main_form",win:n}),lhnQuery(document).ready((function(){lhnQuery(document).on("click","[rel='ticket"+n+"']",(function(){return lhnQuery("#ticket"+n).show(),!1})),lhnQuery(document).on("click",".secure_forms .form_close",(function(){return lhnQuery("#ticket"+n).hide(),!1}))}))}})),lhnJsSdk.vChan.on("jump_logic:secure_form",(function(e){var n=e.action.secure_form;lhnQuery(".lhnChat").append(e.html),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight),loadSecureForms(e.id,n,{prechat:!0})})),lhnJsSdk.vChan.on("jump_logic:custom_js",(function(payload){custom_js_obj="object"!=_typeof(payload.action.custom_js)?JSON.parse(payload.action.custom_js):payload.action.custom_js,custom_js=jumpLogicTokenReplace(custom_js_obj.js),callback_index=payload.action.order,"feedback"==custom_js_obj.type?(window.lhnBotCustomJsCallback=function(e){lhnQuery(".lhnChat").append('<div class="lhnOperatorMessage lhnWindow-message--container"><span></span><div class="lhnWindow-message">'+jumpLogicTokenReplace(e)+'</div><span class="lhnTime"></span></div>'),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight),processActions(payload.data)},window.lhnBotCallback=lhnBotCustomJsCallback,i=action_length,eval(custom_js)):eval(custom_js)})),lhnJsSdk.vChan.on("jump_logic:math_formula",(function(e){lhnQuery(".lhnChat").append(e.result),lhnQuery(".lhnChat").scrollTop(lhnQuery(".lhnChat")[0].scrollHeight)})),lhnJsSdk.vChan.on("system:stop",(function(e){stopSocketTimer(),closeSocketConnection()})),lhnJsSdk.vChan.on("system:reconnect",(function(e){connectSocket(null,reconnectChannels)})),lhnJsSdk.vChan.on("jump_logic:step_done",(function(){jl_working=!1})),lhnJsSdk.vChan.onClose((function(){lhnjti=null==lhnStorage.getData("lhnJWT")?"nocookie":JSON.parse(decodeBase64(lhnStorage.getData("lhnJWT").split(".")[1])).jti,lhnJsSdk.log("visitor channel closed",lhnjti,navigator.userAgent)})),lhnJsSdk.vChan.join().receive("ok",(function(e){lhnJsSdk.log("Joined Channel","visitor_session:"+JSON.parse(decodeBase64(lhnStorage.getData("lhnJWT").split(".")[1])).jti),lhnJsSdk.isOnline=null!=lhnJsSdk.chatSession||e.chat.online_status,online_type=0!=lhnJsSdk.options.dept?"department":"client",updateOnlineStatus({chat:{online_status:lhnJsSdk.isOnline,online_type:online_type}}),"function"==typeof window.lhnStatusUpdate&&window.lhnStatusUpdate()})).receive("error",(function(e){"forbidden"==e&&(isBlocked=!0,lhnQuery("#lhnHocButton, #lhnHelpOutCenter, #lhnHocInvite").hide()),vchanLeave(),closeSocketConnection()}))}else setTimeout((function(){connectSocket(null,reconnectChannels)}),500)}function isOrigin(e){return tabId==e.tab_id}function vchanLeave(){vChannelJoined=!1,void 0!==lhnJsSdk.vChan&&null!=lhnJsSdk.vChan&&(lhnJsSdk.vChan.isLeaving()||lhnJsSdk.vChan.isClosed()||lhnJsSdk.vChan.leave())}function chatChannelLeave(){void 0!==lhnJsSdk.chatChan&&null!=lhnJsSdk.chatChan&&(lhnJsSdk.chatChan.isLeaving()||lhnJsSdk.chatChan.isClosed()||lhnJsSdk.chatChan.leave())}var lhnStorage={type:"cookie",cookieEnabled:function(){return null==window.localStorage.getItem("lhnStorageType")&&(lhnStorage.setData("lhnStorageType","cookie"),"cookie"==lhnStorage.getData("lhnStorageType"))},checkType:function(){"http:"!=location.protocol&&"https:"!=location.protocol||!lhnStorage.cookieEnabled()?(lhnStorage.type="localStorage",lhnStorage.setData("lhnStorageType","localStorage")):(lhnStorage.type="cookie",setTimeout((function(){null==lhnStorage.getData("lhnStorageType")&&(lhnStorage.type="localStorage",lhnStorage.setData("lhnStorageType","localStorage"))}),5e3))},getData:function(e){if("cookie"==lhnStorage.type){var n=document.cookie.split(";"),t=null;cookie_found=!1;for(var a=0;a<n.length;a++){var l=lhnQuery.trim(n[a]);if(0==l.indexOf(e+"=")&&0==cookie_found){t=l.substring(e.length+1,l.length);var o=location.host;o=o.split(":")[0],"lhnkb"==lhnJsSdk.options.domain_policy&&("kb.livehelpnow.net"==o||o.indexOf("livehelpnow.net")>0&&"help.livehelpnow.net"!=o)?(kbdata=t.split("|&|"),"lhnkb"==kbdata[kbdata.length-1]?(cookie_found=!0,kbdata.pop(),t=kbdata.join("|&|")):t=null):"exact"==lhnJsSdk.options.domain_policy?(exactdata=t.split("|&|"),"exact"==exactdata[exactdata.length-1]?(cookie_found=!0,exactdata.pop(),t=exactdata.join("|&|")):t=null):(1===o.split(".").length||isValidIp(o)||"true"==qs("lhn_preview")||"strict"==lhnJsSdk.options.domain_policy)&&(strictdata=t.split("|&|"),"strict"==strictdata[strictdata.length-1]?(cookie_found=!0,strictdata.pop(),t=strictdata.join("|&|")):t=null)}}}else cookie_info=window.localStorage.getItem(e),cookie_info?(cookie_info=cookie_info.split("; "),t=cookie_info[0],expires=cookie_info[1]||"",expires=expires.replace("expires=",""),new Date>new Date(expires)&&(t=null,window.localStorage.removeItem(e))):t=null;return t},setData:function(e,n,t){void 0===t&&(t=86400);var a=new Date;a.setTime(a.getTime()+1e3*t);var l="; expires="+a.toGMTString();if("cookie"==lhnStorage.type){var o=location.host;if(o=o.split(":")[0],lhn_secure="https:"==location.protocol?";secure;samesite=none":"","lhnkb"==lhnJsSdk.options.domain_policy)kbdata=n+"|&|lhnkb","kb.livehelpnow.net"==o?(path="/"+document.location.pathname.split("/")[1]+"/;",document.cookie=e+"="+kbdata+l+"; path="+path+"domain="+o+lhn_secure):o.indexOf("livehelpnow.net")>0&&"help.livehelpnow.net"!=o?document.cookie=e+"="+kbdata+l+"; path=/;domain="+o+lhn_secure:(lhnJsSdk.options.domain_policy="",lhnStorage.setData(e,n,t));else if("exact"==lhnJsSdk.options.domain_policy)exactdata=n+"|&|exact",document.cookie=e+"="+exactdata+l+"; path="+document.location.pathname+lhn_secure;else if(1===o.split(".").length||isValidIp(o)||"true"==qs("lhn_preview")||"strict"==lhnJsSdk.options.domain_policy)strictdata=n+"|&|strict",document.cookie=e+"="+strictdata+l+"; path=/"+lhn_secure;else{var s=o.split(".");s.shift();var i="."+s.join(".");i=i.split(":")[0],document.cookie=e+"="+n+l+"; path=/; domain="+i+lhn_secure,null!=lhnStorage.getData(e)&&lhnStorage.getData(e)==n||(i="."+o,document.cookie=e+"="+n+l+"; path=/; domain="+i+lhn_secure)}}else n+=l,window.localStorage.setItem(e,n)},removeData:function(e){if("cookie"==lhnStorage.type){var n=location.host;if(n=n.split(":")[0],"exact"==lhnJsSdk.options.domain_policy)document.cookie=e+"="+data+expires+"; path="+document.location.pathname+";";else if(1===n.split(".").length||isValidIp(n)||"true"==qs("lhn_preview")||"strict"==lhnJsSdk.options.domain_policy)document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path=/;";else{var t=n.split(".");t.shift();var a="."+t.join(".");a=a.split(":")[0],document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path=/; domain="+a}}else window.localStorage.removeItem(e)}};function qs(e){e=e.replace(/[*+?^$.\[\]{}()|\\\/]/g,"\\$&");var n=location.search.match(new RegExp("[?&]"+e+"=([^&]+)(&|$)","i"));return n&&decodeURIComponent(n[1].replace(/\+/g," "))}function decodeBase64(e){var n,t,a,l={},o=0,s=0,i="",r=String.fromCharCode,h=e.length;for(n=0;n<64;n++)l["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(n)]=n;for(t=0;t<h;t++)for(o=(o<<6)+l[e.charAt(t)],s+=6;s>=8;)((a=o>>>(s-=8)&255)||t<h-2)&&(i+=r(a));return i}function lb2br(e){switch(_typeof(e)){case"string":return e.replace(/[\n]/g,"<br />");case"object":e.html(lb2br(e.html()));break;default:return e}}function html2text(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function convertUrlsAndImages(e){var n=(e=(e=e.replace(/(^|[^"'])(https?:\/\/\S*\.(png|jpg|jpeg|gif))([\s<]|$)/gi,'$1<a href="$2" target="_blank"><img src="$2" /></a><br /><a href="$2" target="_blank">$2</a>$4')).replace(/(?:(?:<a.+?<\/a>)|(?:<div class="lhnOption".+?<\/div>)|(?:<iframe.+?<\/iframe>)|(?:<script[\s\S]+?<\/script>)|(?:<img.+?\/?>)|(?:<input.+?\/>)|(?:<.+?value=.+?>)|(?:[a-z0-9.-]+@[a-z0-9.-]+)|\b(?!http)[a-z]+:\/\/[^\s<>]+[^\s<>.]|((?:(?:(?:https?:)?(?:\/\/)?(?:[a-z0-9-]+\.)+(?:[a-z]{2,}|\d{1,})(?:\/|\?)(?:[^\s<>\/\?]*[^\s<>.])*(?:(?:\/|\?)[^\s<>\/\?]*[^\s<>.])*)|(?:(?:https?:)?(?:\/\/)[^\s<>]+[^\s<>.])|(?:\b(?:[a-z0-9-]+\.){2,}(?:[a-z]{2,}|\d{1,}))|(?:\b(?:[a-z0-9-]+\.)(?:com|net|org)))))/gim,(function(e,n){return void 0!==n?'<a href="'+e+'" target="_blank">'+e+"</a>":e}))).match(/<a([^<]*?)>(.*?)<\/a>/gi);if(null!=n)for(var t=0;t<n.length;t++)n[t].indexOf("@")<0&&(n[t].indexOf('target="')<0&&n[t].indexOf('href="http')<0?e=e.replace(n[t],n[t].replace('href="','target="_blank" href="http://')):n[t].indexOf('target="')<0?e=e.replace(n[t],n[t].replace('href="','target="_blank" href="')):n[t].indexOf('href="http')<0&&(e=e.replace(n[t],n[t].replace('href="','href="http://'))));return e}function buildDictionary(){switch(void 0===lhnJsSdk.dictionary&&(lhnJsSdk.dictionary={}),lhnJsSdk.settings.language=void 0===lhnJsSdk.settings.language?"english":lhnJsSdk.settings.language,lhnJsSdk.settings.language){case"arabic":var e={agentConnecting:"الاتصال بالوكيل",callbackMenu:"أتصل مرة أخرى",callbackTitle:"تقديم الاستدعاء",cancel:"إلغاء",chatBoxPlaceholder:"رسالتك",chatMenu:"دردشة",chatTitle:"محادثة",email:"البريد الإلكتروني",emailTranscript:"إرسال نسخة إلكترونية إلى",emailSuccess:"تم إرسال نسخة الدردشة عبر البريد الإلكتروني إلى",endChat:"نهاية المحادثة",endChatConfirm:"هل أنت متأكد أنك تريد إنهاء الدردشة الحالية؟",hide:"إخفاء",inviteCancel:"رفض",inviteStart:"الدردشة الآن",knowledgeMenu:"معرفة",knowledgeSearch:"البحث عن طريق الكلمات الرئيسية",knowledgeTitle:"البحث المعرفة",livechat:"دردشة مباشرة",livechat_offline:"احصل على مساعدة",newChatTitle:"محادثة جديدة",offlineTitle:"اترك رسالة",remoteAssistance:"يطلب الوكيل الدخول لعرض سطح المكتب",send:"إرسال",startChat:"بدء الدردشة",submit:"عرض",ticketMenu:"تذكرة",ticketTitle:"تسجيل التذكرة",uploadFile:"رفع ملف",uploadFileSuccess:"تم تحميل الملفات بنجاح",error_msg_empty:"",error_msg_email:"",error_msg_phone:"",error_msg_url:"",error_msg_number:""};break;case"chinese":e={agentConnecting:"连接到代理",callbackMenu:"回电话",callbackTitle:"提交回调",cancel:"取消",chatBoxPlaceholder:"你的信息",chatMenu:"聊",chatTitle:"会话",email:"电子邮件",emailTranscript:"电子邮件抄录到",emailSuccess:"聊天记录已通过电子邮件发送给",endChat:"结束聊天",endChatConfirm:"你确定要结束当前聊天",hide:"隐藏",inviteCancel:"解雇",inviteStart:"现在聊天",knowledgeMenu:"知识",knowledgeSearch:"按关键字搜索",knowledgeTitle:"搜索知识",livechat:"在线聊天",livechat_offline:"得到帮助",newChatTitle:"新的对话",offlineTitle:"留言",remoteAssistance:"代理正在请求访问以查看您的桌面",send:"发送",startChat:"开始聊天",submit:"提交",ticketMenu:"票",ticketTitle:"提交门票",uploadFile:"上传文件",uploadFileSuccess:"文件已成功上传",error_msg_empty:"",error_msg_email:"",error_msg_phone:"",error_msg_url:"",error_msg_number:""};break;case"french":e={agentConnecting:"Connexion à l'agent",callbackMenu:"Rappeler",callbackTitle:"Soumettre un rappel",cancel:"Annuler",chatBoxPlaceholder:"Votre message",chatMenu:"bavarder",chatTitle:"Conversation",email:"Email",emailTranscript:"Transcription par courriel à",emailSuccess:"La transcription du chat a été envoyée par courrier électronique à",endChat:"Fermer chat",endChatConfirm:"Etes-vous sûr de vouloir mettre fin à la conversation en cours?",hide:"cacher",inviteCancel:"Rejeter",inviteStart:"Discuter maintenant",knowledgeMenu:"Connaissance",knowledgeSearch:"Recherche par mots-clés",knowledgeTitle:"Recherche de connaissances",livechat:"Discussion en temps réel",livechat_offline:"OBTENIR DE L'AIDE",newChatTitle:"Nouvelle conversation",offlineTitle:"Laisser un message",remoteAssistance:"L'agent demande l'accès pour voir votre bureau",send:"Envoyer",startChat:"Démarrer la discussion",submit:"Soumettre",ticketMenu:"Billet",ticketTitle:"Soumettre un ticket",uploadFile:"Téléverser un fichier",uploadFileSuccess:"Les fichiers ont été téléchargés avec succès",error_msg_empty:"",error_msg_email:"",error_msg_phone:"",error_msg_url:"",error_msg_number:""};break;case"german":e={agentConnecting:"Verbindung zum Agenten herstellen",callbackMenu:"Rückrufen",callbackTitle:"Einen Rückruf",cancel:"Stornieren",chatBoxPlaceholder:"Deine Nachricht",chatMenu:"Fragen",chatTitle:"Konversation",email:"Email",emailTranscript:"E-Mail-Protokoll an",emailSuccess:"Chat-Protokoll wurde per E-Mail gesendet",endChat:"Ende des Gesprächs",endChatConfirm:"Sind Sie sicher, dass Sie die aktuellen Chat zu beenden?",hide:"ausblenden",inviteCancel:"Verlassen",inviteStart:"jetzt chatten",knowledgeMenu:"Wissen",knowledgeSearch:"Über Schlüsselwort suchen",knowledgeTitle:"Suchen Wissen",livechat:"Fragen",livechat_offline:"HILFE BEKOMMEN",newChatTitle:"Neues Gespräch",offlineTitle:"Hinterlass eine Nachricht",remoteAssistance:"Der Agent fordert Zugriff zum Anzeigen Ihres Desktops an",send:"Senden",startChat:"Chat beginnen",submit:"einreichen",ticketMenu:"Fahrkarte",ticketTitle:"Legen Sie eine Karte vor",uploadFile:"Datei hochladen",uploadFileSuccess:"Dateien wurden erfolgreich hochgeladen",error_msg_empty:"",error_msg_email:"",error_msg_phone:"",error_msg_url:"",error_msg_number:""};break;case"hindi":e={agentConnecting:"एजेंट से कनेक्ट करना",callbackMenu:"वापस कॉल करें",callbackTitle:"एक कॉलबैक जमा करें",cancel:"रद्द करना",chatBoxPlaceholder:"आपका सन्देश",chatMenu:"बातचीत",chatTitle:"बातचीत",email:"ईमेल",emailTranscript:"ईमेल ट्रांसक्रिप्ट में",emailSuccess:"चैट ट्रांसक्रिप्ट को ईमेल किया गया है",endChat:"बातचीत बंद करें",endChatConfirm:"आप वर्तमान चैट खत्म करना चाहते हैं आप सुनिश्चित हैं?",hide:"छिपाना",inviteCancel:"बर्खास्त",inviteStart:"अब बात करो",knowledgeMenu:"ज्ञान",knowledgeSearch:"संकेतशब्द द्वारा खोजें",knowledgeTitle:"खोजें ज्ञान",livechat:"सीधी बातचीत",livechat_offline:"मदद लें",newChatTitle:"न्यू बातचीत",offlineTitle:"एक संदेश छोड़ें",remoteAssistance:"एजेंट आपके डेस्कटॉप को देखने के लिए एक्सेस का अनुरोध कर रहा है",send:"भेजना",startChat:"बातचीत शुरू कीजिए",submit:"जमा करें",ticketMenu:"टिकट",ticketTitle:"टिकट जमा करें",uploadFile:"दस्तावेज अपलोड करें",uploadFileSuccess:"फ़ाइलें सफलतापूर्वक अपलोड कर दी गई हैं",error_msg_empty:"",error_msg_email:"",error_msg_phone:"",error_msg_url:"",error_msg_number:""};break;case"portuguese":e={agentConnecting:"Conectando-se ao agente",callbackMenu:"Ligue de volta",callbackTitle:"Ligue de volta",cancel:"Cancelar",chatBoxPlaceholder:"Sua mensagem",chatMenu:"Conversar",chatTitle:"Conversação",email:"O email",emailTranscript:"Transcrição de e-mail para",emailSuccess:"A transcrição do bate-papo foi enviada por e-mail para",endChat:"Fim de papo",endChatConfirm:"Tem certeza de que quer terminar a conversa actual?",hide:"ocultar",inviteCancel:"Demitir",inviteStart:"Converse agora",knowledgeMenu:"Conhecimento",knowledgeSearch:"Pesquisa por palavra-chave",knowledgeTitle:"Pesquisa Conhecimento",livechat:"Bate-papo ao vivo",livechat_offline:"OBTER AJUDA",newChatTitle:"nova conversa",offlineTitle:"Deixe um recado",remoteAssistance:"O agente solicita acesso para visualizar sua área de trabalho",send:"Enviar",startChat:"Iniciar bate-papo",submit:"Enviar",ticketMenu:"Bilhete",ticketTitle:"Enviar um ticket",uploadFile:"subir arquivo",uploadFileSuccess:"Os arquivos foram enviados com sucesso",error_msg_empty:"",error_msg_email:"",error_msg_phone:"",error_msg_url:"",error_msg_number:""};break;case"russian":e={agentConnecting:"Подключение к агенту",callbackMenu:"Перезвони",callbackTitle:"Перезвони",cancel:"Отмена",chatBoxPlaceholder:"Ваше сообщение",chatMenu:"чат",chatTitle:"разговор",email:"Эл. адрес",emailTranscript:"Электронная почта",emailSuccess:"Сценарий чата отправлен по электронной почте",endChat:"Конец чат",endChatConfirm:"Вы уверены, что хотите завершить текущий чат ?",hide:"скрывать",inviteCancel:"отклонять",inviteStart:"Теперь говорите",knowledgeMenu:"Знание",knowledgeSearch:"Поиск по ключевым словам",knowledgeTitle:"Поиск знаний",livechat:"Живой чат",livechat_offline:"ПОЛУЧИТЬ ПОМОЩЬ",newChatTitle:"Новый разговор",offlineTitle:"Оставить сообщение",remoteAssistance:"Агент запрашивает доступ к вашему компьютеру",send:"послать",startChat:"Начать Чат",submit:"Отправить",ticketMenu:"Билет",ticketTitle:"Отправить билет",uploadFile:"Загрузить файл",uploadFileSuccess:"Файлы были успешно загружены",error_msg_empty:"",error_msg_email:"",error_msg_phone:"",error_msg_url:"",error_msg_number:""};break;case"spanish":e={agentConnecting:"Conexión al agente",callbackMenu:"Llamar de vuelta",callbackTitle:"Llamar de vuelta",cancel:"Cancelar",chatBoxPlaceholder:"Tu mensaje",chatMenu:"Charla",chatTitle:"Conversacion",email:"Email",emailTranscript:"Transcripción del correo electrónico a",emailSuccess:"La transcripción de la charla ha sido enviada por correo electrónico a",endChat:"Chat finalizado",endChatConfirm:"¿Está seguro de que desea terminar la charla actual ?",hide:"esconder",inviteCancel:"Despedir",inviteStart:"Chatea ahora",knowledgeMenu:"Conocimiento",knowledgeSearch:"Buscar por palabra clave",knowledgeTitle:"Buscar conocimiento",livechat:"CHAT EN VIVO",livechat_offline:"CONSIGUE AYUDA",newChatTitle:"nueva conversación",offlineTitle:"Deja un mensaje",remoteAssistance:"El agente está solicitando acceso para ver su escritorio",send:"Enviar",startChat:"Comenzar chat",submit:"Enviar",ticketMenu:"Boleto",ticketTitle:"Enviar un ticket",uploadFile:"Subir archivo",uploadFileSuccess:"Los archivos se han subido correctamente",error_msg_empty:"",error_msg_email:"",error_msg_phone:"",error_msg_url:"",error_msg_number:""};break;default:e={agentConnecting:"Connecting to agent",callbackMenu:"Callback",callbackTitle:"Request a callback",cancel:"Cancel",chatBoxPlaceholder:"Your message",chatMenu:"Chat",chatTitle:"Conversation",email:"Email",emailTranscript:"Email transcript to",emailSuccess:"Chat transcript has been emailed to",endChat:"End Chat",endChatConfirm:"Are you sure you want to end the current chat?",hide:"hide",inviteCancel:"Dismiss",inviteStart:"Chat now",knowledgeMenu:"FAQ",knowledgeSearch:"Search by keyword",knowledgeTitle:"Search Knowledge",livechat:"LIVE CHAT",livechat_offline:"GET HELP",newChatTitle:"New conversation",offlineTitle:"Leave a message",remoteAssistance:"The agent is requesting access to view your desktop",callAssistance:"The agent is offering a call, do you accept?",send:"Send",startChat:"Start Chat",submit:"Submit",surveyTitle:"Survey",ticketMenu:"Ticket",ticketTitle:"Submit a ticket",uploadFile:"Upload File",uploadFileSuccess:"File(s) have been successfully uploaded",error_msg_empty:"",error_msg_email:"",error_msg_phone:"",error_msg_url:"",error_msg_number:""}}for(var n in lhnJsSdk.dict={},e)lhnJsSdk.dict[n]=void 0===lhnJsSdk.dictionary[n]?e[n]:lhnJsSdk.dictionary[n]}function lhnSendError(e,n){if(0==e.length)return!1;e=e.substring(0,300);var t=baseurl+"handler/e.ashx?c="+encodeURIComponent(lhnJsSdk.setup.account)+"&e="+encodeURIComponent(n)+": "+encodeURIComponent(e)+"&p="+encodeURIComponent([location.protocol,"//",location.host,location.pathname].join("")),a=new Image(1,1);a.onload=function(){a.src=t},a.src=baseurl+"images/spacer.gif"}function _sendToGaTracker(e,n,t,a,l){var o=l?l+".send":"send";window[a](o,{hitType:"event",eventCategory:"LiveHelpNow",eventAction:e,eventLabel:n,nonInteraction:t})}function detectGaType(){setTimeout((function(){(!gaType||!ga_local["_track"+gaType])&&("function"==typeof ga?gaType="ga":"object"==("undefined"==typeof _gaq?"undefined":_typeof(_gaq))?gaType="gaq":"function"==typeof gtag&&"object"==("undefined"==typeof dataLayer?"undefined":_typeof(dataLayer))&&"function"==typeof dataLayer.push?gaType="gtag":"object"==("undefined"==typeof dataLayer?"undefined":_typeof(dataLayer))&&"function"==typeof dataLayer.push&&(gaType="gtm"))}),500)}function getGaType(){return gaType||(detectGaType(),gaType)}function setGaType(e){("gtm"==e&&"object"==("undefined"==typeof dataLayer?"undefined":_typeof(dataLayer))&&"function"==typeof dataLayer.push||"gtag"==e&&"function"==typeof gtag&&"object"==("undefined"==typeof dataLayer?"undefined":_typeof(dataLayer))&&"function"==typeof dataLayer.push||"ga"==e&&window.GoogleAnalyticsObject&&"string"==typeof window.GoogleAnalyticsObject||"gaq"==e&&"object"==("undefined"==typeof _gaq?"undefined":_typeof(_gaq)))&&(gaType=e)}function doGaTrack(e,n,t){if(checkFocus()&&"true"!=lhnStorage.getData("ga"+e+n)){var a=getGaType();if(t=void 0!==t&&t,lhnStorage.setData("ga"+e+n,"true",300),a&&ga_local["_track"+a])return ga_local["_track"+a](e,n,t)}}function refresh(){null==lhnJsSdk.chatSession&&(firstOpen={chat:!0,ticket:!0,callback:!0,knowledge:!0},disableEndChat=void 0!==lhnJsSdk.options.disableEndChat?lhnJsSdk.options.disableEndChat:disableEndChat,lhnJsSdk.closeHOC())}function refresh_visitor(){var e={java:lhnJsSdk.options.java,res:lhnJsSdk.options.res,depth:lhnJsSdk.options.depth,custom1:lhnJsSdk.options.custom1,custom2:lhnJsSdk.options.custom2,custom3:lhnJsSdk.options.custom3,custom1Label:lhnJsSdk.options.custom1Label,custom2Label:lhnJsSdk.options.custom2Label,custom3Label:lhnJsSdk.options.custom3Label,dept:lhnJsSdk.options.dept,cookie:lhnJsSdk.options.cookie,referrer:lhnJsSdk.options.referrer,pagetitle:lhnJsSdk.options.pagetitle,pageurl:lhnJsSdk.options.pageurl,chatwindowid:system_windows.chat,utm_source:qs("utm_source"),utm_medium:qs("utm_medium"),utm_campaign:qs("utm_campaign"),utm_term:qs("utm_term"),utm_content:qs("utm_content"),click_id:detectClickId()};ajaxCall(appurl+apiversion+"/visitor/init/",e,"POST",refreshVisitorCallback)}function refreshVisitorCallback(e){void 0!==e.payload.jwt&&e.payload.jwt&&(lhnStorage.setData("lhnJWT",e.payload.jwt,e.payload.jwt_expire),resource_id=JSON.parse(decodeBase64(e.payload.jwt.split(".")[1])).resource.id,lhnStorage.setData("lhnContact",resource_id,63113904)),vchanLeave(),setTimeout((function(){vchanConnect()}),200)}function refresh_dictionary(){buildDictionary()}function detectClickId(){clickIds=["GCLID","FBCLID","TWCLID","HECLID","DCLID","CLID"],lhnClickId="";for(var e=0;e<clickIds.length;e++)lhnClickId=null==qs(clickIds[e])?lhnClickId:qs(clickIds[e]);return lhnClickId}ga_local._trackgtm=function(e,n,t){"object"==("undefined"==typeof dataLayer?"undefined":_typeof(dataLayer))&&"function"==typeof dataLayer.push&&dataLayer.push({event:"LiveHelpNow",eventCategory:"LiveHelpNow",eventAction:e,eventLabel:n,eventNonInteraction:t})},ga_local._trackgaq=function(e,n,t){"object"==("undefined"==typeof _gaq?"undefined":_typeof(_gaq))&&_gaq.push(["_trackEvent","LiveHelpNow",e,n,null,t])},ga_local._trackga=function(e,n,t){var a=window.GoogleAnalyticsObject||"ga";if("function"==typeof window[a]&&"function"==typeof window[a].getAll){var l=window[a].getAll(),o=l[0].get&&l[0].get("name");_sendToGaTracker(e,n,t,a,o)}else"function"==typeof window[a]&&function(){var e=!1;return window[a]((function(n){"object"==_typeof(n)&&(e=!0)})),e}()&&_sendToGaTracker(e,n,t,a)},ga_local._trackgtag=function(e,n,t){"function"==typeof gtag&&"object"==("undefined"==typeof dataLayer?"undefined":_typeof(dataLayer))&&"function"==typeof dataLayer.push&&gtag("event",e,{event_category:"LiveHelpNow",event_label:n,non_interaction:t})},lhnJsSdk.init=init,lhnJsSdk.log=log,lhnJsSdk.openHOC=openHOC,lhnJsSdk.closeHOC=closeHOC,lhnJsSdk.isOnline=isOnline,lhnJsSdk.showInvite=showInvite,lhnJsSdk.embedChatButton=embedChatButton,lhnJsSdk.embedChat=embedPreChat,lhnJsSdk.embedSurvey=embedSurvey,lhnJsSdk.embedKbLookup=embedKbLookup,lhnJsSdk.embedKbArticle=embedKbArticle,lhnJsSdk.wireKbLookup=wireKbLookup,lhnJsSdk.embedTicket=embedTicket,lhnJsSdk.embedCallback=embedCallback,lhnJsSdk.externalPage=externalPage,lhnJsSdk.externalPageOpen=externalPageOpen,lhnJsSdk.externalPageClose=externalPageClose,lhnJsSdk.endChat=endChat,lhnJsSdk.setGaType=setGaType,lhnJsSdk.getGaType=getGaType,lhnJsSdk.doGaTrack=doGaTrack,lhnJsSdk.lhnsocket=lhnsocket,lhnJsSdk.track_conversion=track_conversion,lhnJsSdk.refresh=refresh,lhnJsSdk.refresh_visitor=refresh_visitor,lhnJsSdk.refresh_dictionary=refresh_dictionary,lhnJsSdk.lhnStorage=lhnStorage})("undefined"!=typeof lhnJsSdk?lhnJsSdk:lhnJsSdk={}),"complete"==document.readyState?lhnJsSdk.init():window.addEventListener?window.addEventListener("load",(function(){lhnJsSdk.init()})):window.attachEvent("onload",(function(){lhnJsSdk.init()}))})();